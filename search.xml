<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>C++中string与wstring相互转换</title>
    <url>/2024/10/17/C-%E4%B8%ADstring%E4%B8%8Ewstring%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2/</url>
    <content><![CDATA[<h1 id="C-中-string-与-wstring-相互转换"><a href="#C-中-string-与-wstring-相互转换" class="headerlink" title="C++中 string 与 wstring 相互转换"></a>C++中 string 与 wstring 相互转换</h1><p>它们俩相互转化有一个前提条件，string 的编码格式需要是<strong>utf8</strong>（一般系统默认编码）。<br><em>（wstring 类型一般是 utf16 或 utf32，一般用于 windows 系统）</em></p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;locale&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;codecvt&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 将std::wstring转换为的std::string</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">std::string <span class="title">wstr2str</span><span class="params">(<span class="type">const</span> std::wstring &amp;wstr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::wstring_convert&lt;std::codecvt_utf8_utf16&lt;<span class="type">wchar_t</span>&gt;&gt; converter;</span><br><span class="line">    std::string str = converter.<span class="built_in">to_bytes</span>(wstr);</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 将std::string转换为的std::wstring</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">std::wstring <span class="title">str2wstr</span><span class="params">(<span class="type">const</span> std::string &amp;str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::wstring_convert&lt;std::codecvt_utf8_utf16&lt;<span class="type">wchar_t</span>&gt;&gt; converter;</span><br><span class="line">    std::wstring wstr = converter.<span class="built_in">from_bytes</span>(str);</span><br><span class="line">    <span class="keyword">return</span> wstr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 将std::string转换为的char*</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">char</span> *<span class="title">str2cstr</span><span class="params">(<span class="type">const</span> std::string &amp;str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str.<span class="built_in">c_str</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 将std::wstring转换为的wchar_t*</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">wchar_t</span> *<span class="title">wstr2wcstr</span><span class="params">(<span class="type">const</span> std::wstring &amp;wstr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> wstr.<span class="built_in">c_str</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// utf8字符串，是一种变长字符串，中文字符、英文字符、数字字符的字节数不相同</span></span><br><span class="line">std::string u8str = <span class="string">u8&quot;可以有中文，English，数字123等&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 宽字符串，是一种定长字符串，每个字符的字节数都相同，一般在Windows系统下使用</span></span><br><span class="line">str::wstring lstr = <span class="string">L&quot;可以有中文，English，数字123等&quot;</span>;</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>CSP(Content-Security-Policy)问题的原因与解决方法</title>
    <url>/2024/11/12/CSP-Content-Security-Policy-%E9%97%AE%E9%A2%98%E7%9A%84%E5%8E%9F%E5%9B%A0%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h1 id="CSP-是啥"><a href="#CSP-是啥" class="headerlink" title="CSP 是啥"></a>CSP 是啥</h1><p>CSP(Content-Security-Policy)是一个浏览器安全策略，主要用来防止 XSS（跨站脚本攻击）。<br>一个网站设置了 CSP，则只能请求 CSP 指定域的资源文件，相当于域的白名单。</p>
<h1 id="设置-CSP"><a href="#设置-CSP" class="headerlink" title="设置 CSP"></a>设置 CSP</h1><p>有两种方法可以设置 CSP，一种是通过<strong>HTTP 响应头</strong>设置；<br>另一种是通过 <strong>HTML 的 meta</strong> 标签设置</p>
<h1 id="解决访问不了资源的问题"><a href="#解决访问不了资源的问题" class="headerlink" title="解决访问不了资源的问题"></a>解决访问不了资源的问题</h1><ol>
<li>删除 CSP 的配置<br>让后端删除响应头 Content-Security-Policy</li>
<li>在 CSP 中添加指定域<br>让后端在 Content-Security-Policy 响应头中添加指定域作为白名单</li>
</ol>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://blog.csdn.net/Sheng_zhenzhen/article/details/113761288" >CSP 内容安全策略基础版 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.cnblogs.com/yang-cy/p/16853565.html" >发布上线后百度地图不显示 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://blog.csdn.net/weixin_44943389/article/details/136727480" >【问题出现】 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>HTTP</tag>
      </tags>
  </entry>
  <entry>
    <title>C++知识点查漏补缺</title>
    <url>/2023/11/03/C-%E7%9F%A5%E8%AF%86%E7%82%B9%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA/</url>
    <content><![CDATA[<h1 id="安装并配置编译器"><a href="#安装并配置编译器" class="headerlink" title="安装并配置编译器"></a>安装并配置编译器</h1><h2 id="MinGW"><a href="#MinGW" class="headerlink" title="MinGW"></a>MinGW</h2><ol>
<li><p><a class="link"   href="https://sourceforge.net/projects/mingw-w64/" >MinGW 下载地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><strong>注意打开页面后往下拉，选中<em>x86_64-posix-seh</em>这个版本下载</strong></p>
</li>
<li><p><a class="link"   href="https://pan.baidu.com/s/1m7YnDPe62SiiqetgFEyHGw&code=4z5g" >MinGW 百度云备用下载 x86_64-8.1.0-release-posix-seh-rt_v6-rev0.7z <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</li>
</ol>
<p>把下载好的 MinGW 压缩包解压到任意一个目录，然后配置环境变量到 bin 目录,<br>然后使用下面的命令测试，有输出就配置成功了。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -v</span><br></pre></td></tr></table></figure></div>

<h3 id="MinGW-提供的头文件目录"><a href="#MinGW-提供的头文件目录" class="headerlink" title="MinGW 提供的头文件目录"></a>MinGW 提供的头文件目录</h3><p><strong><em>mingw64\x86_64-w64-mingw32\include</em></strong><br>其他编译器用到 MinGW 的头文件时，需要使用 <strong>-I</strong> 参数主动指定 MinGW 头文件目录</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 例如使用emcc编译使用了windows.h头文件的代码需要加上 -I</span></span><br><span class="line">emcc .\src\main.cpp -o .\wasm\wasm_api.js -s WASM=1 -ID:\MinGW\mingw64\x86_64-w64-mingw32\include</span><br></pre></td></tr></table></figure></div>

<h1 id="头文件简介"><a href="#头文件简介" class="headerlink" title="头文件简介"></a>头文件简介</h1><p>.cpp 文件可以引用.h 头文件，也可以不引用.h 头文件,<br>如果.h 头文件又引入了其他.h 头文件，那么.cpp 文件需要引入头文件<br>编译时要指定.h 头文件对应的.cpp 文件，</p>
<p>a.h</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> example &#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">MyMath</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> PI;</span><br><span class="line">        <span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>;</span><br><span class="line">        <span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>a.cpp</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;a.h&quot;</span></span></span><br><span class="line"><span class="keyword">namespace</span> example &#123;</span><br><span class="line">    <span class="type">int</span> MyMath::PI = <span class="number">3.1415926</span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">MyMath::add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">MyMath::sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a - b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>main.cpp</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;a.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> example;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> MyMath::<span class="built_in">add</span>(MyMath::PI, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>编译</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">gcc main.cpp a.cpp -o main.exe</span><br></pre></td></tr></table></figure></div>

<h2 id="非系统库的引入"><a href="#非系统库的引入" class="headerlink" title="非系统库的引入"></a>非系统库的引入</h2><p>当你的项目需要引入一个第三方库，但是它独立于系统库且不属于你的项目，那么就需要在编译时使用-I 参数来引入头文件。<br>而在项目的代码里，就可以使用尖括号引入头文件，例如：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入第三方库</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mylib.h&gt;</span></span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 编译时需要指定头文件所在路径</span></span><br><span class="line">g++ -I<span class="string">&quot;E:\mylib\include&quot;</span> your_source_file.cpp -o your_output_executable</span><br></pre></td></tr></table></figure></div>

<h1 id="库操作"><a href="#库操作" class="headerlink" title="库操作"></a>库操作</h1><h2 id="操作-dll-库"><a href="#操作-dll-库" class="headerlink" title="操作 dll 库"></a>操作 dll 库</h2><h3 id="编译-dll-库"><a href="#编译-dll-库" class="headerlink" title="编译 dll 库"></a>编译 dll 库</h3><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// aaa.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line">    __declspec(dllexport) <span class="function"><span class="type">int</span> <span class="title">GetScreenWidth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">GetSystemMetrics</span>(SM_CXSCREEN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __declspec(dllexport) <span class="function"><span class="type">int</span> <span class="title">GetScreenHeight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">GetSystemMetrics</span>(SM_CYSCREEN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __declspec(dllexport) <span class="function">COLORREF <span class="title">GetColor</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        HDC hdcScreen = <span class="built_in">GetDC</span>(<span class="literal">NULL</span>);</span><br><span class="line">        COLORREF pixelColor = <span class="built_in">GetPixel</span>(hdcScreen, x, y);</span><br><span class="line">        <span class="built_in">ReleaseDC</span>(<span class="literal">NULL</span>, hdcScreen);</span><br><span class="line">        <span class="keyword">return</span> pixelColor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">g++ -shared -o aaa.dll aaa.cpp</span><br></pre></td></tr></table></figure></div>

<h3 id="调用没有头文件的-dll"><a href="#调用没有头文件的-dll" class="headerlink" title="调用没有头文件的 dll"></a>调用没有头文件的 dll</h3><p>目录结构为：</p>
<ul>
<li>lib<ul>
<li>my.dll</li>
</ul>
</li>
<li>src<ul>
<li>main.cpp</li>
</ul>
</li>
</ul>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    HINSTANCE hDll = <span class="built_in">LoadLibrary</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;../lib/my.dll&quot;</span>));  <span class="comment">// 加载DLL</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (hDll != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="comment">// 获取函数指针，调用没有头文件的dll库，需要事先知道dll库里的函数的定义。</span></span><br><span class="line">        <span class="function"><span class="keyword">typedef</span> <span class="title">int</span> <span class="params">(*MYPROC)</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line">        MYPROC myFunction = (MYPROC) <span class="built_in">GetProcAddress</span>(hDll, <span class="string">&quot;dllFunction&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (myFunction != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="comment">// 调用DLL中的函数</span></span><br><span class="line">            <span class="type">int</span> result = <span class="built_in">myFunction</span>();</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;Result: &quot;</span> &lt;&lt; result &lt;&lt; std::endl;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            std::cerr &lt;&lt; <span class="string">&quot;Failed to get function pointer.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">FreeLibrary</span>(hDll);  <span class="comment">// 释放DLL</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        std::cerr &lt;&lt; <span class="string">&quot;Failed to load DLL.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>编译</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">g++ src/main.cpp -o output/main.exe -Llib -lmy</span><br><span class="line"><span class="comment"># &quot;-Llib&quot; 表示dll库所在的目录，不能写成&quot;-L lib&quot;</span></span><br><span class="line"><span class="comment"># &quot;-lmy&quot; 表示dll库的名字，不需要后缀名，不能写成&quot;-l my&quot;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="字符编码"><a href="#字符编码" class="headerlink" title="字符编码"></a>字符编码</h1><p>C++编程要注意字符编码，不同的字符编码要进行转换，其中有三个重要的字符编码环境：</p>
<ol>
<li>操作系统字符编码</li>
<li>C++源码文件编码</li>
<li>输出字符串编码</li>
</ol>
<h2 id="操作系统字符编码"><a href="#操作系统字符编码" class="headerlink" title="操作系统字符编码"></a>操作系统字符编码</h2><p>一般是指通过终端调用可执行文件 exe 时传入的中文字符串编码：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">main.exe <span class="string">&quot;你好世界&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>这里传入 main.exe 的中文字符串的编码就是使用的操作系统的字符编码，一般为 936.</p>
<h3 id="查看系统字符编码"><a href="#查看系统字符编码" class="headerlink" title="查看系统字符编码"></a>查看系统字符编码</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看命令行编码格式</span></span><br><span class="line">chcp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置命令行编码格式为UTF-8</span></span><br><span class="line">chcp 65001</span><br></pre></td></tr></table></figure></div>

<h2 id="C-源码文件编码"><a href="#C-源码文件编码" class="headerlink" title="C++源码文件编码"></a>C++源码文件编码</h2><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> *str = <span class="string">&quot;你好世界&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>这里字符串”你好世界”就是源码文件使用的编码，一般为 UTF-8。</p>
<h2 id="输出字符串编码"><a href="#输出字符串编码" class="headerlink" title="输出字符串编码"></a>输出字符串编码</h2><p>通常是由其他程序调用可执行程序 exe 后拿到的输出字符串的编码。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;你好世界&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>如果是在终端调用可执行文件 exe，那么输出的字符串就是使用的操作系统的字符编码，一般为 936。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">main.exe</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">你好世界</span><br></pre></td></tr></table></figure></div>

<p>如果是在其他程序调用可执行文件 exe，那么输出的字符串就是使用的其他程序的字符编码。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; exec &#125; = <span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>);</span><br><span class="line"><span class="title function_">exec</span>(<span class="string">&quot;main.exe&quot;</span>, <span class="function">(<span class="params">error, stdout, stderr</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(stderr);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 输出</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(stdout);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<p>比如这里的输出字符串 stdout 就是使用的 UTF-8 编码。</p>
<h2 id="宽字符和窄字符"><a href="#宽字符和窄字符" class="headerlink" title="宽字符和窄字符"></a>宽字符和窄字符</h2><p>宽字符 wchar_t *和窄字符 char *，当他们需要相互转换的时候，必须要考虑编码问题。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将宽字符串转换为窄字符串，并指定输入字符串和输出字符串的编码</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// 输入参数：</span></span><br><span class="line"><span class="comment">//   wchar：宽字符串</span></span><br><span class="line"><span class="comment">//   icharset：输入的宽字符串的编码</span></span><br><span class="line"><span class="comment">//   ocharset：输出的窄字符串的编码</span></span><br><span class="line"><span class="comment">// 返回值：</span></span><br><span class="line"><span class="comment">//   转换后的窄字符串</span></span><br><span class="line"><span class="function"><span class="type">char</span> *<span class="title">wchar2char</span><span class="params">(<span class="type">wchar_t</span> *wchar, <span class="type">int</span> icharset, <span class="type">int</span> ocharset)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> bufferSize = <span class="built_in">WideCharToMultiByte</span>(icharset, <span class="number">0</span>, wchar, <span class="number">-1</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="type">char</span> *schar = <span class="keyword">new</span> <span class="type">char</span>[bufferSize];</span><br><span class="line">    <span class="built_in">WideCharToMultiByte</span>(ocharset, <span class="number">0</span>, wchar, <span class="number">-1</span>, schar, bufferSize, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> schar;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将窄字符串转换为宽字符串，并指定输入字符串和输出字符串的编码</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// 输入参数：</span></span><br><span class="line"><span class="comment">//   schar：窄字符串</span></span><br><span class="line"><span class="comment">//   icharset：输入的窄字符串的编码</span></span><br><span class="line"><span class="comment">//   ocharset：输出的宽字符串的编码</span></span><br><span class="line"><span class="comment">// 返回值：</span></span><br><span class="line"><span class="comment">//   转换后的窄字符串</span></span><br><span class="line"><span class="function"><span class="type">wchar_t</span> *<span class="title">char2wchar</span><span class="params">(<span class="type">char</span> *schar, <span class="type">int</span> icharset, <span class="type">int</span> ocharset)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> bufferSize = <span class="built_in">MultiByteToWideChar</span>(icharset, <span class="number">0</span>, schar, <span class="number">-1</span>, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="type">wchar_t</span> *wchar = <span class="keyword">new</span> <span class="type">wchar_t</span>[bufferSize];</span><br><span class="line">    <span class="built_in">MultiByteToWideChar</span>(ocharset, <span class="number">0</span>, schar, <span class="number">-1</span>, wchar, bufferSize);</span><br><span class="line">    <span class="keyword">return</span> wchar;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="Windows-窗口操作"><a href="#Windows-窗口操作" class="headerlink" title="Windows 窗口操作"></a>Windows 窗口操作</h1><h2 id="根据窗口句柄获取窗口标题"><a href="#根据窗口句柄获取窗口标题" class="headerlink" title="根据窗口句柄获取窗口标题"></a>根据窗口句柄获取窗口标题</h2><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取窗口标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">wchar_t</span> *<span class="title">GetWindowTitle</span><span class="params">(HWND hwnd)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> length = <span class="built_in">GetWindowTextLengthW</span>(hwnd);</span><br><span class="line">    <span class="type">wchar_t</span> *buffer = <span class="keyword">new</span> <span class="type">wchar_t</span>[length + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">GetWindowTextW</span>(hwnd, buffer, length + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> buffer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="遍历查找与指定窗口标题相似标题的窗口句柄"><a href="#遍历查找与指定窗口标题相似标题的窗口句柄" class="headerlink" title="遍历查找与指定窗口标题相似标题的窗口句柄"></a>遍历查找与指定窗口标题相似标题的窗口句柄</h2><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="function">BOOL CALLBACK <span class="title">EnumWindowsProc</span><span class="params">(HWND hwnd, LPARAM lParam)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">wchar_t</span> *buffer = <span class="built_in">GetWindowTitle</span>(hwnd);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">wcsstr</span>(buffer, (<span class="type">wchar_t</span> *)lParam) != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;&#123;&quot;</span> &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;\&quot;title\&quot;: &quot;</span></span><br><span class="line">                &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">wchar2char</span>(buffer, <span class="number">65001</span>, <span class="number">936</span>) &lt;&lt; <span class="string">&quot;\&quot;,&quot;</span> &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;\&quot;hwnd\&quot;: &quot;</span></span><br><span class="line">                &lt;&lt; hwnd &lt;&lt; <span class="string">&quot;,&quot;</span> &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;&#125;,&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GetHwndByTitle</span><span class="params">(<span class="type">wchar_t</span> *title)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;[&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">EnumWindows</span>(EnumWindowsProc, (LPARAM)title);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;]&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="获取窗口位置和大小"><a href="#获取窗口位置和大小" class="headerlink" title="获取窗口位置和大小"></a>获取窗口位置和大小</h2><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">HWND hwnd;</span><br><span class="line">RECT rect;</span><br><span class="line"><span class="built_in">GetWindowRect</span>(hwnd, &amp;rect);</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;窗口距离屏幕左上角的坐标：&quot;</span> &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; rect.left &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; rect.top &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;窗口的宽度：&quot;</span> &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; rect.right - rect.left &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;窗口的高度：&quot;</span> &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; rect.bottom - rect.top &lt;&lt; endl;</span><br></pre></td></tr></table></figure></div>

<h1 id="命令行"><a href="#命令行" class="headerlink" title="命令行"></a>命令行</h1><h2 id="命令行参数解析"><a href="#命令行参数解析" class="headerlink" title="命令行参数解析"></a>命令行参数解析</h2><p><a class="link"   href="https://blog.csdn.net/u012206617/article/details/100778895" >参考 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ch;</span><br><span class="line">    <span class="keyword">while</span> ((ch = <span class="built_in">getopt</span>(argc, argv, <span class="string">&quot;i:o:m:f:&quot;</span>)) != <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">switch</span> (ch)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;i&#x27;</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Input CP: %d\n&quot;</span>, <span class="built_in">atoi</span>(optarg));</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;o&#x27;</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Output CP: %d\n&quot;</span>, <span class="built_in">atoi</span>(optarg));</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;m&#x27;</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Mode: %s\n&quot;</span>, optarg);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;f&#x27;</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Func: %s\n&quot;</span>, optarg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>使用</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">main.exe -i 936 -o 65001 -m myMoudle -f myFunc</span><br><span class="line"></span><br><span class="line"><span class="comment"># Input CP: 936</span></span><br><span class="line"><span class="comment"># Output CP: 65001</span></span><br><span class="line"><span class="comment"># Mode: myMoudle</span></span><br><span class="line"><span class="comment"># Func: myFunc</span></span><br></pre></td></tr></table></figure></div>

<h1 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h1><p>对于大型复杂应用，或者需要引入复杂依赖的应用，Makefile 是必不可少的。<br>下面是一个 Makefile 示例：</p>
<div class="highlight-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 匹配指定目录下的所有.cpp文件。将文件名组成列表，赋值给变量src</span></span><br><span class="line">src = <span class="variable">$(<span class="built_in">wildcard</span> ./src/*.cpp)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将文件名中的.cpp后缀替换为.o，得到目标文件名组成列表，赋值给变量obj</span></span><br><span class="line">obj = <span class="variable">$(<span class="built_in">patsubst</span> ./src/%.cpp, ./obj/%.o, <span class="variable">$(src)</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 各种目录</span></span><br><span class="line">src_path = ./src</span><br><span class="line">inc_path = ./<span class="keyword">include</span></span><br><span class="line">lib_path = ./lib</span><br><span class="line">obj_path = ./obj</span><br><span class="line">out_path = ./output</span><br><span class="line"></span><br><span class="line"><span class="comment"># 其他参数</span></span><br><span class="line"><span class="comment"># 例如：如果你正在使用 g++ 而不是 gcc，确保你的编译命令包含 -lstdc++</span></span><br><span class="line">myArgs = -lstdc++</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译终极目标</span></span><br><span class="line"><span class="section">ALL: my.exe</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 模式规则</span></span><br><span class="line"><span class="variable">$(obj)</span>: <span class="variable">$(obj_path)</span>/%.o: $&#123;src_path&#125;/%.cpp</span><br><span class="line">	gcc -c <span class="variable">$&lt;</span> -o <span class="variable">$@</span> -I <span class="variable">$(inc_path)</span></span><br><span class="line"></span><br><span class="line"><span class="section">my.exe: <span class="variable">$(obj)</span></span></span><br><span class="line">	gcc <span class="variable">$^</span> -o <span class="variable">$(out_path)</span>/<span class="variable">$@</span> -L<span class="variable">$(lib_path)</span> <span class="variable">$(myArgs)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 清理目标文件</span></span><br><span class="line">clean :</span><br><span class="line">	-rm -rf <span class="variable">$(obj)</span> <span class="variable">$(out_path)</span>/my.exe</span><br><span class="line"></span><br><span class="line"><span class="comment"># 伪目标</span></span><br><span class="line"><span class="comment"># 当前文件夹下有 ALL 文件或者 clean 文件时，会导致 makefile 瘫痪</span></span><br><span class="line"><span class="comment"># 用伪目标来解决， 添加一行 .PHONY: clean ALL</span></span><br><span class="line">.PHONY : clean ALL</span><br></pre></td></tr></table></figure></div>

<h2 id="构建项目"><a href="#构建项目" class="headerlink" title="构建项目"></a>构建项目</h2><p>对于使用 MinGW 的 Windows 用户，其命令行工具为 <strong>mingw32-make.exe</strong>，如果想要使用 <strong>make</strong> 命令来构建项目，可以在添加一个脚本命令文件作为别名，<br>这里使用 powershell 脚本作为参考，新建一个 make.pl1 文件，内容如下：</p>
<div class="highlight-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="comment">rem make.cmd</span></span><br><span class="line">mingw32-make</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># make.ps1</span></span><br><span class="line">mingw32<span class="literal">-make</span></span><br></pre></td></tr></table></figure></div>

<p>别名脚本文件可以放到 <strong>mingw32-make.exe</strong> 的同一目录下（建议），<br>也可以放到自己项目目录下</p>
<h1 id="语法特性"><a href="#语法特性" class="headerlink" title="语法特性"></a>语法特性</h1><h2 id="指针和引用"><a href="#指针和引用" class="headerlink" title="指针和引用"></a>指针和引用</h2><p>指针和引用都用来解决间接访问数据的问题。<br>指针比较灵活，但是复杂不易理解，容易引入错误。<br>引用比较简单，但是没有指针的灵活。</p>
<p><em>这里的“引用”也叫“变量名引用”</em></p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 指针作为函数参数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modifyValue</span><span class="params">(<span class="type">int</span> *ptr)</span> </span>&#123;</span><br><span class="line">    *ptr = <span class="number">100</span>; <span class="comment">// 通过指针修改原始变量的值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引用作为函数参数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modifyValue</span><span class="params">(<span class="type">int</span> &amp;ref)</span> </span>&#123;</span><br><span class="line">    ref = <span class="number">100</span>; <span class="comment">// 通过引用修改原始变量的值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="Lambda-表达式"><a href="#Lambda-表达式" class="headerlink" title="Lambda 表达式"></a>Lambda 表达式</h2><p><em>在 C++11 中引入</em></p>
<p>Lambda 表达式的基本语法如下</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line">[捕获列表](参数列表) -&gt; 返回类型 &#123; 函数体 &#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>捕获列表：用于捕获外部变量，可以是值捕获（默认）、引用捕获（&amp;）、指针捕获（*）。</li>
<li>参数列表：与普通函数的参数列表类似，可以是空。</li>
<li>返回类型：可以显式声明，也可以由编译器自动推导。</li>
<li>函数体：与普通函数的函数体类似。</li>
</ul>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 一个简单的Lambda表达式示例</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> add = [](<span class="type">int</span> a, <span class="type">int</span> b) &#123; <span class="keyword">return</span> a + b; &#125;;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Sum: &quot;</span> &lt;&lt; <span class="built_in">add</span>(<span class="number">1</span>, <span class="number">2</span>) &lt;&lt; std::endl; <span class="comment">// 输出：Sum: 3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 捕获外部变量（按值捕获）</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">10</span>, y = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">auto</span> add = [x, y]() &#123; <span class="keyword">return</span> x + y; &#125;;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Sum: &quot;</span> &lt;&lt; <span class="built_in">add</span>() &lt;&lt; std::endl; <span class="comment">// 输出：Sum: 15</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 捕获外部变量（按引用捕获）</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">10</span>, y = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">auto</span> add = [&amp;x, &amp;y]() &#123; <span class="keyword">return</span> x + y; &#125;;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Sum: &quot;</span> &lt;&lt; <span class="built_in">add</span>() &lt;&lt; std::endl; <span class="comment">// 输出：Sum: 15</span></span><br><span class="line">    x = <span class="number">20</span>;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Sum: &quot;</span> &lt;&lt; <span class="built_in">add</span>() &lt;&lt; std::endl; <span class="comment">// 输出：Sum: 25</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Lambda常用于STL算法中，例如sort</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> arr[] = &#123;<span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">9</span>&#125;;</span><br><span class="line">    std::<span class="built_in">sort</span>(arr, arr + <span class="number">5</span>, [](<span class="type">int</span> a, <span class="type">int</span> b) &#123; <span class="keyword">return</span> a &gt; b; &#125;);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        std::cout &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// 输出：9 8 5 2 1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h1><h2 id="异步回调"><a href="#异步回调" class="headerlink" title="异步回调"></a>异步回调</h2><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// C++异步回掉函数使用</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">async_operation</span><span class="params">(<span class="type">int</span> i, std::function&lt;<span class="type">void</span>(<span class="type">int</span>)&gt; callback)</span> </span>&#123;</span><br><span class="line">    std::<span class="built_in">thread</span>([i, callback] &#123;</span><br><span class="line">        std::this_thread::<span class="built_in">sleep_for</span>(std::chrono::<span class="built_in">seconds</span>(<span class="number">1</span>));</span><br><span class="line">        <span class="built_in">callback</span>(i * i);</span><br><span class="line">    &#125;).<span class="built_in">detach</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">async_operation</span>(i, [](<span class="type">int</span> result) &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;Result: &quot;</span> &lt;&lt; result &lt;&lt; std::endl;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 防止主线程提前退出</span></span><br><span class="line">    std::this_thread::<span class="built_in">sleep_for</span>(std::chrono::<span class="built_in">seconds</span>(<span class="number">2</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h2 id="非阻塞等待线程执行"><a href="#非阻塞等待线程执行" class="headerlink" title="非阻塞等待线程执行"></a>非阻塞等待线程执行</h2><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 非阻塞等待</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;atomic&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;condition_variable&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::atomic&lt;<span class="type">bool</span>&gt; flag&#123;<span class="literal">false</span>&#125;;</span><br><span class="line">std::mutex mtx;</span><br><span class="line">std::condition_variable cv;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 其他线程修改 flag 后触发通知</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">other_thread_logic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ... 其他逻辑</span></span><br><span class="line">    flag.<span class="built_in">store</span>(<span class="literal">true</span>);</span><br><span class="line">    cv.<span class="built_in">notify_one</span>(); <span class="comment">// 通知等待线程</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主线程等待逻辑</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">wait_logic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>;</span><br><span class="line">    cv.<span class="built_in">wait</span>(lock, [] &#123; <span class="keyword">return</span> flag.<span class="built_in">load</span>(); &#125;); <span class="comment">// 非阻塞等待</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 若需设置最大等待时间，可使用cv.wait_for()</span></span><br><span class="line">    <span class="comment">// cv.wait_for(lock, 10s, [] &#123; return flag.load(); &#125;);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 后续逻辑</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://blog.csdn.net/qq_41839588/article/details/132267196/" >Makefile 从入门到上手 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>VSCode</tag>
        <tag>MinGW</tag>
      </tags>
  </entry>
  <entry>
    <title>CSS函数linear-gradient实现的渐变效果</title>
    <url>/2023/06/05/CSS%E5%87%BD%E6%95%B0linear-gradient%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B8%90%E5%8F%98%E6%95%88%E6%9E%9C/</url>
    <content><![CDATA[<h1 id="linear-gradient"><a href="#linear-gradient" class="headerlink" title="linear-gradient"></a>linear-gradient</h1><p>CSS方法 <em>linear-gradient</em> 创建一个有渐变效果的图片，所以它一般被作为 background-image&#x2F;border-image&#x2F;… 属性的值</p>
<h2 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h2><ul>
<li>参数1：表示颜色延申的方向<ul>
<li>to right ：向右延申</li>
<li>to bottom ：向下延申</li>
<li>to left ：向左延申</li>
<li>to top ：向上延申</li>
<li>to right bottom ：向右下方延申</li>
<li>180deg ：用角度表示延申方向</li>
</ul>
</li>
<li>后续参数：表示颜色及其配置<ul>
<li>blue ：只写颜色</li>
<li>blue 30% ：颜色和该颜色停止的地方，第一个和最后一个颜色会默认向前后延申到0%和100%</li>
</ul>
</li>
</ul>
<h2 id="方向条纹"><a href="#方向条纹" class="headerlink" title="方向条纹"></a>方向条纹</h2><h3 id="横向条纹"><a href="#横向条纹" class="headerlink" title="横向条纹"></a>横向条纹</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025376_5a2c74b97cd132bce00fca0c161c4dcc.png"
                     
                ></p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(to right, red, blue, green, yellow);</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="竖向条纹"><a href="#竖向条纹" class="headerlink" title="竖向条纹"></a>竖向条纹</h3><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(to bottom, red, blue, green, yellow);</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="斜上方45°条纹"><a href="#斜上方45°条纹" class="headerlink" title="斜上方45°条纹"></a>斜上方45°条纹</h3><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(<span class="number">45deg</span>, red, blue, green, yellow);</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="颜色和终止点"><a href="#颜色和终止点" class="headerlink" title="颜色和终止点"></a>颜色和终止点</h2><p>下面的案例中，红色在10%处停止，蓝色在20%处停止，绿色在30%处停止，而黄色也在30%处停止，但是因为最后一个颜色会默认延申到100%，所以绿色和黄色没有渐变过程，棱角分明<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025376_2fc81f82fe7a267f40309d6c8f3d90a3.png"
                     
                ></p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(to right, red <span class="number">10%</span>, blue <span class="number">20%</span>, green <span class="number">30%</span>, yellow <span class="number">30%</span>);</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="黑白条纹"><a href="#黑白条纹" class="headerlink" title="黑白条纹"></a>黑白条纹</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025377_f0243d7d58bb0621cfb4166edb5621d6.png"
                     
                ></p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: gray;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(</span></span><br><span class="line"><span class="language-css">                    to right,</span></span><br><span class="line"><span class="language-css">                    black <span class="number">60%</span>,</span></span><br><span class="line"><span class="language-css">                    white <span class="number">60%</span></span></span><br><span class="line"><span class="language-css">                );</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-size</span>: <span class="number">50px</span> <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-repeat</span>: repeat-x;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">transform</span>: <span class="built_in">skew</span>(<span class="number">45deg</span>);</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="conic-gradient"><a href="#conic-gradient" class="headerlink" title="conic-gradient"></a>conic-gradient</h1><h2 id="金属螺纹按钮效果"><a href="#金属螺纹按钮效果" class="headerlink" title="金属螺纹按钮效果"></a>金属螺纹按钮效果</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025378_dc0ef820b881b451b6d84c5e75e7056c.png"
                     
                ></p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-image</span>: <span class="built_in">conic-gradient</span>(white,gray,white,gray,white,gray,white,gray,white,gray,white);</span></span><br><span class="line"><span class="language-css">                <span class="attribute">box-shadow</span>: -<span class="number">2px</span> -<span class="number">2px</span> <span class="number">0</span> <span class="number">0</span> gray;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="radial-gradient"><a href="#radial-gradient" class="headerlink" title="radial-gradient"></a>radial-gradient</h1><p>等待后续补充</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
      </tags>
  </entry>
  <entry>
    <title>DOM滚动触底检测</title>
    <url>/2023/04/23/DOM%E6%BB%9A%E5%8A%A8%E8%A7%A6%E5%BA%95%E6%A3%80%E6%B5%8B/</url>
    <content><![CDATA[<p>这里用到了几个基本的css变量：</p>
<ul>
<li>clientHeight：可视区域的高度</li>
<li>scrollTop：可视区域距离父容器顶部的距离</li>
<li>scrollHeight：父容器内部总高度，包括被卷(scroll)的高度</li>
<li>clientWidth：可视区域的宽度</li>
<li>scrollLeft：可视区域距离父容器左部的距离</li>
<li>scrollWidth：父容器内部总宽度，包括被卷(scroll)的宽度</li>
</ul>
<p>上代码~</p>
<span id="more"></span>

<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#wrapper</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">280px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">overflow-y</span>: scroll;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: black;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#inner</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">1000px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#wrapper2</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">280px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">overflow-x</span>: scroll;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: black;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#inner2</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">1000px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>触底触顶检测<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;inner&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>触左触右检测<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;wrapper2&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;inner2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> $wrapper = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;wrapper&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        $wrapper.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, (<span class="function">(<span class="params">&#123;target&#125;</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> touchBottom = target.<span class="property">clientHeight</span> + target.<span class="property">scrollTop</span> === target.<span class="property">scrollHeight</span>,</span></span><br><span class="line"><span class="language-javascript">                touchTop = target.<span class="property">scrollTop</span> === <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`touchBottom: <span class="subst">$&#123;touchBottom&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`touchTop: <span class="subst">$&#123;touchTop&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(touchBottom) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">alert</span>(<span class="string">&#x27;滚动触底了！&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(touchTop) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">alert</span>(<span class="string">&#x27;滚动触顶了！&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;))</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> $wrapper2 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;wrapper2&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        $wrapper2.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, (<span class="function">(<span class="params">&#123;target&#125;</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> touchRight = target.<span class="property">clientWidth</span> + target.<span class="property">scrollLeft</span> === target.<span class="property">scrollWidth</span>,</span></span><br><span class="line"><span class="language-javascript">                touchLeft = target.<span class="property">scrollLeft</span> === <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`touchRight: <span class="subst">$&#123;touchRight&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`touchLeft: <span class="subst">$&#123;touchLeft&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(touchRight) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">alert</span>(<span class="string">&#x27;滚动触右了！&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(touchLeft) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">alert</span>(<span class="string">&#x27;滚动触左了！&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;))</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
        <tag>javascript</tag>
        <tag>特效</tag>
      </tags>
  </entry>
  <entry>
    <title>Day.js和Moment.js的常用方法</title>
    <url>/2024/07/19/Day-js%E5%92%8CMoment-js%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<p>项目中经常会使用 Day.js 和 Moment.js 来操作日期时间，但老是忘记常用方法，去官网查 API，有时候官网打不开或者卡的要死，所以写了个简单的笔记。</p>
<span id="more"></span>

<h1 id="安装和引入"><a href="#安装和引入" class="headerlink" title="安装和引入"></a>安装和引入</h1><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Day.js</span></span><br><span class="line">npm install dayjs</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Day.js</span></span><br><span class="line"><span class="keyword">let</span> dayjs = <span class="built_in">require</span>(<span class="string">&quot;dayjs&quot;</span>);</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Moment.js</span></span><br><span class="line">npm install moment</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Moment.js</span></span><br><span class="line"><span class="keyword">let</span> moment = <span class="built_in">require</span>(<span class="string">&quot;moment&quot;</span>);</span><br></pre></td></tr></table></figure></div>

<h1 id="解析"><a href="#解析" class="headerlink" title="解析"></a>解析</h1><p>所谓解析，就是一众不是 Day.js&#x2F;Moment.js 对象的数据，通过 Day.js&#x2F;Moment.js 解析成 Day.js&#x2F;Moment.js 对象。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Day.js</span></span><br><span class="line"><span class="title function_">dayjs</span>(); <span class="comment">// 当前时间</span></span><br><span class="line"><span class="title function_">dayjs</span>(<span class="string">&quot;2018-04-04T16:00:00.000Z&quot;</span>); <span class="comment">// ISO 8601格式字符串</span></span><br><span class="line"><span class="title function_">dayjs</span>(<span class="string">&quot;2018-04-04&quot;</span>); <span class="comment">// ISO 8601格式字符串</span></span><br><span class="line">dayjs.<span class="title function_">extend</span>(customParseFormat);</span><br><span class="line"><span class="title function_">dayjs</span>(<span class="string">&quot;1995-12-25 12:29:03.329&quot;</span>, <span class="string">&quot;YYYY-MM-DD HH:mm:ss.SSS&quot;</span>); <span class="comment">// 自定义格式字符串：年-月-日 时:分:秒.毫秒</span></span><br><span class="line"><span class="title function_">dayjs</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()); <span class="comment">// Date对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Moment.js</span></span><br><span class="line"><span class="title function_">moment</span>(); <span class="comment">// 当前时间</span></span><br><span class="line"><span class="title function_">moment</span>(<span class="string">&quot;2018-04-04T16:00:00.000Z&quot;</span>); <span class="comment">// ISO 8601格式字符串</span></span><br><span class="line"><span class="title function_">moment</span>(<span class="string">&quot;2018-04-04&quot;</span>);</span><br><span class="line"><span class="title function_">moment</span>(<span class="string">&quot;1995-12-25 12:29:03.329&quot;</span>, <span class="string">&quot;YYYY-MM-DD HH:mm:ss.SSS&quot;</span>); <span class="comment">// 自定义格式字符串：年-月-日 时:分:秒.毫秒</span></span><br><span class="line"><span class="title function_">moment</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()); <span class="comment">// Date对象</span></span><br></pre></td></tr></table></figure></div>

<h1 id="展示"><a href="#展示" class="headerlink" title="展示"></a>展示</h1><p>所谓展示，就是 Day.js&#x2F;Moment.js 对象，通过 Day.js&#x2F;Moment.js 转换成格式化的日期时间字符串。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Day.js</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM-DD HH:mm:ss.SSS d&quot;</span>); <span class="comment">// 输出：2024-07-19 15:16:26.000 3（最后这个3代表周几，周日为0，周六为6）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Moment.js</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM-DD HH:mm:ss.SSS d&quot;</span>); <span class="comment">// 输出：2024-07-19 15:16:26.000 3（最后这个3代表周几，周日为0，周六为6）</span></span><br></pre></td></tr></table></figure></div>

<h2 id="获取月天数"><a href="#获取月天数" class="headerlink" title="获取月天数"></a>获取月天数</h2><p>获取一个月有多少天</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Day.js</span></span><br><span class="line"><span class="title function_">dayjs</span>(<span class="string">&quot;2019-01-25&quot;</span>).<span class="title function_">daysInMonth</span>(); <span class="comment">// 31</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Moment.js</span></span><br><span class="line"><span class="title function_">moment</span>(<span class="string">&quot;2019-01-25&quot;</span>).<span class="title function_">daysInMonth</span>(); <span class="comment">// 31</span></span><br></pre></td></tr></table></figure></div>

<h2 id="格式化秒数"><a href="#格式化秒数" class="headerlink" title="格式化秒数"></a>格式化秒数</h2><p>常见业务，需要把秒数&#x2F;分钟数转换为“xx 小时 xx 分钟 xx 秒”的形式。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Day.js</span></span><br><span class="line"><span class="keyword">const</span> seconds = <span class="number">123456789</span>;</span><br><span class="line"><span class="keyword">const</span> utc = <span class="built_in">require</span>(<span class="string">&quot;dayjs/plugin/utc&quot;</span>);</span><br><span class="line">dayjs.<span class="title function_">extend</span>(utc);</span><br><span class="line">dayjs.<span class="title function_">utc</span>(seconds * <span class="number">1000</span>).<span class="title function_">format</span>(<span class="string">&quot;H 小时 m 分钟 s 秒&quot;</span>); <span class="comment">// “21 小时 33 分钟 9 秒”。中国时区需要使用utc来防止多出8个小时。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Moment.js</span></span><br><span class="line"><span class="keyword">const</span> seconds = <span class="number">123456789</span>;</span><br><span class="line">moment.<span class="title function_">utc</span>(seconds * <span class="number">1000</span>).<span class="title function_">format</span>(<span class="string">&quot;H 小时 m 分钟 s 秒&quot;</span>); <span class="comment">// “21 小时 33 分钟 9 秒”。中国时区需要使用utc来防止多出8个小时。</span></span><br></pre></td></tr></table></figure></div>

<h2 id="获取原生-Date-对象"><a href="#获取原生-Date-对象" class="headerlink" title="获取原生 Date 对象"></a>获取原生 Date 对象</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Day.js</span></span><br><span class="line"><span class="title function_">dayjs</span>(<span class="string">&quot;2019-01-25&quot;</span>).<span class="title function_">toDate</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Moment.js</span></span><br><span class="line"><span class="title function_">moment</span>(<span class="string">&quot;2019-01-25&quot;</span>).<span class="title function_">toDate</span>();</span><br></pre></td></tr></table></figure></div>

<h1 id="计算"><a href="#计算" class="headerlink" title="计算"></a>计算</h1><p>所谓计算，就是 Day.js&#x2F;Moment.js 对象，通过 Day.js&#x2F;Moment.js 计算得到新的 Day.js&#x2F;Moment.js 对象。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Day.js</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;day&quot;</span>); <span class="comment">// 加1天</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;week&quot;</span>); <span class="comment">// 加1周</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;month&quot;</span>); <span class="comment">// 加1月（注意月份的范围是0-11）</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;year&quot;</span>); <span class="comment">// 加1年</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;hour&quot;</span>); <span class="comment">// 加1小时</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;minute&quot;</span>); <span class="comment">// 加1分钟</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;second&quot;</span>); <span class="comment">// 加1秒</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;millisecond&quot;</span>); <span class="comment">// 加1毫秒</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;day&quot;</span>); <span class="comment">// 减1天</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;week&quot;</span>); <span class="comment">// 减1周</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;month&quot;</span>); <span class="comment">// 减1月（注意月份的范围是0-11）</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;year&quot;</span>); <span class="comment">// 减1年</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;hour&quot;</span>); <span class="comment">// 减1小时</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;minute&quot;</span>); <span class="comment">// 减1分钟</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;second&quot;</span>); <span class="comment">// 减1秒</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;millisecond&quot;</span>); <span class="comment">// 减1毫秒</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Moment.js</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;days&quot;</span>); <span class="comment">// 加1天</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;weeks&quot;</span>); <span class="comment">// 加1周</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;months&quot;</span>); <span class="comment">// 加1月（注意月份的范围是0-11）</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;years&quot;</span>); <span class="comment">// 加1年</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;hours&quot;</span>); <span class="comment">// 加1小时</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;minutes&quot;</span>); <span class="comment">// 加1分钟</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;seconds&quot;</span>); <span class="comment">// 加1秒</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;milliseconds&quot;</span>); <span class="comment">// 加1毫秒</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;days&quot;</span>); <span class="comment">// 减1天</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;weeks&quot;</span>); <span class="comment">// 减1周</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;months&quot;</span>); <span class="comment">// 减1月（注意月份的范围是0-11）</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;years&quot;</span>); <span class="comment">// 减1年</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;hours&quot;</span>); <span class="comment">// 减1小时</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;minutes&quot;</span>); <span class="comment">// 减1分钟</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;seconds&quot;</span>); <span class="comment">// 减1秒</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">subtract</span>(<span class="number">1</span>, <span class="string">&quot;milliseconds&quot;</span>); <span class="comment">// 减1毫秒</span></span><br></pre></td></tr></table></figure></div>

<h2 id="差异（Diff）"><a href="#差异（Diff）" class="headerlink" title="差异（Diff）"></a>差异（Diff）</h2><p>计算两个日期之间相差多少个年&#x2F;月&#x2F;日&#x2F;周等单位</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Day.js</span></span><br><span class="line"><span class="comment">// 参考：https://dayjs.fenxianglu.cn/category/display.html#%E5%B7%AE%E5%BC%82-diff</span></span><br><span class="line"><span class="keyword">const</span> date1 = <span class="title function_">dayjs</span>(<span class="string">&quot;2019-01-25&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> date2 = <span class="title function_">dayjs</span>(<span class="string">&quot;2018-06-05&quot;</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">第一个参数可以是Day.js/String/Date/Number/Array类型</span></span><br><span class="line"><span class="comment">第二个参数是单位，默认是毫秒</span></span><br><span class="line"><span class="comment">第三个参数表示是否【保留】小数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">date1.<span class="title function_">diff</span>(date2, <span class="string">&#x27;month&#x27;</span>，<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Moment.js</span></span><br><span class="line"><span class="comment">// 参考：https://momentjs.com/docs/#/displaying/difference/</span></span><br><span class="line"><span class="keyword">const</span> date1 = <span class="title function_">moment</span>(<span class="string">&quot;2019-01-25&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> date2 = <span class="title function_">moment</span>(<span class="string">&quot;2018-06-05&quot;</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">第一个参数可以是Moment.js/String/Date/Number/Array类型</span></span><br><span class="line"><span class="comment">第二个参数是单位，默认是毫秒</span></span><br><span class="line"><span class="comment">第三个参数表示是否【舍去】小数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">date1.<span class="title function_">diff</span>(date2, <span class="string">&#x27;months&#x27;</span>, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure></div>

<h2 id="时间的开始和结束"><a href="#时间的开始和结束" class="headerlink" title="时间的开始和结束"></a>时间的开始和结束</h2><p>获取一个日期的年&#x2F;月&#x2F;周等单位的开始和结束日期</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Day.js</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">startOf</span>(<span class="string">&quot;month&quot;</span>); <span class="comment">// 当月第一天</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">endOf</span>(<span class="string">&quot;month&quot;</span>); <span class="comment">// 当月最后一天</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Moment.js</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">startOf</span>(<span class="string">&quot;months&quot;</span>); <span class="comment">// 当月第一天</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">endOf</span>(<span class="string">&quot;month&quot;</span>); <span class="comment">// 当月最后一天</span></span><br></pre></td></tr></table></figure></div>

<h1 id="取值-x2F-赋值"><a href="#取值-x2F-赋值" class="headerlink" title="取值&#x2F;赋值"></a>取值&#x2F;赋值</h1><p>所谓取值&#x2F;赋值，就是 Day.js&#x2F;Moment.js 对象，通过 Day.js&#x2F;Moment.js 设置&#x2F;获取属性。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Day.js</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">year</span>(); <span class="comment">// 获取年(参数为空时取值，参数不为空时赋值)</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">month</span>(); <span class="comment">// 获取月(参数为空时取值，参数不为空时赋值)，传入0到11的 number。 如果超出这个范围，它会进位到年份。</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">date</span>(); <span class="comment">// 获取日(参数为空时取值，参数不为空时赋值)，接受1到31的数字。 如果超出这个范围，它会进位到月份。</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">day</span>(); <span class="comment">// 获取周(参数为空时取值，参数不为空时赋值)，传入0到6的 number。 如果超出这个范围，它会进位到其他周。</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">hour</span>(); <span class="comment">// 获取时(参数为空时取值，参数不为空时赋值)，传入0到23的数字。 如果超出这个范围，它会进位到天数。</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">minute</span>(); <span class="comment">// 获取分(参数为空时取值，参数不为空时赋值)，传入0到59的数字。 如果超出这个范围，它会进位到小时。</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">second</span>(); <span class="comment">// 获取秒(参数为空时取值，参数不为空时赋值)，传入0到59的数字。 如果超出这个范围，它会进位到分钟。</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">millisecond</span>(); <span class="comment">// 获取毫秒(参数为空时取值，参数不为空时赋值)，传入0到999的数字。 如果超出这个范围，它会进位到秒。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Moment.js</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">year</span>(); <span class="comment">// 获取年(参数为空时取值，参数不为空时赋值)</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">month</span>(); <span class="comment">// 获取月(参数为空时取值，参数不为空时赋值)，传入0到11的 number。 如果超出这个范围，它会进位到年份。</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">date</span>(); <span class="comment">// 获取日(参数为空时取值，参数不为空时赋值)，接受1到31的数字。 如果超出这个范围，它会进位到月份。</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">day</span>(); <span class="comment">// 获取周(参数为空时取值，参数不为空时赋值)，传入0到6的 number。 如果超出这个范围，它会进位到其他周。</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">hour</span>(); <span class="comment">// 获取时(参数为空时取值，参数不为空时赋值)，传入0到23的数字。 如果超出这个范围，它会进位到天数。</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">minute</span>(); <span class="comment">// 获取分(参数为空时取值，参数不为空时赋值)，传入0到59的数字。 如果超出这个范围，它会进位到小时。</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">second</span>(); <span class="comment">// 获取秒(参数为空时取值，参数不为空时赋值)，传入0到59的数字。 如果超出这个范围，它会进位到分钟。</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">millisecond</span>(); <span class="comment">// 获取毫秒(参数为空时取值，参数不为空时赋值)，传入0到999的数字。 如果超出这个范围，它会进位到秒。</span></span><br></pre></td></tr></table></figure></div>

<h1 id="克隆"><a href="#克隆" class="headerlink" title="克隆"></a>克隆</h1><p>所有的 Day.js&#x2F;Moment.js 对象都是不可变的。 但如果有必要，使用 dayjs#clone 可以复制出一个当前对象。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Day.js</span></span><br><span class="line"><span class="title function_">dayjs</span>().<span class="title function_">clone</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Moment.js</span></span><br><span class="line"><span class="title function_">moment</span>().<span class="title function_">clone</span>();</span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://dayjs.fenxianglu.cn/category/" >Day.js <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://momentjs.com/docs/" >Moment.js <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>DOM打印以及转PDF的实现</title>
    <url>/2024/11/20/DOM%E6%89%93%E5%8D%B0%E4%BB%A5%E5%8F%8A%E8%BD%ACPDF%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    <content><![CDATA[<p>将网页中的指定 DOM 在保持原来样式的情况下转换为 canvas，然后进行后续操作</p>
<span id="more"></span>

<h1 id="打印"><a href="#打印" class="headerlink" title="打印"></a>打印</h1><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> html2canvas <span class="keyword">from</span> <span class="string">&quot;html2canvas&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> printJs <span class="keyword">from</span> <span class="string">&quot;print-js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将dom原封不动的通过打印机打印出来。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">dom</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">printHtml</span>(<span class="params">dom</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">html2canvas</span>(dom, &#123;</span><br><span class="line">      <span class="attr">allowTaint</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">scrollY</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">scrollX</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">useCORS</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">width</span>: dom.<span class="property">offsetWidth</span>,</span><br><span class="line">      <span class="attr">height</span>: dom.<span class="property">offsetHeight</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">(<span class="params">canvas</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> imgBase64 = canvas.<span class="title function_">toDataURL</span>(<span class="string">&quot;image/png&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="title function_">printJs</span>(&#123;</span><br><span class="line">          <span class="attr">printable</span>: imgBase64,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;image&quot;</span>,</span><br><span class="line">          <span class="attr">style</span>:</span><br><span class="line">            <span class="string">&quot;@media print &#123; @page &#123;size: auto; margin: 0; &#125; body&#123;margin:0 5px&#125;&#125;&quot;</span>, <span class="comment">//去除页眉页脚，size设置打印尺寸,</span></span><br><span class="line">          <span class="attr">onError</span>: <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">reject</span>(err);</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">onLoadingStart</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(&#123;</span><br><span class="line">              canvas,</span><br><span class="line">              imgBase64,</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(err);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="转-PDF"><a href="#转-PDF" class="headerlink" title="转 PDF"></a>转 PDF</h1><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> html2canvas <span class="keyword">from</span> <span class="string">&quot;html2canvas&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; jsPDF &#125; <span class="keyword">from</span> <span class="string">&quot;jspdf&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将dom原封不动的转化为PDF文件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">dom</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">html2Pdf</span>(<span class="params">dom, title = <span class="string">&quot;file&quot;</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">html2canvas</span>(dom, &#123;</span><br><span class="line">      <span class="attr">allowTaint</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">scrollY</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">scrollX</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">useCORS</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">width</span>: dom.<span class="property">offsetWidth</span>,</span><br><span class="line">      <span class="attr">height</span>: dom.<span class="property">offsetHeight</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">(<span class="params">canvas</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 根据宽度和高度那个更大来判断采用水平还是竖直排版</span></span><br><span class="line">        <span class="keyword">let</span> widthHeightDiff = canvas.<span class="property">width</span> - canvas.<span class="property">height</span>;</span><br><span class="line">        <span class="keyword">let</span> orientation = widthHeightDiff &gt; <span class="number">0</span> ? <span class="string">&quot;landscape&quot;</span> : <span class="string">&quot;portrait&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建pdf对象</span></span><br><span class="line">        <span class="keyword">let</span> pdf = <span class="keyword">new</span> <span class="title function_">jsPDF</span>(orientation, <span class="string">&quot;px&quot;</span>, [canvas.<span class="property">width</span>, canvas.<span class="property">height</span>]);</span><br><span class="line">        pdf.<span class="title function_">addImage</span>(canvas, <span class="string">&quot;png&quot;</span>, <span class="number">0</span>, <span class="number">0</span>, canvas.<span class="property">width</span>, canvas.<span class="property">height</span>);</span><br><span class="line">        pdf.<span class="title function_">save</span>(title + <span class="string">&quot;.pdf&quot;</span>);</span><br><span class="line">        <span class="title function_">resolve</span>();</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(err);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="第三方库"><a href="#第三方库" class="headerlink" title="第三方库"></a>第三方库</h1><p><a class="link"   href="https://www.npmjs.com/package/html2canvas" >html2canvas <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.npmjs.com/package/jspdf" >jspdf <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.npmjs.com/package/print-js" >print-js <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://cloud.tencent.com/developer/article/1907173" >前端生成 pdf，jspdf+html2Canvas 的使用(vue) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>canvas</tag>
      </tags>
  </entry>
  <entry>
    <title>ECharts常见图表样式需求总结</title>
    <url>/2024/07/23/ECharts%E5%B8%B8%E8%A7%81%E5%9B%BE%E8%A1%A8%E6%A0%B7%E5%BC%8F%E9%9C%80%E6%B1%82%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<p>因为不熟悉，每次需要画图表的时候我都要去官网查文档，并且 ECharts 官网老是打不开，效率很低，所以就写了一个简单的 ECharts 图表样式汇总。</p>
<span id="more"></span>

<h1 id="安装及引入"><a href="#安装及引入" class="headerlink" title="安装及引入"></a>安装及引入</h1><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">npm install echarts</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入echarts</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ECharts</span> <span class="keyword">from</span> <span class="string">&quot;echarts&quot;</span>;</span><br></pre></td></tr></table></figure></div>

<h1 id="常用配置"><a href="#常用配置" class="headerlink" title="常用配置"></a>常用配置</h1><h2 id="柱状图-x2F-折线图"><a href="#柱状图-x2F-折线图" class="headerlink" title="柱状图&#x2F;折线图"></a>柱状图&#x2F;折线图</h2><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;chart&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%; height: 400px&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> chartsInstance = <span class="title class_">ECharts</span>.<span class="title function_">init</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;chart&quot;</span>));</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> option = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">legend</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 图列组件展示开关</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">data</span>: [&#123; <span class="attr">name</span>: <span class="string">&quot;成本&quot;</span> &#125;, &#123; <span class="attr">name</span>: <span class="string">&quot;收入&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">bottom</span>: <span class="string">&quot;0%&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">right</span>: <span class="string">&quot;0%&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">tooltip</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 提示框展示开关，一个跟随鼠标展示数据详细信息的框</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">grid</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">left</span>: <span class="string">&quot;20%&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">top</span>: <span class="string">&quot;20%&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">right</span>: <span class="string">&quot;0%&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">bottom</span>: <span class="string">&quot;0%&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">containLabel</span>: <span class="literal">true</span>, <span class="comment">// 是否包含各种标签，否则当left,right,top,bottom为0%时会隐藏标签。</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">xAxis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// x轴展示开关</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">boundaryGap</span>: <span class="literal">true</span>, <span class="comment">// 坐标轴两边留白策略，类目轴和非类目轴的设置和表现不一样。默认为true</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&quot;category&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">data</span>: [<span class="string">&quot;Mon&quot;</span>, <span class="string">&quot;Tue&quot;</span>, <span class="string">&quot;Wed&quot;</span>, <span class="string">&quot;Thu&quot;</span>, <span class="string">&quot;Fri&quot;</span>, <span class="string">&quot;Sat&quot;</span>, <span class="string">&quot;Sun&quot;</span>],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">axisPointer</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 坐标轴指示器，跟随鼠标移动的分割线</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="string">&quot;shadow&quot;</span>, <span class="comment">// 指示器类型，line,shadow</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 指示器文本标签展示开关</span></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 其他和axisLabel配置一致</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">lineStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 其他和lineStyle配置一致</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">shadowStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 其他和areaStyle配置一致</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">axisLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 轴线展示开关</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">lineStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;yellow&quot;</span>, <span class="comment">// 轴线颜色</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">width</span>: <span class="number">3</span>, <span class="comment">// 轴线宽度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">0.5</span>, <span class="comment">// 轴线透明度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&quot;dashed&quot;</span>, <span class="comment">// 轴线类型：solid,dashed,dotted</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">axisTick</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 刻度线展示开关</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">alignWithLabel</span>: <span class="literal">true</span>, <span class="comment">// 类目轴中在 boundaryGap 为 true 的时候有效，可以保证刻度线和标签对齐</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">inside</span>: <span class="literal">false</span>, <span class="comment">// 刻度线向内还是向外延申</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">length</span>: <span class="number">10</span>, <span class="comment">// 刻度线长度</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">lineStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;green&quot;</span>, <span class="comment">// 轴线颜色</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">width</span>: <span class="number">5</span>, <span class="comment">// 轴线宽度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">1</span>, <span class="comment">// 轴线透明度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&quot;solid&quot;</span>, <span class="comment">// 轴线类型：solid,dashed,dotted</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">axisLabel</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 刻度标签展示开关</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">color</span>: <span class="string">&quot;gold&quot;</span>, <span class="comment">// 刻度标签颜色</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">fontSize</span>: <span class="number">16</span>, <span class="comment">// 刻度标签字体大小</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">rotate</span>: <span class="number">45</span>, <span class="comment">// 刻度标签旋转的角度，-90 ~ 90</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">formatter</span>: <span class="function">(<span class="params">value, index</span>) =&gt;</span> <span class="string">`<span class="subst">$&#123;value&#125;</span>-d<span class="subst">$&#123;index&#125;</span>`</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">splitLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 分割线展示开关</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">lineStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;white&quot;</span>, <span class="comment">// 轴线颜色</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">width</span>: <span class="number">1</span>, <span class="comment">// 轴线宽度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">1</span>, <span class="comment">// 轴线透明度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&quot;dashed&quot;</span>, <span class="comment">// 轴线类型：solid,dashed,dotted</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">splitArea</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 分隔区域展示开关</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">areaStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>],</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">0.1</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">yAxis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&quot;value&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// y轴展示开关</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">axisPointer</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 坐标轴指示器，跟随鼠标移动的分割线</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="string">&quot;line&quot;</span>, <span class="comment">// 指示器类型，line,shadow</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 指示器文本标签展示开关</span></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 其他和axisLabel配置一致</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">lineStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 其他和lineStyle配置一致</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">shadowStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 其他和areaStyle配置一致</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">axisLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 轴线展示开关</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">lineStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;blue&quot;</span>, <span class="comment">// 轴线颜色</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">width</span>: <span class="number">3</span>, <span class="comment">// 轴线宽度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">0.5</span>, <span class="comment">// 轴线透明度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&quot;dotted&quot;</span>, <span class="comment">// 轴线类型：solid,dashed,dotted</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">axisTick</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 刻度线展示开关</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">alignWithLabel</span>: <span class="literal">true</span>, <span class="comment">// 类目轴中在 boundaryGap 为 true 的时候有效，可以保证刻度线和标签对齐</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">inside</span>: <span class="literal">false</span>, <span class="comment">// 刻度线向内还是向外延申</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">length</span>: <span class="number">10</span>, <span class="comment">// 刻度线长度</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">lineStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;orange&quot;</span>, <span class="comment">// 轴线颜色</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">width</span>: <span class="number">5</span>, <span class="comment">// 轴线宽度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">1</span>, <span class="comment">// 轴线透明度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&quot;solid&quot;</span>, <span class="comment">// 轴线类型：solid,dashed,dotted</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">axisLabel</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 刻度标签展示开关</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">color</span>: <span class="string">&quot;black&quot;</span>, <span class="comment">// 刻度标签颜色</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">fontSize</span>: <span class="number">14</span>, <span class="comment">// 刻度标签字体大小</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">rotate</span>: <span class="number">45</span>, <span class="comment">// 刻度标签旋转的角度，-90 ~ 90</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">formatter</span>: <span class="function">(<span class="params">value, index</span>) =&gt;</span> <span class="string">`<span class="subst">$&#123;value&#125;</span>-i<span class="subst">$&#123;index&#125;</span>`</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">splitLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 分割线展示开关</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">lineStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;black&quot;</span>, <span class="comment">// 轴线颜色</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">width</span>: <span class="number">2</span>, <span class="comment">// 轴线宽度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">1</span>, <span class="comment">// 轴线透明度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&quot;dotted&quot;</span>, <span class="comment">// 轴线类型：solid,dashed,dotted</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">splitArea</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 分隔区域展示开关</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">areaStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: [<span class="string">&quot;black&quot;</span>, <span class="string">&quot;white&quot;</span>],</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">0.2</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">series</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&quot;成本&quot;</span>, <span class="comment">// 配合legend</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: [<span class="number">120</span>, <span class="number">200</span>, <span class="number">150</span>, <span class="number">80</span>, <span class="number">70</span>, <span class="number">110</span>, <span class="number">130</span>],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="string">&quot;bar&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 图形上的文本标签展示开关</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">position</span>: <span class="string">&quot;inside&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;#ddd&quot;</span>, <span class="comment">// 颜色</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">fontSize</span>: <span class="number">20</span>, <span class="comment">// 字体大小</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">fontWeight</span>: <span class="string">&quot;normal&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;cyan&quot;</span>, <span class="comment">// 柱状图颜色</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">0.8</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&quot;收入&quot;</span>, <span class="comment">// 配合legend</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: [<span class="number">34</span>, <span class="number">231</span>, <span class="number">45</span>, <span class="number">23</span>, <span class="number">68</span>, <span class="number">34</span>, <span class="number">65</span>],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="string">&quot;line&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 图形上的文本标签展示开关</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">position</span>: <span class="string">&quot;outside&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;green&quot;</span>, <span class="comment">// 颜色</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">fontSize</span>: <span class="number">14</span>, <span class="comment">// 字体大小</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">fontWeight</span>: <span class="string">&quot;bold&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 折线连接处样式</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;yellow&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">lineStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 折线线段样式</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;red&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">0.6</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">areaStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 折线区域样式</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;orange&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">opacity</span>: <span class="number">0.5</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">  chartsInstance.<span class="title function_">setOption</span>(option);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="饼图"><a href="#饼图" class="headerlink" title="饼图"></a>饼图</h2><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;chart&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%; height: 400px&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> chartsInstance = <span class="title class_">ECharts</span>.<span class="title function_">init</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;chart&quot;</span>));</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> option = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">tooltip</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">trigger</span>: <span class="string">&quot;item&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">series</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&quot;Access From&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="string">&quot;pie&quot;</span>, <span class="comment">// 饼状图类型</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">radius</span>: [<span class="string">&quot;40%&quot;</span>, <span class="string">&quot;70%&quot;</span>], <span class="comment">// 圆环的内半径、外半径</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">center</span>: [<span class="string">&quot;55%&quot;</span>, <span class="string">&quot;55%&quot;</span>], <span class="comment">// 饼图的中心（圆心）坐标，横坐标/纵坐标。</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">roseType</span>: <span class="string">&quot;area&quot;</span>, <span class="comment">// 南丁格尔图，radius/area：前者数据越大，图元越大；后者和前者一样，除了图元圆心角都是一样的</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 圆环标签展示开关</span></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 其他和axisLabel配置一致</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">color</span>: <span class="string">&quot;blue&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">fontSize</span>: <span class="number">15</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">fontWeight</span>: <span class="string">&quot;bold&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 圆环标签引导线展示开关</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">length</span>: <span class="number">20</span>, <span class="comment">// 引导线第一段长度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">length2</span>: <span class="number">20</span>, <span class="comment">// 引导线第二段长度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">smooth</span>: <span class="number">0.3</span>, <span class="comment">// 引导线圆滑程度0~1,也可以true/false</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">lineStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 其他和lineStyle配置一致</span></span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 饼图单元样式</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">borderColor</span>: <span class="string">&quot;#ccc&quot;</span>, <span class="comment">// 单元边框颜色</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">borderWidth</span>: <span class="number">20</span>, <span class="comment">// 单元边框宽度</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">borderType</span>: <span class="string">&quot;dashed&quot;</span>, <span class="comment">// 单元边框样式solid/dashed/dotted</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">emphasis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 高亮（hover）的样式</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 和series.[label]一致</span></span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 和series.[labelLine]一致</span></span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 和series.[itemStyle]一致</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">shadowBlur</span>: <span class="number">10</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">shadowOffsetX</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">shadowColor</span>: <span class="string">&quot;rgba(0, 0, 0, 0.5)&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: [</span></span><br><span class="line"><span class="language-javascript">          &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">value</span>: <span class="number">1048</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">name</span>: <span class="string">&quot;Search Engine&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">selected</span>: <span class="literal">true</span>, <span class="comment">// 图元是否选中</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[label]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[labelLine]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[itemStyle]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">emphasis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[emphasis]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">value</span>: <span class="number">735</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">name</span>: <span class="string">&quot;Direct&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">selected</span>: <span class="literal">false</span>, <span class="comment">// 图元是否选中</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[label]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[labelLine]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[itemStyle]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">emphasis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[emphasis]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">value</span>: <span class="number">580</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">name</span>: <span class="string">&quot;Email&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">selected</span>: <span class="literal">false</span>, <span class="comment">// 图元是否选中</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[label]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[labelLine]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[itemStyle]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">emphasis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[emphasis]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">value</span>: <span class="number">484</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">name</span>: <span class="string">&quot;Union Ads&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">selected</span>: <span class="literal">false</span>, <span class="comment">// 图元是否选中</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[label]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[labelLine]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[itemStyle]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">emphasis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[emphasis]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">value</span>: <span class="number">300</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">name</span>: <span class="string">&quot;Video Ads&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">selected</span>: <span class="literal">false</span>, <span class="comment">// 图元是否选中</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[label]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[labelLine]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[itemStyle]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">emphasis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 和series.[emphasis]一致</span></span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">        ],</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&quot;Access From2&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="string">&quot;pie&quot;</span>, <span class="comment">// 饼状图类型</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">radius</span>: [<span class="string">&quot;10%&quot;</span>, <span class="string">&quot;30%&quot;</span>], <span class="comment">// 圆环的内半径、外半径</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">center</span>: [<span class="string">&quot;55%&quot;</span>, <span class="string">&quot;55%&quot;</span>], <span class="comment">// 饼图的中心（圆心）坐标，横坐标/纵坐标。</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">avoidLabelOverlap</span>: <span class="literal">false</span>, <span class="comment">// 是否启用防止标签重叠策略，默认开启。当将标签放到圆环的圆心时需要设置为false，</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">position</span>: <span class="string">&quot;center&quot;</span>, <span class="comment">// 标签的显示位置，outside(外部用引导线连接)/inside(图元内部)/center(圆心)</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">emphasis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 配合series.[label.show = false]，可以实现鼠标hover图元时，圆心展示标签</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">fontWeight</span>: <span class="string">&quot;bold&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: [</span></span><br><span class="line"><span class="language-javascript">          &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">value</span>: <span class="number">1548</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">name</span>: <span class="string">&quot;Search Engine&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">selected</span>: <span class="literal">true</span>, <span class="comment">// 图元是否选中</span></span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">value</span>: <span class="number">775</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">name</span>: <span class="string">&quot;Direct&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">selected</span>: <span class="literal">false</span>, <span class="comment">// 图元是否选中</span></span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">value</span>: <span class="number">679</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">name</span>: <span class="string">&quot;Marketing&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">selected</span>: <span class="literal">false</span>, <span class="comment">// 图元是否选中</span></span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">        ],</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">  chartsInstance.<span class="title function_">setOption</span>(option);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="常用-API"><a href="#常用-API" class="headerlink" title="常用 API"></a>常用 API</h1><h2 id="渐变色"><a href="#渐变色" class="headerlink" title="渐变色"></a>渐变色</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> gradientColor = <span class="keyword">new</span> <span class="title class_">ECharts</span>.<span class="property">graphic</span>.<span class="title class_">LinearGradient</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, [</span><br><span class="line">  <span class="comment">// 柱状图边框颜色</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">offset</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&quot;#8DC0FD&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">offset</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&quot;#8DC0FD88&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure></div>

<h2 id="重置尺寸"><a href="#重置尺寸" class="headerlink" title="重置尺寸"></a>重置尺寸</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line">chartsInstance.<span class="title function_">resize</span>();</span><br></pre></td></tr></table></figure></div>

<h2 id="清空实例"><a href="#清空实例" class="headerlink" title="清空实例"></a>清空实例</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 清空当前实例，会移除实例中所有的组件和图表。</span></span><br><span class="line">chartsInstance.<span class="title function_">clear</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 销毁实例，销毁后实例无法再被使用。</span></span><br><span class="line">chartsInstance.<span class="title function_">dispose</span>();</span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://echarts.apache.org/v4/zh/option.html" >ECharts4 配置项 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://echarts.apache.org/zh/option.html" >ECharts5 配置项 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a href="/2024/04/26/%E5%9C%A8ECharts%E4%B8%AD%E7%94%BB%E4%B8%80%E4%B8%AA%E5%B8%A6%E8%BE%B9%E6%A1%86%E7%9A%84%E6%B8%90%E5%8F%98%E6%9F%B1%E7%8A%B6%E5%9B%BE/">在 ECharts 中画一个带边框的渐变柱状图</a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>特效</tag>
        <tag>ECharts</tag>
      </tags>
  </entry>
  <entry>
    <title>Mock.js常用方法</title>
    <url>/2024/07/19/Mock-js%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<p>前后端分离的项目中经常会使用 Mock.js 来生成假数据填充页面，但老是忘记常用方法，去官网查 API，有时候官网打不开或者卡的要死，所以写了个简单的笔记。</p>
<span id="more"></span>

<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">npm install mockjs</span><br></pre></td></tr></table></figure></div>

<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><h2 id="单个函数的使用"><a href="#单个函数的使用" class="headerlink" title="单个函数的使用"></a>单个函数的使用</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">Mock</span> = <span class="built_in">require</span>(<span class="string">&quot;mockjs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Basic</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回一个随机的布尔值。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 指示参数 current 出现的概率。概率计算公式为 min / (min + max)。该参数的默认值为 1，即有 50% 的概率返回参数 current。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 指示参数 current 的相反值 !current 出现的概率。概率计算公式为 max / (min + max)。该参数的默认值为 1，即有 50% 的概率返回参数 !current。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">boolean</span>&#125; current 可选值为布尔值 true 或 false。如果未传入任何参数，则返回 true 和 false 的概率各为 50%。该参数没有默认值。在该方法的内部，依据原生方法 Math.random() 返回的（浮点）数来计算和返回布尔值，例如在最简单的情况下，返回值是表达式 Math.random() &gt;= 0.5 的执行结果。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">boolean</span>(min, max, current);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回一个随机的自然数（大于等于 0 的整数）。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 指示随机自然数的最小值。默认值为 0。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 指示随机自然数的最大值。默认值为 9007199254740992。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">natural</span>(min, max);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回一个随机的整数。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 指示随机整数的最小值。默认值为 -9007199254740992。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 指示随机整数的最大值。默认值为 9007199254740992。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">integer</span>(min, max);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回一个随机的浮点数。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 整数部分的最小值。默认值为 -9007199254740992。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 整数部分的最大值。默认值为 9007199254740992。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; dmin 小数部分位数的最小值。默认值为 0。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; dmax 小数部分位数的最大值。默认值为 17。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">float</span>(min, max, dmin, dmax);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回一个随机字符。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; pool 字符串。表示字符池，将从中选择一个字符返回。如果传入了 &#x27;lower&#x27; 或 &#x27;upper&#x27;、&#x27;number&#x27;、&#x27;symbol&#x27;，表示从内置的字符池从选取</span></span><br><span class="line"><span class="comment"> * &#123;</span></span><br><span class="line"><span class="comment"> *     lower: &quot;abcdefghijklmnopqrstuvwxyz&quot;,</span></span><br><span class="line"><span class="comment"> *     upper: &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;,</span></span><br><span class="line"><span class="comment"> *     number: &quot;0123456789&quot;,</span></span><br><span class="line"><span class="comment"> *     symbol: &quot;!@#$%^&amp;*()[]&quot;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">character</span>(pool);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回一个随机字符串。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; pool 字符串。表示字符池，将从中选择一个字符返回。如果传入了 &#x27;lower&#x27; 或 &#x27;upper&#x27;、&#x27;number&#x27;、&#x27;symbol&#x27;，表示从内置的字符池从选取</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 随机字符串的最小长度。默认值为 3。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 随机字符串的最大长度。默认值为 7。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">string</span>(pool, min, max);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回一个整型数组。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; start 数组中整数的起始值。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; stop 数组中整数的结束值（不包含在返回值中）。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; step 数组中整数之间的步长。默认值为 1。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">range</span>(start, stop, step);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Date</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回一个随机的日期字符串。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; format 指示生成的日期字符串的格式。默认值为 yyyy-MM-dd。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *   Format	Description	Example</span></span><br><span class="line"><span class="comment"> *   yyyy	A full numeric representation of a year, 4 digits	1999 or 2003</span></span><br><span class="line"><span class="comment"> *   yy	A two digit representation of a year	99 or 03</span></span><br><span class="line"><span class="comment"> *   y	A two digit representation of a year	99 or 03</span></span><br><span class="line"><span class="comment"> *   MM	Numeric representation of a month, with leading zeros	01 to 12</span></span><br><span class="line"><span class="comment"> *   M	Numeric representation of a month, without leading zeros	1 to 12</span></span><br><span class="line"><span class="comment"> *   dd	Day of the month, 2 digits with leading zeros	01 to 31</span></span><br><span class="line"><span class="comment"> *   d	Day of the month without leading zeros	1 to 31</span></span><br><span class="line"><span class="comment"> *   HH	24-hour format of an hour with leading zeros	00 to 23</span></span><br><span class="line"><span class="comment"> *   H	24-hour format of an hour without leading zeros	0 to 23</span></span><br><span class="line"><span class="comment"> *   hh	12-hour format of an hour without leading zeros	1 to 12</span></span><br><span class="line"><span class="comment"> *   h	12-hour format of an hour with leading zeros	01 to 12</span></span><br><span class="line"><span class="comment"> *   mm	Minutes, with leading zeros	00 to 59</span></span><br><span class="line"><span class="comment"> *   m	Minutes, without leading zeros	0 to 59</span></span><br><span class="line"><span class="comment"> *   ss	Seconds, with leading zeros	00 to 59</span></span><br><span class="line"><span class="comment"> *   s	Seconds, without leading zeros	0 to 59</span></span><br><span class="line"><span class="comment"> *   SS	Milliseconds, with leading zeros	000 to 999</span></span><br><span class="line"><span class="comment"> *   S	Milliseconds, without leading zeros	0 to 999</span></span><br><span class="line"><span class="comment"> *   A	Uppercase Ante meridiem and Post meridiem	AM or PM</span></span><br><span class="line"><span class="comment"> *   a	Lowercase Ante meridiem and Post meridiem	am or pm</span></span><br><span class="line"><span class="comment"> *   T	Milliseconds, since 1970-1-1 00:00:00 UTC	759883437303</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">date</span>(format);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回一个随机的时间字符串。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; format 指示生成的时间字符串的格式。默认值为 HH:mm:ss。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">time</span>(format);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回一个随机的日期和时间字符串。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; format 指示生成的日期和时间字符串的格式。默认值为 yyyy-MM-dd HH:mm:ss。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">datetime</span>(format);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Image</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 生成一个随机的图片地址。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; size 指示图片的宽高，格式为 &#x27;宽x高&#x27;。默认从下面的数组中随机读取一个：</span></span><br><span class="line"><span class="comment"> [</span></span><br><span class="line"><span class="comment">    &#x27;300x250&#x27;, &#x27;250x250&#x27;, &#x27;240x400&#x27;, &#x27;336x280&#x27;, </span></span><br><span class="line"><span class="comment">    &#x27;180x150&#x27;, &#x27;720x300&#x27;, &#x27;468x60&#x27;, &#x27;234x60&#x27;, </span></span><br><span class="line"><span class="comment">    &#x27;88x31&#x27;, &#x27;120x90&#x27;, &#x27;120x60&#x27;, &#x27;120x240&#x27;, </span></span><br><span class="line"><span class="comment">    &#x27;125x125&#x27;, &#x27;728x90&#x27;, &#x27;160x600&#x27;, &#x27;120x600&#x27;, </span></span><br><span class="line"><span class="comment">    &#x27;300x600&#x27;</span></span><br><span class="line"><span class="comment">]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; background 指示图片的背景色。默认值为 &#x27;#000000&#x27;。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; foreground 指示图片的前景色（文字）。默认值为 &#x27;#FFFFFF&#x27;。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; format 指示图片的格式。默认值为 &#x27;png&#x27;，可选值包括：&#x27;png&#x27;、&#x27;gif&#x27;、&#x27;jpg&#x27;。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; text 指示图片上的文字。默认值为参数 size。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">image</span>(size, background, foreground, format, text);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 生成一段随机的 Base64 图片编码。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; size 指示图片的宽高，格式为 &#x27;宽x高&#x27;。默认从下面的数组中随机读取一个：</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; text 指示图片上的文字。默认值为参数 size。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">dataImage</span>(size, text);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Color</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个有吸引力的颜色，格式为 &#x27;#RRGGBB&#x27;。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">color</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个有吸引力的颜色，格式为 &#x27;#RRGGBB&#x27;。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">hex</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个有吸引力的颜色，格式为 &#x27;rgb(r, g, b)&#x27;。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">rgb</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个有吸引力的颜色，格式为 &#x27;rgba(r, g, b, a)&#x27;。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">rgba</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个有吸引力的颜色，格式为 &#x27;hsl(h, s, l)&#x27;。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">hsl</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Text</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一段文本。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 指示文本中句子的最小个数。默认值为 3。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 指示文本中句子的最大个数。默认值为 7。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">paragraph</span>(min, max);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个中文段落。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 指示文本中句子的最小个数。默认值为 3。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 指示文本中句子的最大个数。默认值为 7。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">cparagraph</span>(min, max);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个句子，第一个单词的首字母大写。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 指示句子中单词的最小个数。默认值为 12。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 指示句子中单词的最大个数。默认值为 18。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">sentence</span>(min, max);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一段中文文本。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 指示句子中单词的最小个数。默认值为 12。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 指示句子中单词的最大个数。默认值为 18。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">csentence</span>(min, max);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个单词。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 指示单词中字符的最小个数。默认值为 3。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 指示单词中字符的最大个数。默认值为 10。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">word</span>(min, max);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个汉字。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; pool 汉字字符串。表示汉字字符池，将从中选择一个汉字字符返回。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 随机汉字字符串的最小长度。默认值为 1。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 随机汉字字符串的最大长度。默认值为 1。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">cword</span>(pool, min, max);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一句标题，其中每个单词的首字母大写。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 指示单词中字符的最小个数。默认值为 3。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 指示单词中字符的最大个数。默认值为 7。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">title</span>(min, max);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一句中文标题。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; min 指示单词中字符的最小个数。默认值为 3。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; max 指示单词中字符的最大个数。默认值为 7。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">ctitle</span>(min, max);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Name</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个常见的英文名。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">first</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个常见的英文姓。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">last</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个常见的英文姓名。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">boolean</span>&#125; middle 布尔值。指示是否生成中间名。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">name</span>(middle);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个常见的中文名。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">cfirst</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个常见的中文姓。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">clast</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个常见的中文姓名。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">cname</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Web</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个 URL。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; protocol 指定 URL 协议。例如 http。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; host 指定 URL 域名和端口号。例如 nuysoft.com。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">url</span>(protocol, host);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个 URL 协议。返回以下值之一：</span></span><br><span class="line"><span class="comment"> * &#x27;http&#x27;、&#x27;ftp&#x27;、&#x27;gopher&#x27;、&#x27;mailto&#x27;、&#x27;mid&#x27;、&#x27;cid&#x27;、&#x27;news&#x27;、&#x27;nntp&#x27;、&#x27;prospero&#x27;、&#x27;telnet&#x27;、&#x27;rlogin&#x27;、&#x27;tn3270&#x27;、&#x27;wais&#x27;。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">protocol</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个域名。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">domain</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个顶级域名（Top Level Domain）。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">tld</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个邮件地址。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; domain 指定域名。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">email</span>(domain);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个 IP 地址。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">ip</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Address</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个（中国）大区。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">region</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个（中国）省（或直辖市、自治区、特别行政区）。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">province</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个（中国）市。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">boolean</span>&#125; prefix 布尔值。指示是否生成所属的省。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">city</span>(prefix);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个（中国）县。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">boolean</span>&#125; prefix 布尔值。指示是否生成所属的省、市。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">county</span>(prefix);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个邮政编码（六位数字）。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">zip</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Miscellaneous</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个 GUID。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">guid</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 随机生成一个 18 位身份证。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">id</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 生成一个全局的自增整数。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; step 指示自增的步长。默认值为 1。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">increment</span>(step);</span><br></pre></td></tr></table></figure></div>

<h2 id="模板使用"><a href="#模板使用" class="headerlink" title="模板使用"></a>模板使用</h2><p>在模板字符串中使用函数，只需要在函数前加上 <code>@</code> 符号即可。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">Mock</span> = <span class="built_in">require</span>(<span class="string">&quot;mockjs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data = <span class="title class_">Mock</span>.<span class="title function_">mock</span>(&#123;</span><br><span class="line">  <span class="string">&quot;array|1-20&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;id|+1&quot;</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">success</span>: <span class="string">&quot;@boolean()&quot;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&quot;@string()&quot;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;@cname()&quot;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="string">&quot;@integer(18, 60)&quot;</span>,</span><br><span class="line">      <span class="attr">addr</span>: <span class="string">&quot;@county(true)&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="http://mockjs.com/examples.html" >Mock.js Example <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://github.com/nuysoft/Mock/wiki/Mock.Random" >Mock.js Doc <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>MD5盐值加密解密过程</title>
    <url>/2023/07/19/MD5%E7%9B%90%E5%80%BC%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E8%BF%87%E7%A8%8B/</url>
    <content><![CDATA[<h1 id="MD5-盐值加密算法？是什么？"><a href="#MD5-盐值加密算法？是什么？" class="headerlink" title="MD5 盐值加密算法？是什么？"></a>MD5 盐值加密算法？是什么？</h1><p>MD5 盐值加密，实际上应该叫 MD5 盐值摘要。<br>用户在前端登录时，一般会将密码使用 MD5 进行信息摘要，然后再将摘要结果传给后端存到数据库，这一步是为了防止密码被中间人抓包然后盗号。<br>但是目前看来，即使密码在传输过程中是摘要状态，也不是完全安全的。<br>因为<strong>不能保证用户会设置一些特别简单的密码</strong>，比如：123，321，12345，123abc，66666，8888 等，<br>这些密码因为过于简单，会<strong>被一些网站连同它们的摘要信息一起收录</strong>，生成对应表。  </p>
<p>比如在<a class="link"   href="https://www.cmd5.org/" >这个网站 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，你<strong>输入摘要信息，是可以解密出简单的原始密码</strong>的，<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025384_db0a32f84d3f70601d064d219f160b39.png"
                     
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025384_e245c178f4ac2e4a172c3a4f45a27b7b.png"
                     
                ><br>一但中间人拿到了你密码的信息摘要，并通过<a class="link"   href="https://www.cmd5.org/" >这个网站 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>解密了你的密码，那么你<strong>依然会被盗号</strong>。<br>所以问题的核心就出来了，<strong>密码过于简单</strong><br>解决方法也出来了，<strong>让密码变得更加复杂</strong></p>
<hr>
<p>有聪明的程序员已经想好了办法，并且取名为<strong>MD5 盐值加密算法</strong>，<br>就像撒盐一样，给密码调调味，其实就是将密码拼接一些字符串使其变得复杂，不容易被<a class="link"   href="https://www.cmd5.org/" >这种网站 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>解密。<br>具体怎么做：<br>在用户注册时，通过 MD5 盐值加密，将盐值和加密后的结果存到数据库。<br>在用户登录时，通过数据库的盐值和密码进行解密并匹配密码是否正确。</p>
<h1 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h1><p>这里模拟用户注册、用户登录情形，MD5方法来自<a class="link"   href="https://www.npmjs.com/package/md5" >https://www.npmjs.com/package/md5 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>MD5盐值加密demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#conta</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#conta</span> &gt; * &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">4px</span>);</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span>&gt;</span>MD5盐值加密&amp;解密过程模拟<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;conta&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;left&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h4</span>&gt;</span>模拟注册<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">id</span>=<span class="string">&quot;username&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名&quot;</span></span></span><br><span class="line"><span class="tag">                    /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入密码&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;register&quot;</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h5</span>&gt;</span>注册结果<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;usernameRes&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>盐值：<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;salt&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>密码最终加密结果：<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;passwordRes&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;right&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h4</span>&gt;</span>模拟登录<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">id</span>=<span class="string">&quot;username2&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名&quot;</span></span></span><br><span class="line"><span class="tag">                    /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">type</span>=<span class="string">&quot;password2&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">id</span>=<span class="string">&quot;password2&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">placeholder</span>=<span class="string">&quot;请输入密码&quot;</span></span></span><br><span class="line"><span class="tag">                    /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;login&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h5</span>&gt;</span>登录结果<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;username2Res&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>MD5加密的密码：<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;password2Res&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>登录结果：<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;loginRes&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./node_modules/md5/dist/md5.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> <span class="title function_">$</span> = (<span class="params">id</span>) =&gt; <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> $usernameInput = $(<span class="string">&#x27;username&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">                $passwordInput = $(<span class="string">&#x27;password&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">                $registerBtn = $(<span class="string">&#x27;register&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">                $usernameRes = $(<span class="string">&#x27;usernameRes&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">                $passwordRes = $(<span class="string">&#x27;passwordRes&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">                $saltRes = $(<span class="string">&#x27;salt&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">                $username2Input = $(<span class="string">&#x27;username2&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">                $password2Input = $(<span class="string">&#x27;password2&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">                $loginBtn = $(<span class="string">&#x27;login&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">                $username2Res = $(<span class="string">&#x27;username2Res&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">                $password2Res = $(<span class="string">&#x27;password2Res&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">                $loginRes = $(<span class="string">&#x27;loginRes&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 模拟数据库用户表</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> db = [];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> <span class="title function_">random</span> = (<span class="params">min = <span class="number">1</span>, max = <span class="number">10</span>, decimal = <span class="number">0</span></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (max - min) + min);</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> <span class="title function_">getSalt</span> = (<span class="params">saltLength = <span class="number">20</span></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> saltSourceStr =</span></span><br><span class="line"><span class="language-javascript">                    <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> salt = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; saltLength; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">                    salt +=</span></span><br><span class="line"><span class="language-javascript">                        saltSourceStr[(<span class="number">0</span>, <span class="title function_">random</span>(saltSourceStr.<span class="property">length</span> - <span class="number">1</span>))];</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> salt;</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 核心代码，MD5盐值加密</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> <span class="title function_">MD5SaltCrypto</span> = (<span class="params">inputPwd</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> salt = <span class="title function_">getSalt</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 第一次md5加密，加密原始密码，</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// MD5方法来自https://www.npmjs.com/package/md5</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> pwdMd5 = <span class="title class_">MD5</span>(inputPwd);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 第二次md5加密，需要把盐值和第一次md5加密后的结果拼接，然后将拼接结果再次md5加密</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> pwdSaltMd5 = <span class="title class_">MD5</span>(salt + pwdMd5);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    pwdSaltMd5,</span></span><br><span class="line"><span class="language-javascript">                    salt</span></span><br><span class="line"><span class="language-javascript">                &#125;;</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            $registerBtn.<span class="property">onclick</span> = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> username = $usernameInput.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> &#123; pwdSaltMd5, salt &#125; = <span class="title class_">MD5SaltCrypto</span>($passwordInput.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript">                $usernameRes.<span class="property">innerText</span> = username;</span></span><br><span class="line"><span class="language-javascript">                $passwordRes.<span class="property">innerText</span> = pwdSaltMd5;</span></span><br><span class="line"><span class="language-javascript">                $saltRes.<span class="property">innerText</span> = salt;</span></span><br><span class="line"><span class="language-javascript">                db.<span class="title function_">push</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                    username,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">password</span>: pwdSaltMd5,</span></span><br><span class="line"><span class="language-javascript">                    salt</span></span><br><span class="line"><span class="language-javascript">                &#125;);</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            $loginBtn.<span class="property">onclick</span> = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> username = $username2Input.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> password = <span class="title class_">MD5</span>($password2Input.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> find = db.<span class="title function_">find</span>(<span class="function">(<span class="params">user</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (</span></span><br><span class="line"><span class="language-javascript">                        user.<span class="property">username</span> === username &amp;&amp;</span></span><br><span class="line"><span class="language-javascript">                        user.<span class="property">password</span> === <span class="title class_">MD5</span>(user.<span class="property">salt</span> + password)</span></span><br><span class="line"><span class="language-javascript">                    )</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (find) $loginRes.<span class="property">innerText</span> = <span class="string">&#x27;登录成功！&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">else</span> $loginRes.<span class="property">innerText</span> = <span class="string">&#x27;登录失败！&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>MD5</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu下FTP自动化部署</title>
    <url>/2023/12/06/Ubuntu%E4%B8%8BFTP%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/</url>
    <content><![CDATA[<h1 id="已知问题"><a href="#已知问题" class="headerlink" title="已知问题"></a>已知问题</h1><p>在 Ubuntu 系统中可以使用，但是在 WSL 中会卡住，原因未知。</p>
<h1 id="手动部署"><a href="#手动部署" class="headerlink" title="手动部署"></a>手动部署</h1><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. 连接到FTP服务器</span></span><br><span class="line">ftp <span class="string">&quot;192.168.1.1&quot;</span></span><br><span class="line"><span class="comment"># 2. 根据提示输入用户名和密码登录成功</span></span><br><span class="line"><span class="comment"># 3. 切换到二进制模式上传文件</span></span><br><span class="line">binary</span><br><span class="line">put <span class="string">&quot;local/test.txt&quot;</span> <span class="string">&quot;remote/test.txt&quot;</span></span><br><span class="line"><span class="comment"># 退出</span></span><br><span class="line">quit</span><br></pre></td></tr></table></figure></div>

<h1 id="自动部署"><a href="#自动部署" class="headerlink" title="自动部署"></a>自动部署</h1><h2 id="创建-shell-脚本"><a href="#创建-shell-脚本" class="headerlink" title="创建 shell 脚本"></a>创建 shell 脚本</h2><p><em>autoDeploy.sh</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#/bin/bash</span></span><br><span class="line">HOST=<span class="string">&quot;192.168.1.1&quot;</span></span><br><span class="line">USER=<span class="string">&quot;username&quot;</span></span><br><span class="line">PWD=<span class="string">&quot;password&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -n 不自动登录到 FTP 服务器</span></span><br><span class="line"><span class="comment"># -i 关闭交互式模式</span></span><br><span class="line"><span class="comment"># 这里的EOF是Here document语法，表示将&lt;&lt;EOF之后以及EOF之前的所有的内容作为输入传给ftp命令</span></span><br><span class="line">ftp -n -i <span class="variable">$HOST</span> &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">user $USER $PWD</span></span><br><span class="line"><span class="string">binary</span></span><br><span class="line"><span class="string">put &quot;local/test.txt&quot; &quot;remote/test.txt&quot;</span></span><br><span class="line"><span class="string">exit</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure></div>

<h2 id="调用自动部署脚本"><a href="#调用自动部署脚本" class="headerlink" title="调用自动部署脚本"></a>调用自动部署脚本</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">./autoDeploy.sh</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>FTP</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu命令记录</title>
    <url>/2023/04/22/Ubuntu%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p>持续补充中…</p>
<h1 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h1><p>连接远程服务器</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">ssh USER@ip</span><br></pre></td></tr></table></figure></div>

<span id="more"></span>

<h1 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h1><h2 id="查看版本"><a href="#查看版本" class="headerlink" title="查看版本"></a>查看版本</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看Ubuntu版本</span></span><br><span class="line">lsb_release -a</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">查看Linux内核版本</span><br><span class="line"><span class="built_in">cat</span> /proc/version</span><br></pre></td></tr></table></figure></div>

<h2 id="电源"><a href="#电源" class="headerlink" title="电源"></a>电源</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 立刻关机</span></span><br><span class="line">sudo shutdown -h now</span><br><span class="line"><span class="comment"># 立刻关机</span></span><br><span class="line">sudo poweroff</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 立即重启</span></span><br><span class="line">sudo shutdown -r now</span><br><span class="line"><span class="comment"># 立即重启</span></span><br><span class="line">sudo reboot</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo rtcwake -m standby -s 1800 <span class="comment"># S1 关闭显示器/关闭CPU，并且在1800秒之后恢复</span></span><br><span class="line">sudo rtcwake -m mem -s 1800 <span class="comment"># S3 挂起到内存，关闭其他硬件供电，并且在1800秒之后恢复</span></span><br><span class="line">sudo rtcwake -m disk -s 1800 <span class="comment"># S4 挂起到硬盘，关闭其他电源，并且在1800秒之后恢复（部分旧硬件可能不支持）</span></span><br><span class="line">sudo rtcwake -m off -s 1800 <span class="comment"># S5 关闭所有电源，并且在1800秒之后恢复</span></span><br></pre></td></tr></table></figure></div>

<h2 id="日期时间"><a href="#日期时间" class="headerlink" title="日期时间"></a>日期时间</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看当前时间</span></span><br><span class="line"><span class="built_in">date</span> -R</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 调整时区为中国上海</span></span><br><span class="line">timedatectl set-timezone Asia/Shanghai</span><br><span class="line"><span class="comment"># 将当前时间写入BIOS避免重启失效</span></span><br><span class="line">sudo hwclock --systohc</span><br></pre></td></tr></table></figure></div>

<h2 id="apt"><a href="#apt" class="headerlink" title="apt"></a>apt</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 更新可用软件包列表</span></span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新已安装的包</span></span><br><span class="line">sudo apt-get upgrade</span><br><span class="line"></span><br><span class="line"><span class="comment"># apt 命令</span></span><br><span class="line"><span class="comment"># apt命令是一个整合了apt-get、apt-cache……的工具，为了方便，可以直接使用apt命令</span></span><br><span class="line">sudo apt install PACKAGE</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看已安装软件</span></span><br><span class="line">sudo dpkg --list | grep -i PACKAGE</span><br></pre></td></tr></table></figure></div>

<h2 id="切换命令版本"><a href="#切换命令版本" class="headerlink" title="切换命令版本"></a>切换命令版本</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 例如安装了多个版本的java，需要切换其中一种来使用</span></span><br><span class="line">sudo update-alternatives --install /usr/bin/java java /path/to/java21/bin/java 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换后，查看当前java命令的版本列表</span></span><br><span class="line">sudo update-alternatives --config java</span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后跟着指示就可以切换成功了，查看切换后的java版本</span></span><br><span class="line">java -version</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 卸载软件</span></span><br><span class="line">sudo apt-get remove PACKAGE</span><br><span class="line"><span class="comment"># 完全删除软件</span></span><br><span class="line">sudo apt-get purge PACKAGE</span><br><span class="line"><span class="comment"># 自动清理不需要的依赖</span></span><br><span class="line">sudo apt-get autoremove</span><br></pre></td></tr></table></figure></div>

<h2 id="查看硬件设备"><a href="#查看硬件设备" class="headerlink" title="查看硬件设备"></a>查看硬件设备</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看pcie设备</span></span><br><span class="line">lspci</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看usb设备</span></span><br><span class="line">lsusb</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install lm-sensors</span><br><span class="line"><span class="comment"># 查看CPU、GPU温度</span></span><br><span class="line">sensors</span><br><span class="line"><span class="comment"># 查看实时温度</span></span><br><span class="line">watch sensors</span><br></pre></td></tr></table></figure></div>

<h2 id="搜索和过滤"><a href="#搜索和过滤" class="headerlink" title="搜索和过滤"></a>搜索和过滤</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 过滤命令返回的结果，-i表示不区分大小写</span></span><br><span class="line">COMMAND | grep -i KEYWORD</span><br><span class="line"><span class="comment"># findstr是windows的命令，功能和grep差不多</span></span><br></pre></td></tr></table></figure></div>

<h2 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看指定端口有没有开启</span></span><br><span class="line"><span class="comment"># 切换到root用户才可以看到所有信息，否则只能看到当前用户的信息</span></span><br><span class="line">sudo -i</span><br><span class="line">netstat -ap | grep PORT</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 根据端口号搜索进程</span></span><br><span class="line"><span class="comment"># 切换到root用户才可以看到所有信息，否则只能看到当前用户的信息</span></span><br><span class="line">netstat -tulnp | grep PORT</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看主板网卡速率</span></span><br><span class="line"><span class="comment"># 安装工具</span></span><br><span class="line">sudo apt install ethtool</span><br><span class="line"><span class="comment"># 查看当前网卡列表</span></span><br><span class="line">ip <span class="built_in">link</span> show | grep <span class="string">&quot;state UP&quot;</span>  <span class="comment"># 示例输出：enp0s3、eth0</span></span><br><span class="line"><span class="comment"># 查看网卡速率</span></span><br><span class="line">sudo ethtool 网卡名称 | grep -E <span class="string">&quot;Speed|Supported link modes&quot;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 测两个ip之间的网络速率</span></span><br><span class="line"><span class="comment"># 安装工具，官网：https://iperf.fr/</span></span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install -y iperf3</span><br><span class="line"><span class="comment"># 启动服务</span></span><br><span class="line">iperf3 -s</span><br><span class="line"><span class="comment"># 启动测试，测60秒，分4个线程</span></span><br><span class="line">iperf3 -c &lt;目标IP&gt; -t 60 -P 4</span><br></pre></td></tr></table></figure></div>

<h2 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 杀死进程</span></span><br><span class="line"><span class="built_in">kill</span> PID</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line"><span class="comment"># -9 强制杀死进程</span></span><br><span class="line"><span class="built_in">kill</span> -9 PID</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 根据PID查找进程名称和服务</span></span><br><span class="line">ps -ef | grep PID</span><br></pre></td></tr></table></figure></div>

<h2 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 添加用户</span></span><br><span class="line">sudo useradd USER</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 删除用户</span></span><br><span class="line">sudo deluser --remove-home USER</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 切换普通用户</span></span><br><span class="line">sudu su - USER</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 切换根用户</span></span><br><span class="line">sudu -i</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看用户列表</span></span><br><span class="line"><span class="built_in">cat</span> /etc/passwd</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看用户组列表</span></span><br><span class="line"><span class="built_in">cat</span> /etc/group</span><br></pre></td></tr></table></figure></div>

<h2 id="磁盘-x2F-分区"><a href="#磁盘-x2F-分区" class="headerlink" title="磁盘&#x2F;分区"></a>磁盘&#x2F;分区</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 检查磁盘分区状态</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 下面是该命令输出的数据，表示：</span></span><br><span class="line"><span class="comment"># 磁盘总大小为931.5GB，但是只有一个分区（/dev/sda3），其大小为928.5GB，并且该分区只挂载了一个逻辑卷（/dev/mapper/ubuntu--vg-ubuntu--lv），大小为100GB。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># user@user:~$ lsblk</span></span><br><span class="line"><span class="comment"># NAME                      MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS</span></span><br><span class="line"><span class="comment"># loop0                       7:0    0  63.9M  1 loop /snap/core20/2105</span></span><br><span class="line"><span class="comment"># loop1                       7:1    0  63.9M  1 loop /snap/core20/2182</span></span><br><span class="line"><span class="comment"># loop2                       7:2    0    87M  1 loop /snap/lxd/27428</span></span><br><span class="line"><span class="comment"># loop3                       7:3    0    87M  1 loop /snap/lxd/27948</span></span><br><span class="line"><span class="comment"># loop4                       7:4    0  40.4M  1 loop /snap/snapd/20671</span></span><br><span class="line"><span class="comment"># loop5                       7:5    0  39.1M  1 loop /snap/snapd/21184</span></span><br><span class="line"><span class="comment"># sda                         8:0    0 931.5G  0 disk</span></span><br><span class="line"><span class="comment"># ├─sda1                      8:1    0     1G  0 part /boot/efi</span></span><br><span class="line"><span class="comment"># ├─sda2                      8:2    0     2G  0 part /boot</span></span><br><span class="line"><span class="comment"># └─sda3                      8:3    0 928.5G  0 part</span></span><br><span class="line"><span class="comment">#   └─ubuntu--vg-ubuntu--lv 253:0    0   100G  0 lvm  /</span></span><br><span class="line">lsblk</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 扩展逻辑卷的大小</span></span><br><span class="line"><span class="comment"># 假设您要将逻辑卷扩展到使用所有可用空间，您可以执行以下命令</span></span><br><span class="line">sudo lvextend -l +100%FREE /dev/mapper/ubuntu--vg-ubuntu--lv</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 扩展文件系统</span></span><br><span class="line"><span class="comment"># 一旦逻辑卷扩展完成，就需要扩展文件系统</span></span><br><span class="line">sudo resize2fs /dev/mapper/ubuntu--vg-ubuntu--lv</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看主板sata协议</span></span><br><span class="line"><span class="comment"># 安装工具</span></span><br><span class="line">sudo apt install smartmontools</span><br><span class="line"><span class="comment"># 查看协议</span></span><br><span class="line">sudo smartctl -a /dev/sda | grep <span class="string">&quot;SATA Version&quot;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看主板信息</span></span><br><span class="line"><span class="comment"># 安装工具</span></span><br><span class="line">sudo apt install dmidecode</span><br><span class="line"><span class="comment"># 查看主板信息</span></span><br><span class="line">sudo dmidecode -t baseboard</span><br></pre></td></tr></table></figure></div>

<h2 id="文件系统权限"><a href="#文件系统权限" class="headerlink" title="文件系统权限"></a>文件系统权限</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 修改目录所属用户</span></span><br><span class="line">sudo <span class="built_in">chown</span> -R USER[:GROUP] FOLDER</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 修改目录权限</span></span><br><span class="line">sudo <span class="built_in">chmod</span> -R 777 FOLDER</span><br></pre></td></tr></table></figure></div>

<h2 id="文件及目录操作（增删改查）"><a href="#文件及目录操作（增删改查）" class="headerlink" title="文件及目录操作（增删改查）"></a>文件及目录操作（增删改查）</h2><h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建目录</span></span><br><span class="line"><span class="built_in">mkdir</span> FOLDER</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 删除空目录</span></span><br><span class="line"><span class="built_in">rmdir</span> FOLDER</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 删除非空目录</span></span><br><span class="line"><span class="comment"># -r 递归删除</span></span><br><span class="line"><span class="comment"># -f 强制删除，不提示确认</span></span><br><span class="line"><span class="built_in">rm</span> -rf FOLDER</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 复制目录</span></span><br><span class="line"><span class="comment"># -r 递归复制</span></span><br><span class="line"><span class="built_in">cp</span> -r SOURCE DEST</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 移动或重命名目录</span></span><br><span class="line"><span class="built_in">mv</span> SOURCE DEST</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 切换目录</span></span><br><span class="line"><span class="built_in">cd</span> FOLDER</span><br><span class="line"><span class="comment"># 返回上一层目录</span></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"><span class="comment"># 进入根目录</span></span><br><span class="line"><span class="built_in">cd</span> /</span><br><span class="line"><span class="comment"># 进入当前用户目录</span></span><br><span class="line"><span class="built_in">cd</span> ~</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看当前目录下文件</span></span><br><span class="line"><span class="comment"># -l 显示详细信息</span></span><br><span class="line"><span class="comment"># -a 显示隐藏文件</span></span><br><span class="line"><span class="built_in">ls</span> -la</span><br><span class="line"><span class="comment"># 查看指定目录下的文件</span></span><br><span class="line"><span class="built_in">ls</span> -la FOLDER</span><br></pre></td></tr></table></figure></div>

<h3 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># touch创建文件</span></span><br><span class="line"><span class="built_in">touch</span> FILE</span><br><span class="line"><span class="comment"># cat创建文件并写入内容</span></span><br><span class="line"><span class="built_in">cat</span> &gt; FILE &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">CONTENT</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 删除文件</span></span><br><span class="line"><span class="built_in">rm</span> File</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 复制文件</span></span><br><span class="line"><span class="built_in">cp</span> SOURCE DEST</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 移动或重命名文件</span></span><br><span class="line"><span class="built_in">mv</span> SOURCE DEST</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看文件内容</span></span><br><span class="line"><span class="comment"># -n 显示行号</span></span><br><span class="line"><span class="built_in">cat</span> -n FILE</span><br><span class="line"><span class="comment"># 逐页显示文件内容</span></span><br><span class="line">less FILE</span><br><span class="line"><span class="comment"># 显示文件的前几行</span></span><br><span class="line"><span class="built_in">head</span> -n 10 FILE</span><br><span class="line"><span class="comment"># 显示文件的后几行</span></span><br><span class="line"><span class="built_in">tail</span> -n 10 FILE</span><br></pre></td></tr></table></figure></div>

<p><a class="link"   href="https://blog.csdn.net/qq_40647372/article/details/132689198" >cat 命令参考 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h2 id="服务-x2F-守护进程"><a href="#服务-x2F-守护进程" class="headerlink" title="服务&#x2F;守护进程"></a>服务&#x2F;守护进程</h2><h3 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h3><p>需要在&#x2F;etc&#x2F;systemd&#x2F;system 目录下新建 DAEMON.service 文件来配置服务<br>内容基本如下</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Minecraft Server</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User=root</span><br><span class="line">WorkingDirectory=/opt/minecraft_forge/server</span><br><span class="line">ExecStart=/usr/bin/bash run.sh</span><br><span class="line">ExecStop=/opt/minecraft/tools/mcrcon/mcrcon -H 127.0.0.1 -P 25575 -p PASSWORD stop</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></div>

<p>这里重点说一下因为 <em>权限问题</em> 导致启动服务不成功的解决办法，<br>关键是 DAEMON.service 文件里面配置的 <em>User</em>字段 是否有足够的权限，<br>视情况可以改为 <em>root</em> 用户</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 重载服务配置</span></span><br><span class="line">sudo systemctl daemon-reload</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 启动指定服务</span></span><br><span class="line">sudo systemctl start DAEMON</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 重启服务</span></span><br><span class="line">sudo systemctl restart DAEMON</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 关闭指定服务</span></span><br><span class="line">sudo systemctl stop DAEMON</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看指定服务状态</span></span><br><span class="line">sudo systemctl status DAEMON</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 服务自启动</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> DAEMON</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 搜索服务</span></span><br><span class="line">sudo systemctl list-unit-files | grep KEYWORD</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">sudo systemctl list-units --<span class="built_in">type</span>=service --all | grep KEYWORD</span><br></pre></td></tr></table></figure></div>

<h1 id="分屏"><a href="#分屏" class="headerlink" title="分屏"></a>分屏</h1><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建新分屏</span></span><br><span class="line">screen -S SCREENNAME</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看当前用户下的所有分屏</span></span><br><span class="line">screen -<span class="built_in">ls</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 退出当前分屏，停止运行</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 进入指定分屏</span></span><br><span class="line">screen -r PROCESSID</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>退出当前分屏，继续运行<br>ctrl + a 同时 ctrl + d</p>
</blockquote>
<h1 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h1><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 需要当前目录下有Makefile文件</span></span><br><span class="line">make</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装编译后的软件</span></span><br><span class="line">make install</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 卸载编译后的软件，需要软件提供卸载功能</span></span><br><span class="line">make uninstall</span><br></pre></td></tr></table></figure></div>

<h1 id="常用命令行软件"><a href="#常用命令行软件" class="headerlink" title="常用命令行软件"></a>常用命令行软件</h1><h2 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h2><blockquote>
<p>搜索关键字<br>&#x2F;keyword</p>
</blockquote>
<blockquote>
<p>模糊搜索关键字,搜索到了之后按”n”键查看下一个匹配项，按”N”查看上一个匹配项<br>?keyword</p>
</blockquote>
<blockquote>
<p>不保存退出<br>:q!</p>
</blockquote>
<blockquote>
<p>查看文件编码<br>:set ff</p>
</blockquote>
<blockquote>
<p>修改文件编码<br>:set ff&#x3D;unix<br>:set ff&#x3D;dos<br>将文件编码修改为 unix 可以解决 linux 下 sh 文件不能执行的问题</p>
</blockquote>
<h2 id="nano"><a href="#nano" class="headerlink" title="nano"></a>nano</h2><blockquote>
<p>保存文件<br>ctrl + o</p>
</blockquote>
<blockquote>
<p>保存退出文件<br>ctrl + x</p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>命令行</tag>
        <tag>操作系统</tag>
        <tag>Linux</tag>
        <tag>文件系统</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu安装我的世界服务器端</title>
    <url>/2023/04/22/Ubuntu%E5%AE%89%E8%A3%85%E6%88%91%E7%9A%84%E4%B8%96%E7%95%8C%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<h1 id="1-安装-java"><a href="#1-安装-java" class="headerlink" title="1 安装 java"></a>1 安装 java</h1><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt upgrade</span><br><span class="line">sudo apt install default-jdk</span><br></pre></td></tr></table></figure></div>

<span id="more"></span>

<h1 id="2-创建-minecraft-用户"><a href="#2-创建-minecraft-用户" class="headerlink" title="2 创建 minecraft 用户"></a>2 创建 minecraft 用户</h1><p><strong>因为安全原因， Minecraft 不应该在 root 用户下运行。我们将会创建一个新的系统用户和用户组，用户主目录&#x2F;opt&#x2F;minecraft。这个用户有最小权限，来运行 Minecraft 服务器端</strong></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo useradd -r -m -U -d /opt/minecraft -s /bin/bash minecraft</span><br><span class="line">sudo su - minecraft</span><br><span class="line"><span class="built_in">mkdir</span> -p ~/&#123;backups,tools,server&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="3-Minecraft-服务端"><a href="#3-Minecraft-服务端" class="headerlink" title="3 Minecraft 服务端"></a>3 Minecraft 服务端</h1><h2 id="3-1-下载服务端"><a href="#3-1-下载服务端" class="headerlink" title="3.1 下载服务端"></a>3.1 下载服务端</h2><p><strong>wget 下载的是 1.16 版本，如果需要最新版，可以去<a class="link"   href="https://www.minecraft.net/en-us/download/server" >官网下载最新版本 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，然后通过 FTP 传到&#x2F;opt&#x2F;minecraft&#x2F;server 目录下</strong><br>java11 可以兼容 Minecraft1.16</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://launcher.mojang.com/v1/objects/a0d03225615ba897619220e256a266cb33a44b6b/server.jar -P ~/server</span><br></pre></td></tr></table></figure></div>

<h2 id="3-2-配置服务端"><a href="#3-2-配置服务端" class="headerlink" title="3.2 配置服务端"></a>3.2 配置服务端</h2><p>第一次启动服务端会创建 server.properties 和 eula.txt 文件，然后停止运行</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/server</span><br><span class="line">java -Xmx1024M -Xms1024M -jar server.jar nogui</span><br></pre></td></tr></table></figure></div>

<p>修改 eula.txt<br><em>eula&#x3D;true</em> ，<br>类似于需要同意一份协议才能正常运行服务端</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/server</span><br><span class="line">vim eula.txt</span><br></pre></td></tr></table></figure></div>

<p>配置好 eula 后，进入 server.properties 配置服务器端信息</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/server</span><br><span class="line">vim server.properties</span><br></pre></td></tr></table></figure></div>

<p><strong>修改 server.properties</strong><br><strong><em>online-mode&#x3D;false</em></strong><br><strong>这直接关系到开服后能否进入游戏，否则会出现无效会话的问题</strong></p>
<h2 id="3-3-配置防火墙"><a href="#3-3-配置防火墙" class="headerlink" title="3.3. 配置防火墙"></a>3.3. 配置防火墙</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ufw allow 25565/tcp</span><br></pre></td></tr></table></figure></div>

<h1 id="4-其他"><a href="#4-其他" class="headerlink" title="4 其他"></a>4 其他</h1><h2 id="4-1-将服务端添加到系统服务并自启动"><a href="#4-1-将服务端添加到系统服务并自启动" class="headerlink" title="4.1 将服务端添加到系统服务并自启动"></a>4.1 将服务端添加到系统服务并自启动</h2><p>创建&#x2F;etc&#x2F;systemd&#x2F;system&#x2F;minecraft.service 文件</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">touch</span> /etc/systemd/system/minecraft.service</span><br></pre></td></tr></table></figure></div>

<p>修改文件内容为</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Minecraft Server</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User=minecraft</span><br><span class="line">Nice=1</span><br><span class="line">KillMode=none</span><br><span class="line">SuccessExitStatus=0 1</span><br><span class="line">ProtectHome=true</span><br><span class="line">ProtectSystem=full</span><br><span class="line">PrivateDevices=true</span><br><span class="line">NoNewPrivileges=true</span><br><span class="line">WorkingDirectory=/opt/minecraft/server</span><br><span class="line">ExecStart=/usr/bin/java -Xmx1024M -Xms1024M -jar server.jar nogui</span><br><span class="line">ExecStop=/opt/minecraft/tools/mcrcon/mcrcon -H 127.0.0.1 -P 25575 -p PASSWORD stop</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></div>

<p>绑定系统服务并自启动</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl start minecraft</span><br><span class="line">sudo systemctl status minecraft</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> minecraft</span><br></pre></td></tr></table></figure></div>

<h2 id="4-2-mcrcon"><a href="#4-2-mcrcon" class="headerlink" title="4.2. mcrcon"></a>4.2. mcrcon</h2><p>mcrcon 是一个 rcon 客户端，用来控制 minecraft 服务端</p>
<p>下载并编译</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/Tiiffi/mcrcon.git ~/tools/mcrcon</span><br><span class="line"><span class="built_in">cd</span> ~/tools/mcrcon</span><br><span class="line">make</span><br><span class="line">./mcrcon -v</span><br></pre></td></tr></table></figure></div>

<p>修改 server.properties<br>enable-rcon&#x3D;true<br>rcon.port&#x3D;25575<br>rcon.password&#x3D;PASSWORD</p>
<p>通过 mcrcon 访问服务端</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">/opt/minecraft/tools/mcrcon/mcrcon -H 127.0.0.1 -P 25575 -p PASSWORD -t</span><br></pre></td></tr></table></figure></div>

<h2 id="4-3-定时备份"><a href="#4-3-定时备份" class="headerlink" title="4.3. 定时备份"></a>4.3. 定时备份</h2><p>创建自动备份程序文件 &#x2F;opt&#x2F;minecraft&#x2F;tools&#x2F;backup.sh ，并给其可执行权限</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">touch</span> /opt/minecraft/tools/backup.sh</span><br><span class="line">sudo <span class="built_in">chmod</span> 770 /opt/minecraft/tools/backup.sh</span><br></pre></td></tr></table></figure></div>

<p>内容为</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> rcon &#123;</span><br><span class="line">  /opt/minecraft/tools/mcrcon/mcrcon -H 127.0.0.1 -P 25575 -p strong-password <span class="string">&quot;<span class="variable">$1</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rcon <span class="string">&quot;save-off&quot;</span></span><br><span class="line">rcon <span class="string">&quot;save-all&quot;</span></span><br><span class="line">tar -cvpzf /opt/minecraft/backups/server-$(<span class="built_in">date</span> +%F-%H-%M).tar.gz /opt/minecraft/server</span><br><span class="line">rcon <span class="string">&quot;save-on&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Delete older backups</span></span><br><span class="line">find /opt/minecraft/backups/ -<span class="built_in">type</span> f -mtime +7 -name <span class="string">&#x27;*.gz&#x27;</span> -delete</span><br></pre></td></tr></table></figure></div>

<p>给当前用户添加定时任务</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure></div>

<p>在定时任务文件中添加以下内容，每天 23 点定时运行</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">0 23 * * * /opt/minecraft/tools/backup.sh</span><br></pre></td></tr></table></figure></div>

<h2 id="4-4-server-properties-配置参考"><a href="#4-4-server-properties-配置参考" class="headerlink" title="4.4. server.properties 配置参考"></a>4.4. server.properties 配置参考</h2><p><a class="link"   href="https://minecraft.fandom.com/zh/wiki/Server.properties?variant=zh" >我的世界百科 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">spawn-protection=16</span><br><span class="line"></span><br><span class="line"><span class="comment">#出生点保护半径(若没有op则不生效)</span></span><br><span class="line"></span><br><span class="line">max-tick-time=60000</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置每个tick花费的最大毫秒数</span></span><br><span class="line"></span><br><span class="line">query.port=25565</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置监听服务器的端口号</span></span><br><span class="line"></span><br><span class="line">generator-settings=</span><br><span class="line"></span><br><span class="line"><span class="comment">#用于自定义超平坦世界的生成</span></span><br><span class="line"></span><br><span class="line">force-gamemode=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#玩家加入服务器时强制变成默认游戏模式</span></span><br><span class="line"></span><br><span class="line">allow-nether=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#是否开启地狱世界(关闭后删除将不会生成地狱世界)</span></span><br><span class="line"></span><br><span class="line">enforce-whitelist=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#在服务器上强制执行白名单。</span></span><br><span class="line"></span><br><span class="line">gamemode=survival</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置玩家的游戏模式</span></span><br><span class="line"></span><br><span class="line">broadcast-console-to-ops=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#*给op发送控制台信息?</span></span><br><span class="line"></span><br><span class="line">enable-query=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#是否开启GameSpy4协议服务器监听器，用于获取服务器信息，建议不要修改</span></span><br><span class="line"></span><br><span class="line">player-idle-timeout=0</span><br><span class="line"></span><br><span class="line"><span class="comment">#当进入AFK模式,在规定时间内T出服务器,设置成0为不T出服务器</span></span><br><span class="line"></span><br><span class="line">difficulty=easy</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置游戏的难度（peaceful(0)=和平，easy(1)=简单，normal(2)=普通，hard(3)=困难）</span></span><br><span class="line"></span><br><span class="line">broadcast-rcon-to-ops=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#*允许远程连接控制台给op发送信息?</span></span><br><span class="line"></span><br><span class="line">spawn-monsters=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#是否生成怪物</span></span><br><span class="line"></span><br><span class="line">op-permission-level=4</span><br><span class="line"></span><br><span class="line"><span class="comment">#设定OP的权限等级</span></span><br><span class="line"></span><br><span class="line">pvp=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#是否可以打架</span></span><br><span class="line"></span><br><span class="line">snooper-enabled=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#启用后，服务端将会定期发送统计数据到http://snoop.minecraft.net</span></span><br><span class="line"></span><br><span class="line">level-type=default</span><br><span class="line"></span><br><span class="line"><span class="comment">#确定地图所生成的类型 </span></span><br><span class="line"></span><br><span class="line">hardcore=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#极限模式（一旦启用，玩家死后会被服务器封禁）</span></span><br><span class="line"></span><br><span class="line">enable-command-block=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#是否启用命令方块</span></span><br><span class="line"></span><br><span class="line">max-players=20</span><br><span class="line"></span><br><span class="line"><span class="comment">#最大玩家数</span></span><br><span class="line"></span><br><span class="line">max-world-size=29999984</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置世界边界的最大半径值，以方块作为单位</span></span><br><span class="line"></span><br><span class="line">resource-pack-sha1=</span><br><span class="line"></span><br><span class="line"><span class="comment">#资源包的SHA-1值，必须为小写十六进制</span></span><br><span class="line"></span><br><span class="line">function-permission-level=2</span><br><span class="line"></span><br><span class="line"><span class="comment">#用于控制函数拥有的权限等级。</span></span><br><span class="line"></span><br><span class="line">rcon.port=25575</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置远程端口号</span></span><br><span class="line"></span><br><span class="line">server-port=25565</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置服务器本地端口号</span></span><br><span class="line"></span><br><span class="line">server-ip=</span><br><span class="line"></span><br><span class="line"><span class="comment">#将服务器与一个特定IP绑定。建议留空</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#留空，或是填入你想让服务器绑定的域名。</span></span><br><span class="line"></span><br><span class="line">spawn-npcs=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#是否生成村民</span></span><br><span class="line"></span><br><span class="line">allow-flight=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#允许或不允许玩家在生存模式下飞行</span></span><br><span class="line"></span><br><span class="line">level-name=world</span><br><span class="line"></span><br><span class="line"><span class="comment">#主世界的名称</span></span><br><span class="line"></span><br><span class="line">view-distance=10</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置服务端传送给客户端的区块量</span></span><br><span class="line"></span><br><span class="line">resource-pack=</span><br><span class="line"></span><br><span class="line"><span class="comment">#可输入指向一个资源包的URI</span></span><br><span class="line"></span><br><span class="line">spawn-animals=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#生成或不生成动物</span></span><br><span class="line"></span><br><span class="line">white-list=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#白名单</span></span><br><span class="line"></span><br><span class="line">rcon.password=</span><br><span class="line"></span><br><span class="line"><span class="comment">#远程访问密码</span></span><br><span class="line"></span><br><span class="line">generate-structures=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义是否在生成世界时生成结构</span></span><br><span class="line"></span><br><span class="line">online-mode=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#正版验证是否开启（将true改为false后离线 外置 正版都可以进入）</span></span><br><span class="line"></span><br><span class="line">max-build-height=256</span><br><span class="line"></span><br><span class="line"><span class="comment">#玩家在游戏中能够建造的最大高度</span></span><br><span class="line"></span><br><span class="line">level-seed=</span><br><span class="line"></span><br><span class="line"><span class="comment">#世界种子</span></span><br><span class="line"></span><br><span class="line">motd=A Minecraft Server</span><br><span class="line"></span><br><span class="line"><span class="comment">#玩家客户端的多人游戏服务器列表中显示的服务器信息，显示于名称下方</span></span><br></pre></td></tr></table></figure></div>

<h1 id="5-我的世界-Mod-版本"><a href="#5-我的世界-Mod-版本" class="headerlink" title="5 我的世界 Mod 版本"></a>5 我的世界 Mod 版本</h1><h2 id="5-1-服务器下载"><a href="#5-1-服务器下载" class="headerlink" title="5.1 服务器下载"></a>5.1 服务器下载</h2><p>mod 版本服务器一般有这以下这几种 mod 加载器：</p>
<h3 id="5-1-1-fabric-服务器下载（推荐）"><a href="#5-1-1-fabric-服务器下载（推荐）" class="headerlink" title="5.1.1 fabric 服务器下载（推荐）"></a>5.1.1 <a class="link"   href="https://fabricmc.net/use/server/" >fabric 服务器下载 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>（推荐）</h3><p>这个 mod 加载器兼容性最好</p>
<h3 id="5-1-2-neoforge-服务器下载"><a href="#5-1-2-neoforge-服务器下载" class="headerlink" title="5.1.2 neoforge 服务器下载"></a>5.1.2 <a class="link"   href="https://projects.neoforged.net/neoforged/neoforge" >neoforge 服务器下载 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h3><p>neoforge 是 forge 的分支，比较 forge 兼容性更好</p>
<h3 id="5-1-3-forge-服务器下载（不推荐）"><a href="#5-1-3-forge-服务器下载（不推荐）" class="headerlink" title="5.1.3 forge 服务器下载（不推荐）"></a>5.1.3 <a class="link"   href="https://files.minecraftforge.net/net/minecraftforge/forge/" >forge 服务器下载 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>（不推荐）</h3><p>这里下载的是 forge 版本的 Minecraft</p>
<p><strong><em>注意，这个网站需要翻墙访问，因为广告是外网的，看不了广告就下载不了</em></strong><br><strong><em>如果不能翻墙，我这里提供两个解决办法</em></strong></p>
<ul>
<li>手动修改网页跳过广告，直接下载<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025372_44f876c05fddb3b85c8954f005187282.webp"
                      alt="图片"
                ></li>
<li>我帮你修改网页，拿到真实下载链接<br> <a class="link"   href="https://maven.minecraftforge.net/net/minecraftforge/forge/1.19.3-44.1.23/forge-1.19.3-44.1.23-installer.jar" >minecraft1.19.3-forge44.1.23 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
</ul>
<h2 id="5-2-服务器安装"><a href="#5-2-服务器安装" class="headerlink" title="5.2 服务器安装"></a>5.2 服务器安装</h2><h3 id="5-2-1-forge-和-neoforge-服务器安装"><a href="#5-2-1-forge-和-neoforge-服务器安装" class="headerlink" title="5.2.1 forge 和 neoforge 服务器安装"></a>5.2.1 forge 和 neoforge 服务器安装</h3><p>需要先在 windows 上执行下载的 jar 文件，执行后会出现 GUI 界面，选择安装 server 版本，并且选择一个新的文件夹当作服务器目录，<br>安装完成后，服务器目录会出现一些文件，把这些文件复制到 Ubuntu 上，<br>然后执行 run.sh 文件，后面就跟安装普通服务器一样了，需要同意 eula，然后修改 server.properties，最后再次执行 run.sh 就行了</p>
<h3 id="5-2-2-fabric-服务器安装"><a href="#5-2-2-fabric-服务器安装" class="headerlink" title="5.2.2 fabric 服务器安装"></a>5.2.2 fabric 服务器安装</h3><p>下载好 jar 文件后，不需要在 Windows 环境下运行，直接将其放入 Ubuntu 服务器指定目录，然后在 jar 文件同级创建如下启动脚本 run.sh：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 这里的 fabric-server-mc.1.21.1-loader.0.16.14-launcher.1.0.3.jar 是我下载的jar文件，请填写自己下载的jar文件名</span></span><br><span class="line">java -Xms5G -Xmx5G -jar fabric-server-mc.1.21.1-loader.0.16.14-launcher.1.0.3.jar nogui</span><br></pre></td></tr></table></figure></div>

<p>然后执行 run.sh 文件，后面就跟安装普通服务器一样了，需要同意 eula，然后修改 server.properties，最后再次执行 run.sh 就行了</p>
<h2 id="5-3-安装-Mod"><a href="#5-3-安装-Mod" class="headerlink" title="5.3 安装 Mod"></a>5.3 安装 Mod</h2><p>可以去 <a class="link"   href="https://www.curseforge.com/minecraft/search" >Minecraft Mod 网站 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 下载 Mod，<br>如果想通过中文查找 mod，可以去 <a class="link"   href="https://www.mcmod.cn/modlist.html" >我的世界中文维基 mod 百科 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 搜索，<br>然后将 Mod（一般是.jar 文件）放到游戏目录的 mods 目录下就可以用了，<br>客户端和服务器都需要将 Mod 放到 mods 文件夹里面，否则不能正常运行。</p>
<h2 id="5-4-安装光影（可跳过）"><a href="#5-4-安装光影（可跳过）" class="headerlink" title="5.4 安装光影（可跳过）"></a>5.4 安装光影（可跳过）</h2><p>适用于 forge 服务器版本。</p>
<p>光影不需要配置服务器，只需要配置客户端，<br>首先需要在客户端中安装光影加载 Mod（这里以<em>OptiFine</em>为主）。<br><em>需要注意的是，该 Mod 不能从<a class="link"   href="https://www.curseforge.com/minecraft/search" >Minecraft Mod 网站 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>下载，应该在安装客户端时选择安装</em><br>我们的游戏启动器是<em>HMCL</em>，在其中新添加一个游戏，选择 Forge 和 OptFine，最后安装即可。<br>关键顺序如下图所示：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025384_132f42c4ef4620684e17551c11cb3814.jpg"
                     
                ></p>
<p>安装成功带光影加载 Mod 的客户端之后，就需要去 <a class="link"   href="https://modrinth.com/shaders" >下载心仪的光影包 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 了。<br>光影包下载完成后，需要放到游戏的对应目录中，这个目录可以在 <em>游戏启动界面-选项-视频设置-光影</em> 中打开，然后把刚下载的光影包放到对应目录中，选择它就行了</p>
<h2 id="5-5-将服务端添加到系统服务并自启动"><a href="#5-5-将服务端添加到系统服务并自启动" class="headerlink" title="5.5 将服务端添加到系统服务并自启动"></a>5.5 将服务端添加到系统服务并自启动</h2><p><strong>注意，这里设置和普通服务器有一些不一样，不同之处就是需要 root 用户来执行，不能用 minecraft 用户执行，猜测可能是 Mod 版本需要 root 的权限比较多</strong><br>创建&#x2F;etc&#x2F;systemd&#x2F;system&#x2F;minecraft.service 文件</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">touch</span> /etc/systemd/system/minecraft.service</span><br></pre></td></tr></table></figure></div>

<p>修改文件内容为，User 必须是 root</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Minecraft Server</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User=root</span><br><span class="line">WorkingDirectory=/opt/minecraft_forge/server</span><br><span class="line">ExecStart=/usr/bin/bash run.sh</span><br><span class="line">ExecStop=/opt/minecraft/tools/mcrcon/mcrcon -H 127.0.0.1 -P 25575 -p PASSWORD stop</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></div>

<p>绑定系统服务并自启动</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl start minecraft <span class="comment"># 手动启动服务器最好切换到root用户</span></span><br><span class="line">sudo systemctl status minecraft</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> minecraft <span class="comment"># 设置自启动最好也切换到root用户</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>Minecraft</tag>
      </tags>
  </entry>
  <entry>
    <title>VSCode配置C++环境</title>
    <url>/2023/11/03/VSCode%E9%85%8D%E7%BD%AEC-%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<h1 id="安装-VSCode"><a href="#安装-VSCode" class="headerlink" title="安装 VSCode"></a>安装 VSCode</h1><p><a class="link"   href="https://code.visualstudio.com/Download" >VSCode 下载地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>这个简单，一直下一步就能安装了</p>
<h1 id="安装编译器-MinGW"><a href="#安装编译器-MinGW" class="headerlink" title="安装编译器(MinGW)"></a>安装编译器(MinGW)</h1><p><del><a class="link"   href="https://sourceforge.net/projects/mingw-w64/" >MinGW sourceforge <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></del><br><del><strong>注意打开页面后往下拉，选中<em>x86_64-posix-seh</em>这个版本下载</strong></del><br><del><a class="link"   href="https://pan.baidu.com/s/1m7YnDPe62SiiqetgFEyHGw&code=4z5g" >MinGW 百度云备用下载 x86_64-8.1.0-release-posix-seh-rt_v6-rev0.7z <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></del></p>
<p>上面划线内容不适用于 Windows 系统，需要前往 <strong><a class="link"   href="https://github.com/niXman/mingw-builds-binaries/releases" >MinGW github release <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></strong> 选择 Windows 构建版本进行下载。</p>
<ul>
<li><a class="link"   href="https://pan.baidu.com/s/1IXo-wplz5HbZCe-ObnhqIA?pwd=p673" >MinGW 百度云备份下载 x86_64-13.2.0-release-win32-seh-ucrt-rt_v11-rev1.7z <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li><a class="link"   href="https://pan.baidu.com/s/1j9J-vsvd1WgsejTTAgsx-Q?pwd=d7n8" >MinGW 百度云备用下载 x86_64-14.2.0-release-win32-seh-ucrt-rt_v12-rev0.7z <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
</ul>
<p>选择构建版本时，应注意选择带有“x86”、“64”、”win32“、“urct”字眼的版本。</p>
<blockquote>
<p>i686 前缀的版本肯定可以编译 32 位程序，但是否能编译 64 位程序则取决于编译器版本的所用的异常实现模型–dwarf,seh,sjlj。<br>sjlj 适合 32&#x2F;64 位程序(但是它会带来轻微的性能损失,在异常重的代码中有 15%),<br>dwarf 则只能用于 32 位程序,<br>seh 只能用于 64 位程序</p>
<p>——<a class="link"   href="https://blog.csdn.net/weixin_43605586/article/details/105494164" >mingw 不同版本全解析 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</blockquote>
<blockquote>
<p>说明：这个世界上只有两种操作系统，符合 posix 协议的，和 Windows 。如这个笑话所说的，如果你想要开发 Windows 程序，需要选择 win32 ，而开发 Linux、Unix、Mac OS 等其他操作系统下的程序，则需要选择 posix 。<br>操作：我只开发在 Windows 下运行的程序，所以选择了 win32 。</p>
<p>——<a class="link"   href="https://zhuanlan.zhihu.com/p/76613134" >MinGW-w64 安装教程——著名 C&#x2F;C++编译器 GCC 的 Windows 版本 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</blockquote>
<blockquote>
<p>msvcrt 和 ucrt 的主要区别：<br>msvcrt 指的是 Microsoft Visual C++运行时库，这是许多 C 和 C++程序在 Windows 上运行所必需的。它提供了标准的 C 库函数和其他与 Microsoft Visual Studio 相关的特定功能。<br>ucrt 指的是 Universal C Runtime，它是 Windows 10 及更高版本上引入的一个新的 C 运行时库，旨在提供跨 Windows 版本的更一致和更新的 C 标准库实现。与 msvcrt 相比，ucrt 可能包含更多的安全更新和现代 C 标准库特性。</p>
<p>兼容性和部署：<br>使用 msvcrt 构建的应用程序可能更广泛地兼容旧版本的 Windows，但可能受限于特定于 Visual Studio 的功能和更新。<br>使用 ucrt 构建的应用程序则可能需要 Windows 10 或更高版本才能运行，但可以获得更好的安全性和与现代 C 标准库的兼容性。</p>
<p>其他共同点：<br>两个构建版本都针对 x86_64 架构，即 64 位 Windows 系统。<br>它们都使用了 SEH（Structured Exception Handling）作为异常处理机制，这是 Windows 平台上的标准异常处理机制。<br>运行时库版本都是 rt_v12，表示它们基于相同的运行时库版本进行构建。<br>修订版都是 rev0，可能表示它们是同一构建周期内的不同变体。</p>
<p>——<a class="link"   href="https://yiyan.baidu.com/" >文心一言 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</blockquote>
<h2 id="MinGW-和-MSYS2"><a href="#MinGW-和-MSYS2" class="headerlink" title="MinGW 和 MSYS2"></a>MinGW 和 MSYS2</h2><p>也可以选择 MSYS2，但是为了从底层学习编译 C&#x2F;C++，还是推荐使用 MinGW。</p>
<blockquote>
<p>关系：<br>MSYS2 提供了一个集成了多个开发工具和库的环境，其中包括 MinGW-w64 工具链。因此，在 MSYS2 中，用户可以直接使用 MinGW-w64 来编译和生成 Windows 程序。<br>MSYS2 和 MinGW 都致力于在 Windows 平台上提供类似于 Linux 的开发环境，但 MSYS2 提供了更全面的环境和工具集。</p>
<p>区别：<br>MSYS2 是一个更全面的开发环境，提供了 bash shell、版本控制软件、软件包管理系统等多个组件，而 MinGW 主要关注于提供 GCC 编译器和必要的工具及库。<br>MSYS2 中的 MinGW-w64 是 MSYS2 环境的一个组成部分，而单独的 MinGW 是一个独立的编译器集合。<br>在使用上，MSYS2 提供了更便捷的软件包管理和环境配置功能，而 MinGW 则更专注于编译器的使用。</p>
<p>——<a class="link"   href="https://yiyan.baidu.com/" >文心一言 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</blockquote>
<h1 id="配置-MinGW"><a href="#配置-MinGW" class="headerlink" title="配置 MinGW"></a>配置 MinGW</h1><p>把下载好的 MinGW 压缩包解压到任意一个目录，然后配置环境变量到 bin 目录,<br>然后使用下面的命令测试，有输出就配置成功了。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -v</span><br></pre></td></tr></table></figure></div>

<p>如果需要使用 <a href="/2024/12/11/c-%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8conan%E7%9A%84%E4%BD%BF%E7%94%A8/">conan</a>，则需要在系统环境变量中配置 CC 和 CXX，使其指向 gcc 和 g++。</p>
<h1 id="配置-VSCode"><a href="#配置-VSCode" class="headerlink" title="配置 VSCode"></a>配置 VSCode</h1><h2 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h2><ol>
<li><em>C++ Extension Pack</em> ，提供代码提示、调试等功能，该插件会自动识别刚刚配置好的 MinGW，</li>
<li><em>C&#x2F;C++ Project Generator</em> ，一键创建 C&#x2F;C++工程，使用 <strong>ctrl + shift + P</strong> 打开所有命令，输入 <strong>create c++ project</strong> 来创建一个 C++项目</li>
</ol>
<p>然后按 <strong>F5</strong> 就可以调试了，编写 C 程序需要使用 gcc 来编译，编写 C++程序需要 g++来编译。</p>
<blockquote>
<p>一个有趣的事实: 就本质而言，gcc 和 g++ 并不是编译器，也不是编译器的集合，它们只是一种驱动器，根据参数中要编译的文件的类型，调用对应的 GUN 编译器。更准确的说法是：gcc 调用了 C compiler，而 g++ 调用了 C++ compiler。<br>由于编译器是可以更换的，所以 gcc 不仅仅可以编译 C 文件，只要是 GCC 支持编译的程序代码，都可以使用 gcc 命令完成编译。<br>可以这样理解，gcc 是 GCC 编译器的通用编译指令。根据程序文件的后缀名，gcc 指令可以自行判断出当前程序所用编程语言的类别。</p>
<p>——<a class="link"   href="https://juejin.cn/post/7273646418208145463?searchId=20241217132815F3580DA7D45F38B4B76C#heading-12" >梳理 gcc、clang、mingw、cmake <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</blockquote>
<h2 id="配置-Task"><a href="#配置-Task" class="headerlink" title="配置 Task"></a>配置 Task</h2><p>调试编译的脚本存在于项目根目录下的.vscode 目录下的 tasks.json 文件中，<br>其中 <em>command</em> 表示 gcc 编译器的位置，<br> <em>args</em> 表示 gcc 编译器命令行工具的参数，要注意的是如果需要生成一个生产环境的 exe 文件，需要将 <strong><em>-g</em></strong> 参数去掉，该参数是为了方便 gdb 调式用的。</p>
<h2 id="运行-Task"><a href="#运行-Task" class="headerlink" title="运行 Task"></a>运行 Task</h2><p>在顶部菜单栏中选择 <strong>Terminal-&gt;RunTask</strong> ，会显示所有可以运行的 Task，需要打开要运行 task 的文件（比如要编译一个 cpp 文件，需要打开这个 cpp 文件，然后运行 task）</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://juejin.cn/post/6844904071581663239?searchId=202311030906580C440D7321FFA6850A22" >安装参考 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://blog.csdn.net/weixin_44706594/article/details/124129980" >参考 MinGW 没有 bin 目录的解决方法 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://blog.csdn.net/BjarneCpp/article/details/131614026" >MinGW 不同 build 包的区别 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.cnblogs.com/liudianfengmang/p/12458108.html" >VSCode 同时执行多个 Task <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://blog.51cto.com/mshxuyi/6064944" >PowerShell 无法执行脚本的解决方案 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://juejin.cn/post/7273646418208145463?searchId=20241217132815F3580DA7D45F38B4B76C#heading-12" >梳理 gcc、clang、mingw、cmake <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://zhuanlan.zhihu.com/p/76613134" >MinGW-w64 安装教程——著名 C&#x2F;C++编译器 GCC 的 Windows 版本 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://blog.csdn.net/weixin_43352606/article/details/142333338" >MinGW 安装 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://blog.csdn.net/weixin_43605586/article/details/105494164" >mingw 不同版本全解析 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>VSCode</tag>
        <tag>MinGW</tag>
      </tags>
  </entry>
  <entry>
    <title>WebGL常用方法</title>
    <url>/2024/07/19/WebGL%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<p>现在没时间，后面再补吧。</p>
]]></content>
  </entry>
  <entry>
    <title>WOL网络唤醒</title>
    <url>/2023/05/09/WOL%E7%BD%91%E7%BB%9C%E5%94%A4%E9%86%92/</url>
    <content><![CDATA[<p>WOL(Wake On Lan)指的是通过网络发送魔术封包来唤醒关机或睡眠状态下的电脑，配置流程如下：</p>
<span id="more"></span>

<h1 id="关键步骤"><a href="#关键步骤" class="headerlink" title="关键步骤"></a>关键步骤</h1><ol>
<li>电脑BIOS需要开启对应的WOL选项</li>
<li>windows系统点击我的电脑-&gt;管理-&gt;网卡-&gt;允许魔术封包唤醒</li>
<li>windows电源选项关闭快速启动</li>
<li>windows防火墙允许端口7和9，并且协议为tcp&#x2F;udp</li>
<li>通过WOL客户端对电脑IP发送魔术封包即可开机</li>
</ol>
<h2 id="已知问题："><a href="#已知问题：" class="headerlink" title="已知问题："></a>已知问题：</h2><p>电脑关机状态只有关机后的几分钟可以开机成功，过了那几分钟就不能开机成功，<br>但是<strong>睡眠状态下随时可以开机成功</strong></p>
<h1 id="WOL唤醒实现"><a href="#WOL唤醒实现" class="headerlink" title="WOL唤醒实现"></a>WOL唤醒实现</h1><p><a class="link"   href="https://github.com/GJYyyyy/wakeOnLan" >github地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>WOL</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows命令行脚本总结</title>
    <url>/2025/05/09/Windows%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%84%9A%E6%9C%AC%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>一般会将繁琐的命令行操作写在一个脚本文件中，Windows 系统下，该脚本文件一般以 <strong>.cmd</strong> 或者 <strong>.bat</strong> 结尾，下面将称该文件为<strong>批处理文件</strong>。</p>
<p>一个通常的批处理文内容一般如下：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">:: 关闭命令回显功能，执行命令时不会在控制台显示命令本身，仅显示结果</span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line">:: 启用延迟环境变量扩展。允许在循环或代码块中动态更新变量值（使用!var!代替%var%）</span><br><span class="line">setlocal enabledelayedexpansion</span><br><span class="line"></span><br><span class="line">:: 脚本代码正文</span><br><span class="line">ipconfig</span><br><span class="line"></span><br><span class="line">:: 暂停等待用户输入，使用该命令后，双击批处理文件后就不会自动关闭命令行了</span><br><span class="line">pause</span><br></pre></td></tr></table></figure></div>

<h1 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h1><p>REM 关键字<br>这是 CMD 中最标准且兼容性最好的注释方式。REM 后的内容会被解释器忽略。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">REM 这是一个单行注释</span><br><span class="line"><span class="built_in">echo</span> Hello World</span><br></pre></td></tr></table></figure></div>

<p>​​:: 双冒号<br>双冒号本质上是无效的标签语法，但常被用作注释，比 REM 更简洁。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">:: 这是另一种单行注释</span><br><span class="line"><span class="built_in">echo</span> Hello World</span><br></pre></td></tr></table></figure></div>

<h1 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h1><h1 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h1><h1 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h1><h1 id="脚本段"><a href="#脚本段" class="headerlink" title="脚本段"></a>脚本段</h1><p>一种过程体，将功能封装起来，以便后续调用，</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">:: 声明脚本段，以英文冒号开头带一个标识符，如下</span><br><span class="line">:: 该示例中，即使不主动调用:ShowIpInfo，当脚本顺序执行到其时，也会执行其内部逻辑</span><br><span class="line">:ShowIpInfo</span><br><span class="line">:: 该脚本段用于获取ip信息</span><br><span class="line"><span class="built_in">echo</span> 该脚本段用于获取ip信息</span><br><span class="line">cls</span><br><span class="line"><span class="built_in">echo</span> ========== ip info ==========</span><br><span class="line">ipconfig</span><br><span class="line"><span class="built_in">echo</span> ========== ip info ==========</span><br><span class="line">pause</span><br><span class="line">​​<span class="built_in">exit</span> /b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:: 无条件跳转</span><br><span class="line">:: 直接跳转到脚本中指定的标签位置，从标签后的代码继续执行，且​​不会自动返回​​原调用位置</span><br><span class="line">:: 典型用途​​：实现循环、条件分支或错误处理</span><br><span class="line">goto ShowIpInfo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:: 调用子程序</span><br><span class="line">:: 可以调用另一个批处理文件（外部脚本）或脚本内的标签段（内部子程序），执行结束后​​自动返回原调用位置​​继续执行后续代码</span><br><span class="line">:: 典型用途​​：模块化代码、复用功能逻辑、传递参数</span><br><span class="line">call ShowIpInfo</span><br></pre></td></tr></table></figure></div>

<h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">:: 在命令行中输出内容</span><br><span class="line"><span class="built_in">echo</span> 内容</span><br><span class="line"></span><br><span class="line">:: 强制终止整个 CMD 会话（包括所有嵌套的脚本和进程）。</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">:: 仅退出当前批处理脚本或函数，不会终止父级脚本或 CMD 会话</span><br><span class="line">​​<span class="built_in">exit</span> /b</span><br><span class="line">:: 通过参数指定退出状态码，并将该状态码传递给 %ERRORLEVEL%，供调用者检测处理错误或逻辑分支</span><br><span class="line"><span class="built_in">exit</span> /b 1</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>命令行</tag>
        <tag>操作系统</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows系统下整合编译cpp-httplib库</title>
    <url>/2024/09/23/Windows%E7%B3%BB%E7%BB%9F%E4%B8%8B%E6%95%B4%E5%90%88%E7%BC%96%E8%AF%91cpp-httplib%E5%BA%93/</url>
    <content><![CDATA[<p>系统：Windows 11<br>代码编辑器：VSCode<br>编译器：MinGW</p>
<p>因为某些原因，我需要在自己的 C++项目中集成一个 http 协议库，这里选择了<a class="link"   href="https://github.com/yhirose/cpp-httplib" >cpp-httplib 库 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，因为它只有一个头文件，引入就可以用了，很方便。</p>
<h1 id="开发环境："><a href="#开发环境：" class="headerlink" title="开发环境："></a>开发环境：</h1><p>系统：Windows 11<br>代码编辑器：VSCode<br>编译器：MinGW</p>
<h1 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h1><p>目录如下：</p>
<ul>
<li>include<ul>
<li>httplib.h 关键头文件，实现 http 协议</li>
</ul>
</li>
<li>obj 编译后的 object 文件</li>
<li>output 链接后的可执行文件</li>
<li>src 源文件<ul>
<li>server.cpp 服务端代码</li>
</ul>
</li>
<li>Makefile</li>
<li>make.ps1</li>
</ul>
<h2 id="src-x2F-server-cpp"><a href="#src-x2F-server-cpp" class="headerlink" title="src&#x2F;server.cpp"></a>src&#x2F;server.cpp</h2><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../include/httplib.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    httplib::Server svr;</span><br><span class="line">    svr.<span class="built_in">Get</span>(<span class="string">&quot;/hi&quot;</span>, [](<span class="type">const</span> httplib::Request &amp;, httplib::Response &amp;res)</span><br><span class="line">            &#123; res.<span class="built_in">set_content</span>(<span class="string">&quot;Hello World!&quot;</span>, <span class="string">&quot;text/plain&quot;</span>); &#125;);</span><br><span class="line"></span><br><span class="line">    svr.<span class="built_in">listen</span>(<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">1234</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h2><div class="highlight-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 匹配指定目录下的所有.cpp文件。将文件名组成列表，赋值给变量src</span></span><br><span class="line">src = <span class="variable">$(<span class="built_in">wildcard</span> ./src/*.cpp)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将文件名中的.cpp后缀替换为.o，得到目标文件名组成列表，赋值给变量obj</span></span><br><span class="line">obj = <span class="variable">$(<span class="built_in">patsubst</span> ./src/%.cpp, ./obj/%.o, <span class="variable">$(src)</span>)</span></span><br><span class="line"></span><br><span class="line">compile = g++</span><br><span class="line"></span><br><span class="line"><span class="comment"># 各种目录</span></span><br><span class="line">src_path = ./src</span><br><span class="line">inc_path = ./<span class="keyword">include</span></span><br><span class="line">obj_path = ./obj</span><br><span class="line">out_path = ./output</span><br><span class="line"></span><br><span class="line"><span class="comment"># 其他参数</span></span><br><span class="line"><span class="comment"># -lws2_32 是 winsock2 的库，如果你没有使用 winsock2，可以删除</span></span><br><span class="line">myArgs = -lws2_32</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译终极目标</span></span><br><span class="line"><span class="section">ALL: server.exe</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 模式规则</span></span><br><span class="line"><span class="variable">$(obj)</span>: <span class="variable">$(obj_path)</span>/%.o: $&#123;src_path&#125;/%.cpp</span><br><span class="line">	$&#123;compile&#125; -c <span class="variable">$&lt;</span> -o <span class="variable">$@</span> -I <span class="variable">$(inc_path)</span></span><br><span class="line"></span><br><span class="line"><span class="section">server.exe: <span class="variable">$(obj)</span></span></span><br><span class="line">	$&#123;compile&#125; <span class="variable">$^</span> -o <span class="variable">$(out_path)</span>/<span class="variable">$@</span> <span class="variable">$(myArgs)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 清理目标文件</span></span><br><span class="line">clean :</span><br><span class="line">	-rm -rf <span class="variable">$(obj)</span> <span class="variable">$(out_path)</span>/server.exe</span><br><span class="line"></span><br><span class="line"><span class="comment"># 伪目标</span></span><br><span class="line"><span class="comment"># 当前文件夹下有 ALL 文件或者 clean 文件时，会导致 makefile 瘫痪</span></span><br><span class="line"><span class="comment"># 用伪目标来解决， 添加一行 .PHONY: clean ALL</span></span><br><span class="line">.PHONY : clean ALL</span><br></pre></td></tr></table></figure></div>

<h2 id="make-ps1"><a href="#make-ps1" class="headerlink" title="make.ps1"></a>make.ps1</h2><p>相当于为 mingw32-make 起了个别名 make</p>
<div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line">mingw32<span class="literal">-make</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>HTTP</tag>
        <tag>VSCode</tag>
        <tag>MinGW</tag>
      </tags>
  </entry>
  <entry>
    <title>c++包管理器conan的使用</title>
    <url>/2024/12/11/c-%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8conan%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>原来 c&#x2F;c++ 也是有包管理器的。</p>
<span id="more"></span>

<h1 id="conan"><a href="#conan" class="headerlink" title="conan"></a>conan</h1><p>vcpkg 和 <a class="link"   href="https://conan.io/" >conan <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 是两个 c&#x2F;c++ 流行的包管理器，我选择 conan 是因为它灵活，不像 vcpkg 非要和微软绑定（我的编译器也是采用的 MinGW，不喜欢微软的编译器）</p>
<h2 id="安装-python"><a href="#安装-python" class="headerlink" title="安装 python"></a>安装 python</h2><p>conan 依赖 pip，所以需要先安装 python。<br><em>python 安装过于简单，此处略。</em><br><strong>需要注意的是，conan 部分功能依赖于 python，需要考虑安装合适的 python 版本。</strong></p>
<h3 id="切换-pip-源"><a href="#切换-pip-源" class="headerlink" title="切换 pip 源"></a>切换 pip 源</h3><p>pip 默认源在国内访问速度很慢，可以切换为国内源。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 如果pip的可执行文件又被更改过文件名，需要使用更改后的文件名，比如当pip.exe改为pip3.exe时，需要使用pip3</span></span><br><span class="line">pip config <span class="built_in">set</span> global.index-url https://mirrors.aliyun.com/pypi/simple/</span><br></pre></td></tr></table></figure></div>

<p>切换完成后，可以使用下面命令检测是否切换成功。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">pip config list</span><br></pre></td></tr></table></figure></div>

<h2 id="安装-conan"><a href="#安装-conan" class="headerlink" title="安装 conan"></a>安装 conan</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">pip install conan</span><br></pre></td></tr></table></figure></div>

<p>检测 conan 是否安装成功</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">conan --version</span><br></pre></td></tr></table></figure></div>

<h3 id="配置第三方库默认安装目录"><a href="#配置第三方库默认安装目录" class="headerlink" title="配置第三方库默认安装目录"></a>配置第三方库默认安装目录</h3><p>conan 会默认在当前用户目录（C 盘）下安装第三方库，可以通过修改 global.conf 文件来修改默认安装目录。<br>找到 global.conf 文件，一般在当前用户目录下的 .conan2 目录中可以找到。添加如下内容。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">core.cache:storage_path = C:\Users\danielm\my_conan_storage_folder</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>core.cache:storage_path</p>
<p>Absolute path to a folder where the Conan packages and the database of the packages will be stored. This folder will be the heaviest Conan storage folder, as it stores the binary packages downloaded or created.</p>
</blockquote>
<h2 id="安装-meson（可选）"><a href="#安装-meson（可选）" class="headerlink" title="安装 meson（可选）"></a>安装 meson（可选）</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">pip install meson</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检测是否安装成功</span></span><br><span class="line">meson --version</span><br></pre></td></tr></table></figure></div>

<h2 id="安装-ninja（可选）"><a href="#安装-ninja（可选）" class="headerlink" title="安装 ninja（可选）"></a>安装 ninja（可选）</h2><p><a class="link"   href="https://github.com/ninja-build/ninja/releases" >https://github.com/ninja-build/ninja/releases <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h2 id="安装-nasm（可选）"><a href="#安装-nasm（可选）" class="headerlink" title="安装 nasm（可选）"></a>安装 nasm（可选）</h2><p><a class="link"   href="https://www.nasm.us/" >https://www.nasm.us/ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h2 id="搜索远程仓库"><a href="#搜索远程仓库" class="headerlink" title="搜索远程仓库"></a>搜索远程仓库</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 例如需要搜索jsoncpp的包，不加 -r 表示搜索本地仓库</span></span><br><span class="line">conan search jsoncpp -r conancenter</span><br></pre></td></tr></table></figure></div>

<h1 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h1><p>项目目录结构如下：</p>
<ul>
<li>conanfile.txt</li>
<li>CMakeLists.txt</li>
<li>src&#x2F;<ul>
<li>main.cpp</li>
</ul>
</li>
<li>build&#x2F;</li>
</ul>
<h2 id="conanfile-txt"><a href="#conanfile-txt" class="headerlink" title="conanfile.txt"></a>conanfile.txt</h2><p>conanfile.txt 是 conan 在本项目下的配置文件，描述项目所需的依赖库，以及项目的生成器。</p>
<p><strong>最新版本 conan（2.10.2） 不再支持 cmake 生成器，仅支持 CMakeDeps、CMakeToolchain</strong></p>
<div class="highlight-container" data-rel="Txt"><figure class="iseeu highlight txt"><table><tr><td class="code"><pre><span class="line">[requires]</span><br><span class="line">jsoncpp/1.9.5</span><br><span class="line"></span><br><span class="line">[generators]</span><br><span class="line">CMakeDeps</span><br><span class="line">CMakeToolchain</span><br><span class="line"></span><br><span class="line">[options]</span><br><span class="line"># conan管理的第三方库默认是以静态库lib的形式集成到项目中去的，如果需要动态库dll形式，则需要添加以下内容</span><br><span class="line"># jsoncpp/1.9.5:shared=True</span><br></pre></td></tr></table></figure></div>

<p>jsoncpp 是一个帮助 c++处理 json 数据的库，在 conanfile.txt 中添加如下内容，表示依赖 jsoncpp&#x2F;1.9.5 版本的 jsoncpp。</p>
<h2 id="CMakeLists-txt"><a href="#CMakeLists-txt" class="headerlink" title="CMakeLists.txt"></a>CMakeLists.txt</h2><p>CMakeLists.txt 是 cmake 在本项目下的配置文件，描述了项目的编译选项，以及链接依赖库，参考<a href="/2024/10/29/%E5%9C%A8Windows%E4%B8%8B%E4%BD%BF%E7%94%A8CMake%E6%9E%84%E5%BB%BA%E5%92%8C%E7%AE%A1%E7%90%86%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/">在 Windows 下使用 CMake 构建和管理第三方库</a></p>
<div class="highlight-container" data-rel="Txt"><figure class="iseeu highlight txt"><table><tr><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.15)</span><br><span class="line"></span><br><span class="line"># 如果是C项目，需要将下面的 CXX 改为 C</span><br><span class="line">project(compressor CXX)</span><br><span class="line"></span><br><span class="line"># 引入conan生成的cmake文件</span><br><span class="line"># 在conan install时，会生成conandeps_legacy.cmake文件，这里需要引入进来，后面才能使用CONANDEPS_LEGACY</span><br><span class="line">include(build/conandeps_legacy.cmake)</span><br><span class="line"></span><br><span class="line">add_executable($&#123;PROJECT_NAME&#125; src/main.cpp)</span><br><span class="line"></span><br><span class="line"># 链接依赖库，CONANDEPS_LEGACY是conan生成的cmake文件里的变量，包含引用的依赖库列表</span><br><span class="line">target_link_libraries($&#123;PROJECT_NAME&#125; $&#123;CONANDEPS_LEGACY&#125;)</span><br></pre></td></tr></table></figure></div>

<h2 id="src-x2F-main-cpp"><a href="#src-x2F-main-cpp" class="headerlink" title="src&#x2F;main.cpp"></a>src&#x2F;main.cpp</h2><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;json/json.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// JSON 字符串</span></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *jsonString = <span class="string">R&quot;(&#123;</span></span><br><span class="line"><span class="string">        &quot;name&quot;: &quot;John Doe&quot;,</span></span><br><span class="line"><span class="string">        &quot;age&quot;: 30,</span></span><br><span class="line"><span class="string">        &quot;is_student&quot;: false,</span></span><br><span class="line"><span class="string">        &quot;grades&quot;: [90, 85, 88]</span></span><br><span class="line"><span class="string">    &#125;)&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解析 JSON 字符串</span></span><br><span class="line">    Json::CharReaderBuilder readerBuilder;</span><br><span class="line">    Json::Value root;</span><br><span class="line">    std::string errs;</span><br><span class="line">    <span class="function">std::istringstream <span class="title">s</span><span class="params">(jsonString)</span></span>;</span><br><span class="line">    <span class="type">bool</span> parsingSuccessful = Json::<span class="built_in">parseFromStream</span>(readerBuilder, s, &amp;root, &amp;errs);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!parsingSuccessful)</span><br><span class="line">    &#123;</span><br><span class="line">        std::cerr &lt;&lt; <span class="string">&quot;Failed to parse JSON: &quot;</span> &lt;&lt; errs &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 访问 JSON 数据</span></span><br><span class="line">    std::string name = root[<span class="string">&quot;name&quot;</span>].<span class="built_in">asString</span>();</span><br><span class="line">    <span class="type">int</span> age = root[<span class="string">&quot;age&quot;</span>].<span class="built_in">asInt</span>();</span><br><span class="line">    <span class="type">bool</span> isStudent = root[<span class="string">&quot;is_student&quot;</span>].<span class="built_in">asBool</span>();</span><br><span class="line">    Json::Value grades = root[<span class="string">&quot;grades&quot;</span>];</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Name: &quot;</span> &lt;&lt; name &lt;&lt; std::endl;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Age: &quot;</span> &lt;&lt; age &lt;&lt; std::endl;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Is Student: &quot;</span> &lt;&lt; (isStudent ? <span class="string">&quot;Yes&quot;</span> : <span class="string">&quot;No&quot;</span>) &lt;&lt; std::endl;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Grades: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;grade : grades)</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; grade.<span class="built_in">asInt</span>() &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h2><p>编译时可能会需要 python、ninja、nasm 等工具，如遇报错，请优先查看工具是否安装，并且是否兼容。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 第一次编译时，需要执行下列命令，获取平台信息</span></span><br><span class="line">conan profile detect</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在项目根目录执行conan install</span></span><br><span class="line"><span class="comment"># --output-folder=build 表示将conan生成的文件保存在build目录下</span></span><br><span class="line"><span class="comment"># --build=missing 表示如果没有预编译的库，就下载源码来编译</span></span><br><span class="line"><span class="comment"># --profile=myProfile 表示使用自定义的myProfile配置文件</span></span><br><span class="line">conan install . --output-folder=build --build=missing --profile=myProfile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入build目录</span></span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成 Makefile</span></span><br><span class="line">cmake .. -G <span class="string">&quot;MinGW Makefiles&quot;</span> -DCMAKE_TOOLCHAIN_FILE=<span class="string">&quot;conan_toolchain.cmake&quot;</span>  -DCMAKE_BUILD_TYPE=Release</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译</span></span><br><span class="line">cmake --build . --config Release</span><br></pre></td></tr></table></figure></div>

<h3 id="profile"><a href="#profile" class="headerlink" title="profile"></a>profile</h3><p>使用 conan profile detect 命令自动生成的 profile 文件会根据环境的不同生成不同的内容。</p>
<p>参考 windows 环境下会生成的内容：</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line">[settings]</span><br><span class="line">arch=x86_64</span><br><span class="line">build_type=Release</span><br><span class="line">compiler=gcc</span><br><span class="line">compiler.cppstd=gnu17</span><br><span class="line">compiler.libcxx=libstdc++11</span><br><span class="line">compiler.version=14</span><br><span class="line">os=Windows</span><br></pre></td></tr></table></figure></div>

<p>参考 linux 环境下会生成的内容：</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line">[settings]</span><br><span class="line">arch=x86_64</span><br><span class="line">build_type=Release</span><br><span class="line">compiler=gcc</span><br><span class="line">compiler.cppstd=gnu17</span><br><span class="line">compiler.libcxx=libstdc++11</span><br><span class="line">compiler.version=11</span><br><span class="line">os=Linux</span><br></pre></td></tr></table></figure></div>

<h3 id="自定义-profile"><a href="#自定义-profile" class="headerlink" title="自定义 profile"></a>自定义 profile</h3><p>如果你想交叉编译，则可以通过自定义 profile 来实现。</p>
<p>例如在 Linux 系统上构建 windows 项目，则可以通过自定义 profile 来实现。参考内容如下：</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line">[settings]</span><br><span class="line">arch=x86_64</span><br><span class="line">build_type=Release</span><br><span class="line">compiler=gcc</span><br><span class="line">compiler.cppstd=gnu17</span><br><span class="line">compiler.libcxx=libstdc++11</span><br><span class="line">compiler.version=14</span><br><span class="line">os=Windows</span><br></pre></td></tr></table></figure></div>

<p>可以注意到，os 被替换为了 Windows，代表编译目标的运行环境。</p>
<h3 id="添加编译器路径到系统环境变量"><a href="#添加编译器路径到系统环境变量" class="headerlink" title="添加编译器路径到系统环境变量"></a>添加编译器路径到系统环境变量</h3><p>在执行 conan profile detect 之前，一定要确保编译器已经在系统环境变量中配置好。最好是在系统中永久配置好，当然如果你想临时设置，也可以通过命令行设置。</p>
<p><em>特别注意：<strong>CC 和 CXX 的值，一定要以斜杠（&#x2F;）分隔，不用使用反斜杠（\）</strong>，否则构建会失败，这是因为构建期间会涉及到 Windows 文件系统之外的文件系统，比如 linux 系统就不支持使用反斜杠作为路径分隔符。</em></p>
<div class="highlight-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="code"><pre><span class="line"># 临时设置(<span class="built_in">cmd</span>)</span><br><span class="line"><span class="built_in">set</span> CC=<span class="built_in">path</span>/to/your/gcc.exe</span><br><span class="line"><span class="built_in">set</span> CXX=<span class="built_in">path</span>/to/your/g++.exe</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 临时设置(powershell)</span></span><br><span class="line"><span class="variable">$env:CC</span>=<span class="string">&quot;path/to/your/gcc.exe&quot;</span></span><br><span class="line"><span class="variable">$env:CXX</span>=<span class="string">&quot;path/to/your/g++.exe&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>如果是在Linux系统上进行交叉编译</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> CC=x86_64-w64-mingw32-gcc</span><br><span class="line"><span class="built_in">export</span> CXX=x86_64-w64-mingw32-g++</span><br></pre></td></tr></table></figure></div>

<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h2 id="本地库目录"><a href="#本地库目录" class="headerlink" title="本地库目录"></a>本地库目录</h2><p>一般 conan 安装的包都会保存在 C:\Users\yourUserName.conan2\p\b 目录下，安装时会自动添加到系统环境变量中。代码中可以使用尖括号 &lt;&gt; 来引用本地库，例如：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;json/json.h&gt;</span></span></span><br></pre></td></tr></table></figure></div>

<h2 id="vscode-语法高亮"><a href="#vscode-语法高亮" class="headerlink" title="vscode 语法高亮"></a>vscode 语法高亮</h2><p>需要在项目中添加 .vscode\c_cpp_properties.json 文件，</p>
<p>添加 <strong>“C:&#x2F;Users&#x2F;yourUserName&#x2F;.conan2&#x2F;p&#x2F;b&#x2F;**“</strong>,</p>
<p>完整内容如下：</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Win32&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;includePath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;$&#123;workspaceFolder&#125;/**&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;C:/Users/yourUserName/.conan2/p/b/**&quot;</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;defines&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;_DEBUG&quot;</span><span class="punctuation">,</span> <span class="string">&quot;UNICODE&quot;</span><span class="punctuation">,</span> <span class="string">&quot;_UNICODE&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;compilerPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\MinGW\\mingw64\\bin\\gcc.exe&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;cStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c17&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;cppStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gnu++14&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;intelliSenseMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;windows-gcc-x64&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="number">4</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://docs.conan.io/2/tutorial/consuming_packages/build_simple_cmake_project.html#" >Build a simple CMake project using Conan - conan 2.10.2 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.cnblogs.com/santiego/p/16241318.html" >C&#x2F;C++ 包管理器 Conan 使用指南 - conan 1.48.0 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a href="/2024/10/29/%E5%9C%A8Windows%E4%B8%8B%E4%BD%BF%E7%94%A8CMake%E6%9E%84%E5%BB%BA%E5%92%8C%E7%AE%A1%E7%90%86%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/">在 Windows 下使用 CMake 构建和管理第三方库</a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>VSCode</tag>
        <tag>MinGW</tag>
        <tag>CMake</tag>
        <tag>conan</tag>
      </tags>
  </entry>
  <entry>
    <title>Web页面无操作时使系统锁定</title>
    <url>/2024/09/14/Web%E9%A1%B5%E9%9D%A2%E6%97%A0%E6%93%8D%E4%BD%9C%E6%97%B6%E4%BD%BF%E7%B3%BB%E7%BB%9F%E9%94%81%E5%AE%9A/</url>
    <content><![CDATA[<p>在掘金里看到 <a class="link"   href="https://juejin.cn/post/7373831659470880806" >一篇文章 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> ，说领导让实习生实现一个功能，在浏览器中实现一个页面无操作时锁屏的功能。<br>我突然感觉好熟悉，不就是以前网络上一个梗的衍生吗（根据用户心情来修改手机保护壳颜色）？</p>
<p>不过话说回来，还真给他实现了，他的实现思路大概就是把整个 Web 应用使用 <a class="link"   href="https://www.npmjs.com/package/sys-shim" >sys-shim <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 库打包成一个本地的应用，然后调用本地 API 来锁定系统。</p>
<span id="more"></span>

<p>但是个人感觉没必要，他这个实现过程非常滴曲线救国，<br>不就是想让浏览器调用本地 API 吗？</p>
<p><strong>直接在客户电脑上跑一个 HTTP 服务，然后让浏览器去请求这个 HTTP 服务，服务来调用本地 API 不就行了？</strong></p>
<p><em>为什么必须绕这么一个弯，是因为截至目前，浏览器都不能直接调用本地 API（为了安全）。</em></p>
<p>当然这种方法是有前提的，那就是该项目必须是 <strong><a class="link"   href="https://baike.baidu.com/item/to%20b/24125577?fr=ge_ala" >ToB（面向企业） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></strong> 项目。</p>
<p>只有 <strong>ToB</strong> 的项目，才能实现去特定客户的电脑上安装一个 HTTP 服务。</p>
<p>好了，不说了，下面看实现：<strong>Web 页面无操作时使系统锁定</strong></p>
<h1 id="本地-HTTP-服务"><a href="#本地-HTTP-服务" class="headerlink" title="本地 HTTP 服务"></a>本地 HTTP 服务</h1><p>需要在客户电脑上运行一个本地 HTTP 服务，用来调用系统锁定 API。<br>这里使用 NodeJS 来实现。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server.js</span></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">5667</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handler</span> = (<span class="params">req, res</span>) =&gt; &#123;</span><br><span class="line">  res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;text/plain;charset=utf8&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/\/lock$/</span>.<span class="title function_">test</span>(req.<span class="property">url</span>)) &#123;</span><br><span class="line">    <span class="title function_">lock</span>();</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&quot;锁定成功&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&quot;路径错误&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(handler);</span><br><span class="line">server.<span class="title function_">listen</span>(port);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使计算机锁定</span></span><br><span class="line"><span class="keyword">const</span> &#123; exec &#125; = <span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> lockCommand = <span class="string">&quot;rundll32.exe user32.dll,LockWorkStation&quot;</span>; <span class="comment">// 锁定命令</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">lock</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">exec</span>(lockCommand, <span class="function">(<span class="params">error, stdout, stderr</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`执行出错: <span class="subst">$&#123;error&#125;</span>`</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;电脑已锁定。&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>然后使用 NodeJS 将本地 HTTP 服务跑起来就可以了</p>
<h2 id="部署为-HTTP-服务"><a href="#部署为-HTTP-服务" class="headerlink" title="部署为 HTTP 服务"></a>部署为 HTTP 服务</h2><p>这一步是为了方便 HTTP 服务随着计算机启动而一起启动。<br>需要先把 HTTP 服务的 js 文件打包成一个 exe 文件。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装pkg库，用来将js文件打包为exe文件</span></span><br><span class="line">npm i -g pkg</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行</span></span><br><span class="line">npx pkg server.js</span><br></pre></td></tr></table></figure></div>

<p>可以获得一个 exe 文件。<br>然后需要在客户电脑上注册一个服务，用来随计算机启动而启动这个 HTTP 服务。<br>过程略，很简单，自行百度去。</p>
<h1 id="Web-页面"><a href="#Web-页面" class="headerlink" title="Web 页面"></a>Web 页面</h1><p>页面上，当鼠标没有移动&#x2F;键盘没有敲击后的一段时间，执行系统的锁定。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求锁定系统</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">requestLock</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> port = <span class="number">5667</span>;</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">`http://localhost:<span class="subst">$&#123;port&#125;</span>/lock`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> timer = <span class="number">0</span>; <span class="comment">// 定时器</span></span><br><span class="line"><span class="keyword">const</span> interval = <span class="number">10</span> * <span class="number">60</span>; <span class="comment">// 10 分钟</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 防抖</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">debouncing</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (timer != <span class="number">0</span>) <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">  timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">requestLock</span>();</span><br><span class="line">    timer = <span class="number">0</span>;</span><br><span class="line">  &#125;, interval);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">debouncing</span>(); <span class="comment">// 初始调用</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听鼠标移动/键盘敲击</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onmousemove</span> = debouncing;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onkeydown</span> = debouncing;</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>Node.js</tag>
      </tags>
  </entry>
  <entry>
    <title>canvas常用方法</title>
    <url>/2024/11/12/canvas%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h1 id="创建-canvas-画布"><a href="#创建-canvas-画布" class="headerlink" title="创建 canvas 画布"></a>创建 canvas 画布</h1><p><strong>注意：</strong></p>
<ol>
<li>canvas 的原点是在左上角，而不是传统的左下角，这个需要自己处理</li>
</ol>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#canvas</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100vw</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">&quot;canvas&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> $canvas = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;canvas&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        注意：</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        这里一定要设置画布的宽高，否则画布宽高可能不是预期的数值，画布的宽高以及内部的图形的数值单位都是像素（px）</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        我这里将画布的宽高设置为canvas元素的可视宽度和高度（包含border），这样画布的宽高就是我们看得到的具体的canvas的宽高了</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        */</span></span></span><br><span class="line"><span class="language-javascript">      $canvas.<span class="property">width</span> = $canvas.<span class="property">offsetWidth</span>;</span></span><br><span class="line"><span class="language-javascript">      $canvas.<span class="property">height</span> = $canvas.<span class="property">offsetHeight</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 创建画布2d上下文ctx</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> ctx = $canvas.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 后续画画的操作都是在ctx上进行的</span></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="基础图形的绘制"><a href="#基础图形的绘制" class="headerlink" title="基础图形的绘制"></a>基础图形的绘制</h1><p>图形的绘制基本都包含 <strong>路径绘制 stroke</strong> 和 <strong>颜色填充 fill</strong>。<br>视业务需要灵活选择。</p>
<h2 id="折线"><a href="#折线" class="headerlink" title="折线"></a>折线</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 绘制折线</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">beginPath重置并清除之前的所有路径。</span></span><br><span class="line"><span class="comment">当你需要开始画一个新图形并且之前有未完成的图形时，需要调用beginPath()；</span></span><br><span class="line"><span class="comment">不需要调用beginPath()的情景：1.之前没有未完成的图形时，2.只画一个图形时。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">ctx.<span class="title function_">beginPath</span>();</span><br><span class="line">ctx.<span class="property">strokeStyle</span> = <span class="string">&quot;red&quot;</span>; <span class="comment">// 设置线条颜色</span></span><br><span class="line">ctx.<span class="property">lineWidth</span> = <span class="number">5</span>; <span class="comment">// 设置线条宽度，px</span></span><br><span class="line">ctx.<span class="title function_">setLineDash</span>([<span class="number">10</span>, <span class="number">5</span>]); <span class="comment">// 如果需要画虚线，需要设置该数组，数组里第一个元素表示实线的长度px，第二个元素表示空白的长度px</span></span><br><span class="line">ctx.<span class="title function_">moveTo</span>(<span class="number">0</span>, <span class="number">0</span>); <span class="comment">// 移动画笔到坐标(0,0)，不画线</span></span><br><span class="line">ctx.<span class="title function_">lineTo</span>(<span class="number">100</span>, <span class="number">100</span>); <span class="comment">// 移动画笔到坐标(100,100)，画线</span></span><br><span class="line">ctx.<span class="title function_">lineTo</span>(<span class="number">200</span>, <span class="number">0</span>); <span class="comment">// 移动画笔到坐标(200,0)，画线</span></span><br><span class="line">ctx.<span class="title function_">closePath</span>(); <span class="comment">// 闭合路径，自动从当前点画一条线到起始点</span></span><br><span class="line">ctx.<span class="title function_">stroke</span>(); <span class="comment">// 这一步才是真正的绘制，不调用就不会画到画布上</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 填充折线围起来的区域，不需要closePath()</span></span><br><span class="line"><span class="comment">// 如果只需要画线，这一步就不是必须的</span></span><br><span class="line">ctx.<span class="property">fillStyle</span> = <span class="string">&quot;blue&quot;</span>; <span class="comment">// 填充颜色</span></span><br><span class="line">ctx.<span class="title function_">fill</span>(); <span class="comment">// 这一步才是真正的填充，不调用就不会画到画布上</span></span><br></pre></td></tr></table></figure></div>

<h2 id="矩形"><a href="#矩形" class="headerlink" title="矩形"></a>矩形</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 绘制矩形边框</span></span><br><span class="line">ctx.<span class="title function_">beginPath</span>();</span><br><span class="line">ctx.<span class="property">strokeStyle</span> = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">ctx.<span class="title function_">setLineDash</span>([<span class="number">10</span>, <span class="number">0</span>]); <span class="comment">// 这样设置，就是实线，而不是虚线</span></span><br><span class="line">ctx.<span class="property">lineWidth</span> = <span class="number">5</span>;</span><br><span class="line">ctx.<span class="title function_">strokeRect</span>(<span class="number">50</span>, <span class="number">50</span>, <span class="number">200</span>, <span class="number">100</span>); <span class="comment">// 参数分别为x坐标、y坐标、宽度、高度</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 填充矩形</span></span><br><span class="line">ctx.<span class="property">fillStyle</span> = <span class="string">&quot;blue&quot;</span>;</span><br><span class="line">ctx.<span class="title function_">fillRect</span>(<span class="number">50</span>, <span class="number">50</span>, <span class="number">200</span>, <span class="number">100</span>); <span class="comment">// 参数分别为x坐标、y坐标、宽度、高度</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 擦除矩形</span></span><br><span class="line"><span class="comment">// 会擦除这块区域的所有图形</span></span><br><span class="line">ctx.<span class="title function_">clearRect</span>(<span class="number">75</span>, <span class="number">75</span>, <span class="number">100</span>, <span class="number">50</span>); <span class="comment">// 参数分别为x坐标、y坐标、宽度、高度</span></span><br></pre></td></tr></table></figure></div>

<h2 id="圆形"><a href="#圆形" class="headerlink" title="圆形"></a>圆形</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 绘制圆形边框</span></span><br><span class="line"><span class="keyword">const</span> radius = <span class="number">50</span>; <span class="comment">// 设置圆的半径</span></span><br><span class="line">ctx.<span class="title function_">beginPath</span>();</span><br><span class="line">ctx.<span class="property">strokeStyle</span> = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">ctx.<span class="title function_">setLineDash</span>([<span class="number">10</span>, <span class="number">0</span>]); <span class="comment">// 这样设置，就是实线，而不是虚线</span></span><br><span class="line">ctx.<span class="property">lineWidth</span> = <span class="number">5</span>;</span><br><span class="line">ctx.<span class="title function_">arc</span>(<span class="number">300</span>, <span class="number">300</span>, radius, <span class="number">0</span>, <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="number">2</span>, <span class="literal">false</span>); <span class="comment">// 参数分别为x坐标、y坐标、半径、起始角度（弧度）、结束角度（弧度）、是否逆时针绘制</span></span><br><span class="line">ctx.<span class="title function_">stroke</span>(); <span class="comment">// 这一步才是真正的绘制，不调用就不会画到画布上</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 填充圆形</span></span><br><span class="line">ctx.<span class="property">fillStyle</span> = <span class="string">&quot;blue&quot;</span>;</span><br><span class="line">ctx.<span class="title function_">fill</span>(); <span class="comment">// 这一步才是真正的填充，不调用就不会画到画布上</span></span><br></pre></td></tr></table></figure></div>

<h1 id="剪切图形"><a href="#剪切图形" class="headerlink" title="剪切图形"></a>剪切图形</h1><p>有时候需要在一个异形区域类绘制图形，此时就需要裁剪功能 clip() 了</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 设置裁剪区域</span></span><br><span class="line">ctx.<span class="title function_">beginPath</span>();</span><br><span class="line">ctx.<span class="title function_">moveTo</span>(<span class="number">500</span>, <span class="number">500</span>);</span><br><span class="line">ctx.<span class="title function_">lineTo</span>(<span class="number">500</span>, <span class="number">500</span>);</span><br><span class="line">ctx.<span class="title function_">lineTo</span>(<span class="number">550</span>, <span class="number">550</span>);</span><br><span class="line">ctx.<span class="title function_">lineTo</span>(<span class="number">520</span>, <span class="number">600</span>);</span><br><span class="line">ctx.<span class="title function_">closePath</span>();</span><br><span class="line">ctx.<span class="title function_">clip</span>(); <span class="comment">// 裁减区域</span></span><br><span class="line"><span class="comment">// 后续的绘制都只会在该区域内显示</span></span><br><span class="line"><span class="comment">// 注意，一旦使用了clip()，后续绘制只会出现在该区域内，且无法撤销 clip()</span></span><br><span class="line"><span class="comment">// 除非使用 save() 和 restore() 来回档到 clip() 之前</span></span><br><span class="line">ctx.<span class="property">fillStyle</span> = <span class="string">&quot;green&quot;</span>;</span><br><span class="line">ctx.<span class="title function_">fill</span>();</span><br></pre></td></tr></table></figure></div>

<h1 id="存档和回档"><a href="#存档和回档" class="headerlink" title="存档和回档"></a>存档和回档</h1><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">保存当前ctx的所有状态，</span></span><br><span class="line"><span class="comment">当调用该方法时，此刻所有的变换矩阵、剪切区域、画笔样式（strokeStyle、fillStyle、lineWidth、lineCap、lineJoin等）、</span></span><br><span class="line"><span class="comment">字体样式（font、textAlign、textBaseline等）以及所有路径等都会被保存下来，直到调用restore()时回档</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">ctx.<span class="title function_">save</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">恢复到最近一次save()的存档</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">ctx.<span class="title function_">restore</span>();</span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://blog.csdn.net/a460550542/article/details/124821248" >Canvas 绘制虚线 setLineDash 方法说明 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>特效</tag>
        <tag>canvas</tag>
      </tags>
  </entry>
  <entry>
    <title>css父元素选择器</title>
    <url>/2023/05/18/css%E7%88%B6%E5%85%83%E7%B4%A0%E9%80%89%E6%8B%A9%E5%99%A8/</url>
    <content><![CDATA[<p>今天发现一个css父选择器写法</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.wrapper</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">2px</span> solid green;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.inner</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">2px</span> solid blue;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.heart</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">2px</span> solid red;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="comment">/* 父选择器，选择了.inner元素的父元素.wrapper */</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.wrapper</span><span class="selector-pseudo">:has</span>(<span class="selector-class">.inner</span>) &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border-top-left-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="comment">/* 链式调用，实现祖先选择器 */</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.wrapper</span><span class="selector-pseudo">:has</span>(<span class="selector-class">.inner</span>)<span class="selector-pseudo">:has</span>(<span class="selector-class">.heart</span>) &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border-bottom-right-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;heart&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
      </tags>
  </entry>
  <entry>
    <title>git回退版本</title>
    <url>/2024/10/14/git%E5%9B%9E%E9%80%80%E7%89%88%E6%9C%AC/</url>
    <content><![CDATA[<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看历史提交的HASH记录</span></span><br><span class="line">git <span class="built_in">log</span> --oneline</span><br><span class="line"></span><br><span class="line"><span class="comment"># 回退到指定Commit记录</span></span><br><span class="line"><span class="comment"># --soft: 将之后提交的修改保留到暂存区</span></span><br><span class="line">git reset --soft HASH</span><br><span class="line"><span class="comment"># --mixed: 将之后提交的修改保留到暂存区和工作区</span></span><br><span class="line">git reset --mixed HASH</span><br><span class="line"><span class="comment"># --hard: 将之后提交的修改直接丢弃（注意这将会丢失所有自回滚点以来的修改）</span></span><br><span class="line">git reset --hard HASH</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>版本管理工具</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>git删除文件的跟踪</title>
    <url>/2024/09/23/git%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E7%9A%84%E8%B7%9F%E8%B8%AA/</url>
    <content><![CDATA[<p>当不需要跟踪某个文件时，可以使用以下命令来移除文件跟踪</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 移除跟踪 example.txt 文件</span></span><br><span class="line">git <span class="built_in">rm</span> --cached example.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移除跟踪多个文件</span></span><br><span class="line">git <span class="built_in">rm</span> --cached file1 file2 file3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移除跟踪整个文件夹，-r表示递归</span></span><br><span class="line">git <span class="built_in">rm</span> --cached -r folder/</span><br></pre></td></tr></table></figure></div>

<p>移除完毕后，需要提交更改，<br>提交更改后，文件将不再被跟踪，并且不会出现在版本控制中。</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>版本管理工具</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo配置about、categories和tags</title>
    <url>/2023/02/03/hexo%E9%85%8D%E7%BD%AEabout%E3%80%81categories%E5%92%8Ctags/</url>
    <content><![CDATA[<p>本来照着官网把hexo博客给搭建好了，但是官网居然没有告诉应该怎么配置about、categories和tags。。。<br>没办法，只有自己去解决问题了~  </p>
<span id="more"></span>

<hr>
<h2 id="about"><a href="#about" class="headerlink" title="about"></a>about</h2><p>这个比较好处理</p>
<p>如果是全局安装的hexo，可以执行下面的命令</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page <span class="string">&quot;about&quot;</span></span><br></pre></td></tr></table></figure></div>
<p>如果是局部安装的，可以像这样写</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">npx hexo new page <span class="string">&quot;about&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>然后就会自动生成 source&#x2F;about&#x2F;index.md 文件，后面就可以像编辑博客一样编辑它了~</p>
<hr>
<h2 id="categories"><a href="#categories" class="headerlink" title="categories"></a>categories</h2><p>这个目录的创建和about一致，向下面这样写就行</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page <span class="string">&quot;categories&quot;</span></span><br></pre></td></tr></table></figure></div>
<p>或</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">npx hexo new page <span class="string">&quot;categories&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>然后才是重要的，想要使用categories的功能，需要修改自动生成的 &#x2F;source&#x2F;categories&#x2F;index.md 文件，将其内容修改为下面内容</p>
<div class="highlight-container" data-rel="Markdown"><figure class="iseeu highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories</span><br><span class="line">type: &quot;categories&quot;</span><br><span class="line"><span class="section">layout: &quot;categories&quot;</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></div>

<p>然后新建一个博客文件</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new <span class="string">&#x27;测试categories&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>将该博客文件的初始内容改为</p>
<div class="highlight-container" data-rel="Markdown"><figure class="iseeu highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 测试categories</span><br><span class="line">categories:</span><br><span class="line"><span class="section">- 分类1</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></div>

<p>这样新建的博客就会自动被分类到 “分类1” 中去了~</p>
<p>如果想要给一篇博客多个分类可以这样写</p>
<div class="highlight-container" data-rel="Markdown"><figure class="iseeu highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 测试categories</span><br><span class="line">categories:</span><br><span class="line"><span class="bullet">-</span> [分类1]</span><br><span class="line"><span class="bullet">-</span> [分类2]</span><br><span class="line"><span class="section">- [分类3]</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></div>

<p><em>千万不要忘了中括号，没有中括号会变成 分类1的子分类2的子分类3</em></p>
<hr>
<h2 id="tags"><a href="#tags" class="headerlink" title="tags"></a>tags</h2><p>这个目录的创建以及功能的实现和categories一致，只要改个名字就好了~</p>
<p>第一步创建目录</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page <span class="string">&quot;tags&quot;</span></span><br></pre></td></tr></table></figure></div>
<p>或</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">npx hexo new page <span class="string">&quot;tags&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>第二步修改文件<br>修改 &#x2F;source&#x2F;tags&#x2F;index.md 文件，使用下面的内容覆盖原本内容</p>
<div class="highlight-container" data-rel="Markdown"><figure class="iseeu highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">type: &quot;tags&quot;</span><br><span class="line"><span class="section">layout: &quot;tags&quot;</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></div>

<p>第三步创建博客</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new <span class="string">&#x27;测试tags&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>第四步修改博客初始内容，使用下面内容覆盖它</p>
<div class="highlight-container" data-rel="Markdown"><figure class="iseeu highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 测试tags</span><br><span class="line">tags:</span><br><span class="line"><span class="bullet">-</span> 标签1</span><br><span class="line"><span class="section">- 标签2</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></div>

<p>这样就可以给博客添加 “标签1” 和 “标签2” 了，tags功能不用考虑中括号[].</p>
<hr>
<p>其实官网有说关于<a class="link"   href="https://hexo.io/zh-cn/docs/commands#new" >目录处理 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>的问题，但是说的很不清晰</p>
<blockquote>
<p>默认情况下，Hexo 会使用文章的标题来决定文章文件的路径。对于独立页面来说，Hexo 会创建一个以标题为名字的目录，并在目录中放置一个 index.md 文件。</p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>搭建博客</tag>
      </tags>
  </entry>
  <entry>
    <title>javasSript小数相加精度问题</title>
    <url>/2023/02/24/javasSript%E5%B0%8F%E6%95%B0%E7%9B%B8%E5%8A%A0%E7%B2%BE%E5%BA%A6%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>众所周知，在 javasSript 中 0.1 + 0.3 会出现精度问题，那么其他小数相加会不会也有问题呢？还有相乘呢？<br>测试用代码和结果如下</p>
<span id="more"></span>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 相加的精度问题</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.3</span>, <span class="number">0.4</span>, <span class="number">0.5</span>, <span class="number">0.6</span>, <span class="number">0.7</span>, <span class="number">0.8</span>, <span class="number">0.9</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">let</span> val1 = arr[i];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = i; j &lt; arr.<span class="property">length</span>; j++) &#123;</span><br><span class="line">    <span class="keyword">let</span> val2 = arr[j];</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;val1&#125;</span> + <span class="subst">$&#123;val2&#125;</span> = <span class="subst">$&#123;val1 + val2&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0.1 + 0.1 = 0.2</span></span><br><span class="line"><span class="comment">// 0.1 + 0.2 = 0.30000000000000004</span></span><br><span class="line"><span class="comment">// 0.1 + 0.3 = 0.4</span></span><br><span class="line"><span class="comment">// 0.1 + 0.4 = 0.5</span></span><br><span class="line"><span class="comment">// 0.1 + 0.5 = 0.6</span></span><br><span class="line"><span class="comment">// 0.1 + 0.6 = 0.7</span></span><br><span class="line"><span class="comment">// 0.1 + 0.7 = 0.7999999999999999</span></span><br><span class="line"><span class="comment">// 0.1 + 0.8 = 0.9</span></span><br><span class="line"><span class="comment">// 0.1 + 0.9 = 1</span></span><br><span class="line"><span class="comment">// 0.2 + 0.2 = 0.4</span></span><br><span class="line"><span class="comment">// 0.2 + 0.3 = 0.5</span></span><br><span class="line"><span class="comment">// 0.2 + 0.4 = 0.6000000000000001</span></span><br><span class="line"><span class="comment">// 0.2 + 0.5 = 0.7</span></span><br><span class="line"><span class="comment">// 0.2 + 0.6 = 0.8</span></span><br><span class="line"><span class="comment">// 0.2 + 0.7 = 0.8999999999999999</span></span><br><span class="line"><span class="comment">// 0.2 + 0.8 = 1</span></span><br><span class="line"><span class="comment">// 0.2 + 0.9 = 1.1</span></span><br><span class="line"><span class="comment">// 0.3 + 0.3 = 0.6</span></span><br><span class="line"><span class="comment">// 0.3 + 0.4 = 0.7</span></span><br><span class="line"><span class="comment">// 0.3 + 0.5 = 0.8</span></span><br><span class="line"><span class="comment">// 0.3 + 0.6 = 0.8999999999999999</span></span><br><span class="line"><span class="comment">// 0.3 + 0.7 = 1</span></span><br><span class="line"><span class="comment">// 0.3 + 0.8 = 1.1</span></span><br><span class="line"><span class="comment">// 0.3 + 0.9 = 1.2</span></span><br><span class="line"><span class="comment">// 0.4 + 0.4 = 0.8</span></span><br><span class="line"><span class="comment">// 0.4 + 0.5 = 0.9</span></span><br><span class="line"><span class="comment">// 0.4 + 0.6 = 1</span></span><br><span class="line"><span class="comment">// 0.4 + 0.7 = 1.1</span></span><br><span class="line"><span class="comment">// 0.4 + 0.8 = 1.2000000000000002</span></span><br><span class="line"><span class="comment">// 0.4 + 0.9 = 1.3</span></span><br><span class="line"><span class="comment">// 0.5 + 0.5 = 1</span></span><br><span class="line"><span class="comment">// 0.5 + 0.6 = 1.1</span></span><br><span class="line"><span class="comment">// 0.5 + 0.7 = 1.2</span></span><br><span class="line"><span class="comment">// 0.5 + 0.8 = 1.3</span></span><br><span class="line"><span class="comment">// 0.5 + 0.9 = 1.4</span></span><br><span class="line"><span class="comment">// 0.6 + 0.6 = 1.2</span></span><br><span class="line"><span class="comment">// 0.6 + 0.7 = 1.2999999999999998</span></span><br><span class="line"><span class="comment">// 0.6 + 0.8 = 1.4</span></span><br><span class="line"><span class="comment">// 0.6 + 0.9 = 1.5</span></span><br><span class="line"><span class="comment">// 0.7 + 0.7 = 1.4</span></span><br><span class="line"><span class="comment">// 0.7 + 0.8 = 1.5</span></span><br><span class="line"><span class="comment">// 0.7 + 0.9 = 1.6</span></span><br><span class="line"><span class="comment">// 0.8 + 0.8 = 1.6</span></span><br><span class="line"><span class="comment">// 0.8 + 0.9 = 1.7000000000000002</span></span><br><span class="line"><span class="comment">// 0.9 + 0.9 = 1.8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 相乘也会出现精度问题</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.3</span>, <span class="number">0.4</span>, <span class="number">0.5</span>, <span class="number">0.6</span>, <span class="number">0.7</span>, <span class="number">0.8</span>, <span class="number">0.9</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">let</span> val1 = arr[i];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = i; j &lt; arr.<span class="property">length</span>; j++) &#123;</span><br><span class="line">    <span class="keyword">let</span> val2 = arr[j];</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;val1&#125;</span> * <span class="subst">$&#123;val2&#125;</span> = <span class="subst">$&#123;val1 * val2&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0.1 * 0.1 = 0.010000000000000002</span></span><br><span class="line"><span class="comment">// 0.1 * 0.2 = 0.020000000000000004</span></span><br><span class="line"><span class="comment">// 0.1 * 0.3 = 0.03</span></span><br><span class="line"><span class="comment">// 0.1 * 0.4 = 0.04000000000000001</span></span><br><span class="line"><span class="comment">// 0.1 * 0.5 = 0.05</span></span><br><span class="line"><span class="comment">// 0.1 * 0.6 = 0.06</span></span><br><span class="line"><span class="comment">// 0.1 * 0.7 = 0.06999999999999999</span></span><br><span class="line"><span class="comment">// 0.1 * 0.8 = 0.08000000000000002</span></span><br><span class="line"><span class="comment">// 0.1 * 0.9 = 0.09000000000000001</span></span><br><span class="line"><span class="comment">// 0.2 * 0.2 = 0.04000000000000001</span></span><br><span class="line"><span class="comment">// 0.2 * 0.3 = 0.06</span></span><br><span class="line"><span class="comment">// 0.2 * 0.4 = 0.08000000000000002</span></span><br><span class="line"><span class="comment">// 0.2 * 0.5 = 0.1</span></span><br><span class="line"><span class="comment">// 0.2 * 0.6 = 0.12</span></span><br><span class="line"><span class="comment">// 0.2 * 0.7 = 0.13999999999999999</span></span><br><span class="line"><span class="comment">// 0.2 * 0.8 = 0.16000000000000003</span></span><br><span class="line"><span class="comment">// 0.2 * 0.9 = 0.18000000000000002</span></span><br><span class="line"><span class="comment">// 0.3 * 0.3 = 0.09</span></span><br><span class="line"><span class="comment">// 0.3 * 0.4 = 0.12</span></span><br><span class="line"><span class="comment">// 0.3 * 0.5 = 0.15</span></span><br><span class="line"><span class="comment">// 0.3 * 0.6 = 0.18</span></span><br><span class="line"><span class="comment">// 0.3 * 0.7 = 0.21</span></span><br><span class="line"><span class="comment">// 0.3 * 0.8 = 0.24</span></span><br><span class="line"><span class="comment">// 0.3 * 0.9 = 0.27</span></span><br><span class="line"><span class="comment">// 0.4 * 0.4 = 0.16000000000000003</span></span><br><span class="line"><span class="comment">// 0.4 * 0.5 = 0.2</span></span><br><span class="line"><span class="comment">// 0.4 * 0.6 = 0.24</span></span><br><span class="line"><span class="comment">// 0.4 * 0.7 = 0.27999999999999997</span></span><br><span class="line"><span class="comment">// 0.4 * 0.8 = 0.32000000000000006</span></span><br><span class="line"><span class="comment">// 0.4 * 0.9 = 0.36000000000000004</span></span><br><span class="line"><span class="comment">// 0.5 * 0.5 = 0.25</span></span><br><span class="line"><span class="comment">// 0.5 * 0.6 = 0.3</span></span><br><span class="line"><span class="comment">// 0.5 * 0.7 = 0.35</span></span><br><span class="line"><span class="comment">// 0.5 * 0.8 = 0.4</span></span><br><span class="line"><span class="comment">// 0.5 * 0.9 = 0.45</span></span><br><span class="line"><span class="comment">// 0.6 * 0.6 = 0.36</span></span><br><span class="line"><span class="comment">// 0.6 * 0.7 = 0.42</span></span><br><span class="line"><span class="comment">// 0.6 * 0.8 = 0.48</span></span><br><span class="line"><span class="comment">// 0.6 * 0.9 = 0.54</span></span><br><span class="line"><span class="comment">// 0.7 * 0.7 = 0.48999999999999994</span></span><br><span class="line"><span class="comment">// 0.7 * 0.8 = 0.5599999999999999</span></span><br><span class="line"><span class="comment">// 0.7 * 0.9 = 0.63</span></span><br><span class="line"><span class="comment">// 0.8 * 0.8 = 0.6400000000000001</span></span><br><span class="line"><span class="comment">// 0.8 * 0.9 = 0.7200000000000001</span></span><br><span class="line"><span class="comment">// 0.9 * 0.9 = 0.81</span></span><br></pre></td></tr></table></figure></div>

<h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><h2 id="Number-EPSILON-解决相等判断的问题"><a href="#Number-EPSILON-解决相等判断的问题" class="headerlink" title="Number.EPSILON 解决相等判断的问题"></a>Number.EPSILON 解决相等判断的问题</h2><p>如何解决 0.1 + 0.2 !&#x3D;&#x3D; 0.3 的问题呢？</p>
<p>Number.EPSILON 是 es6 中新增的一个常量，用来表示一个最小的浮点数，这个值是 2 的-52 次方，也就是 2 的-52 次方的值，这个值可以用来判断两个浮点数是否相等。</p>
<p>所以可以自己实现一个判断浮点数相等的方法，如下：</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义判断浮点数相等的方法，对于精度要求较高的浮点数相等的方法，可以使用这个方法替代“===”</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isEqual</span>(<span class="params">num1, num2</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">abs</span>(num1 - num2) &lt; <span class="title class_">Number</span>.<span class="property">EPSILON</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0.1</span> + <span class="number">0.2</span> === <span class="number">0.3</span>); <span class="comment">// false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isEqual</span>(<span class="number">0.1</span> + <span class="number">0.2</span>, <span class="number">0.3</span>)); <span class="comment">// true</span></span><br></pre></td></tr></table></figure></div>

<p><em>目前该方法只能用作判断相等，不能让浮点数相加后的结果等于期望结果，如果需要浮点数相加后的结果等于期望结果，可以使用第三方库，比如 mathjs 库。</em></p>
<h2 id="解决浮点数相互计算的问题"><a href="#解决浮点数相互计算的问题" class="headerlink" title="解决浮点数相互计算的问题"></a>解决浮点数相互计算的问题</h2><p>可以通过乘以一个倍数，去掉小数，然后相加，再除以这个倍数，来还原浮点数。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">num1, num2</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> multiple = <span class="number">10</span> ** <span class="number">6</span>; <span class="comment">// 这个值任意取，只要可以将小数去掉即可</span></span><br><span class="line">  <span class="keyword">return</span> (num1 * multiple + num2 * multiple) / multiple;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0.1</span> + <span class="number">0.2</span>); <span class="comment">// 0.30000000000000004</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">0.1</span>, <span class="number">0.2</span>)); <span class="comment">// 0.3</span></span><br></pre></td></tr></table></figure></div>

<h2 id="使用第三方库"><a href="#使用第三方库" class="headerlink" title="使用第三方库"></a>使用第三方库</h2><p>最好的办法其实还是使用第三方库。不用自己造轮子，省时省精力还不易出错。</p>
<h3 id="mathjs"><a href="#mathjs" class="headerlink" title="mathjs"></a>mathjs</h3><p><a class="link"   href="https://mathjs.org/" >mathjs 官网 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.npmjs.com/package/mathjs" >mathjs npm <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">npm i mathjs</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> mathjs = <span class="built_in">require</span>(<span class="string">&quot;mathjs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相加</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a1 = <span class="number">0.1</span> + <span class="number">0.2</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;原生相加结果：&quot;</span>, a1); <span class="comment">// 0.30000000000000004</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a2 = <span class="built_in">parseFloat</span>(mathjs.<span class="title function_">add</span>(mathjs.<span class="title function_">bignumber</span>(<span class="number">0.1</span>), mathjs.<span class="title function_">bignumber</span>(<span class="number">0.2</span>)));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;mathjs相加结果：&quot;</span>, a2); <span class="comment">// 0.3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 相乘</span></span><br><span class="line"><span class="keyword">let</span> b1 = <span class="number">0.1</span> * <span class="number">0.1</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;原生相乘结果：&quot;</span>, b1); <span class="comment">// 0.010000000000000002</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b2 = <span class="built_in">parseFloat</span>(</span><br><span class="line">  mathjs.<span class="title function_">multiply</span>(mathjs.<span class="title function_">bignumber</span>(<span class="number">0.1</span>), mathjs.<span class="title function_">bignumber</span>(<span class="number">0.1</span>))</span><br><span class="line">);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;mathjs相乘结果：&quot;</span>, b2); <span class="comment">// 0.01</span></span><br></pre></td></tr></table></figure></div>

<h3 id="decimal-js"><a href="#decimal-js" class="headerlink" title="decimal.js"></a>decimal.js</h3><p><a class="link"   href="https://mikemcl.github.io/decimal.js/" >decimal.js 官网 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.npmjs.com/package/decimal.js" >decimal.js npm <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">npm i decimal.js</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Decimal</span> = <span class="built_in">require</span>(<span class="string">&quot;decimal.js&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相加</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a1 = <span class="number">0.1</span> + <span class="number">0.2</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;原生相加结果：&quot;</span>, a1); <span class="comment">// 0.30000000000000004</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a2 = <span class="built_in">parseFloat</span>(<span class="keyword">new</span> <span class="title class_">Decimal</span>(<span class="number">0.1</span>).<span class="title function_">plus</span>(<span class="number">0.2</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;decimal.js相加结果：&quot;</span>, a2); <span class="comment">// 0.3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 相乘</span></span><br><span class="line"><span class="keyword">let</span> b1 = <span class="number">0.1</span> * <span class="number">0.1</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;原生相乘结果：&quot;</span>, b1); <span class="comment">// 0.6000000000000001</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b2 = <span class="built_in">parseFloat</span>(<span class="keyword">new</span> <span class="title class_">Decimal</span>(<span class="number">0.1</span>).<span class="title function_">times</span>(<span class="number">0.1</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;mathjs相乘结果：&quot;</span>, b2); <span class="comment">// 0.01</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>js深拷贝</title>
    <url>/2024/10/29/js%E6%B7%B1%E6%8B%B7%E8%B4%9D/</url>
    <content><![CDATA[<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 克隆一个对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">obj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">clone</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> cloneObj;</span><br><span class="line">  <span class="comment">// 优先尝试 structuredClone，失败后再使用 JSON.parse(JSON.stringify())</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    cloneObj = <span class="title function_">structuredClone</span>(obj);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    cloneObj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cloneObj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>javascript 深拷贝一般要涉及到函数递归操作，和掌握各种基本类型和引用类型，还有考虑递归引用等问题。</p>
<p>如果单纯为了实用性，上面这个实现就是最好的了。</p>
<p>以后有时间再搞一个看着牛逼的版本。</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>nodejs常用文件操作</title>
    <url>/2024/10/28/nodejs%E5%B8%B8%E7%94%A8%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<h1 id="简单文件操作"><a href="#简单文件操作" class="headerlink" title="简单文件操作"></a>简单文件操作</h1><p>如果是要操作体积很大的文件，建议参考章节<a href="#%E4%BC%A0%E7%BB%9F%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C">传统文件操作</a>。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步读取文件内容（如果指定了编码，则返回字符串，否则返回一个Buffer对象）</span></span><br><span class="line"><span class="keyword">const</span> fileContent = fs.<span class="title function_">readFileSync</span>(<span class="string">&quot;./file.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fileContent);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步读取文件内容（如果指定了编码，则返回字符串，否则返回一个Buffer对象）</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&quot;./file.txt&quot;</span>, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">err, fileContent</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(fileContent);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步写入文件内容（默认覆盖文件，不存在则创建）</span></span><br><span class="line">fs.<span class="title function_">writeFileSync</span>(<span class="string">&quot;./file.txt&quot;</span>, <span class="string">&quot;hello world sync&quot;</span>, <span class="string">&quot;utf8&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步写入文件内容（默认覆盖文件，不存在则创建）</span></span><br><span class="line">fs.<span class="title function_">writeFile</span>(<span class="string">&quot;./file.txt&quot;</span>, <span class="string">&quot;hello world async&quot;</span>, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步追加文件内容</span></span><br><span class="line">fs.<span class="title function_">appendFileSync</span>(<span class="string">&quot;./file.txt&quot;</span>, <span class="string">&quot;hello world append sync&quot;</span>, <span class="string">&quot;utf8&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步追加文件内容</span></span><br><span class="line">fs.<span class="title function_">appendFile</span>(<span class="string">&quot;./file.txt&quot;</span>, <span class="string">&quot;hello world append async&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步删除文件</span></span><br><span class="line">fs.<span class="title function_">unlinkSync</span>(<span class="string">&quot;./file.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步删除文件</span></span><br><span class="line">fs.<span class="title function_">unlink</span>(<span class="string">&quot;./file.txt&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步创建文件夹</span></span><br><span class="line">fs.<span class="title function_">mkdirSync</span>(<span class="string">&quot;./dir&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步创建文件夹</span></span><br><span class="line">fs.<span class="title function_">mkdir</span>(<span class="string">&quot;./dir&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h1 id="递归遍历文件夹"><a href="#递归遍历文件夹" class="headerlink" title="递归遍历文件夹"></a>递归遍历文件夹</h1><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 递归遍历文件夹（同步）</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">folderRecursionSync</span>(<span class="params">pathName, callback</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> pathStat = fs.<span class="title function_">statSync</span>(pathName);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> pathInfo = &#123;</span><br><span class="line">    <span class="comment">// 获取路径信息</span></span><br><span class="line">    <span class="comment">// pathStat,</span></span><br><span class="line">    <span class="comment">// 是否是文件</span></span><br><span class="line">    <span class="comment">// isFile: pathStat.isFile(),</span></span><br><span class="line">    <span class="comment">// 是否是文件夹</span></span><br><span class="line">    <span class="attr">isDirectory</span>: pathStat.<span class="title function_">isDirectory</span>(),</span><br><span class="line">    <span class="comment">// 获取相对路径</span></span><br><span class="line">    <span class="attr">relativePathName</span>: pathName,</span><br><span class="line">    <span class="comment">// 获取绝对路径</span></span><br><span class="line">    <span class="attr">absolutePathName</span>: path.<span class="title function_">resolve</span>(pathName),</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">callback</span>(pathInfo);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (pathInfo.<span class="property">isDirectory</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> _pathNames = fs.<span class="title function_">readdirSync</span>(pathName); <span class="comment">// 获取文件夹下的所有文件名</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> _pathName <span class="keyword">of</span> _pathNames) &#123;</span><br><span class="line">      <span class="title function_">folderRecursionSync</span>(path.<span class="title function_">join</span>(pathName, _pathName), callback);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 递归遍历文件夹（异步）</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">folderRecursion</span>(<span class="params">pathName, callback</span>) &#123;</span><br><span class="line">  fs.<span class="title function_">stat</span>(pathName, <span class="function">(<span class="params">err, pathStat</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">    <span class="keyword">const</span> pathInfo = &#123;</span><br><span class="line">      <span class="comment">// 获取路径信息</span></span><br><span class="line">      <span class="comment">// pathStat,</span></span><br><span class="line">      <span class="comment">// 是否是文件</span></span><br><span class="line">      <span class="comment">// isFile: pathStat.isFile(),</span></span><br><span class="line">      <span class="comment">// 是否是文件夹</span></span><br><span class="line">      <span class="attr">isDirectory</span>: pathStat.<span class="title function_">isDirectory</span>(),</span><br><span class="line">      <span class="comment">// 获取相对路径</span></span><br><span class="line">      <span class="attr">relativePathName</span>: pathName,</span><br><span class="line">      <span class="comment">// 获取绝对路径</span></span><br><span class="line">      <span class="attr">absolutePathName</span>: path.<span class="title function_">resolve</span>(pathName),</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">callback</span>(pathInfo);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pathInfo.<span class="property">isDirectory</span>) &#123;</span><br><span class="line">      fs.<span class="title function_">readdir</span>(pathName, <span class="function">(<span class="params">err, _pathNames</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 获取文件夹下的所有文件名</span></span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> _pathName <span class="keyword">of</span> _pathNames) &#123;</span><br><span class="line">          <span class="title function_">folderRecursion</span>(path.<span class="title function_">join</span>(pathName, _pathName), callback);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="传统文件操作"><a href="#传统文件操作" class="headerlink" title="传统文件操作"></a>传统文件操作</h1><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建文件流对象（读）</span></span><br><span class="line"><span class="keyword">const</span> rs = fs.<span class="title function_">createReadStream</span>(<span class="string">&quot;./file.txt&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">encoding</span>: <span class="string">&quot;utf8&quot;</span>, <span class="comment">// 设置编码格式，设置了后，on(&#x27;data&#x27;)返回的都是String，否则是Buffer</span></span><br><span class="line">  <span class="comment">// flags: &#x27;r&#x27;, // 设置文件打开的方式，默认是r</span></span><br><span class="line">  <span class="comment">// start: 10, // 设置读取的起始位置</span></span><br><span class="line">  <span class="comment">// end: 20, // 设置读取的结束位置</span></span><br><span class="line">  <span class="comment">// mode: 0o666, // 设置读取文件模式，4：可读，2：可写，1：可执行</span></span><br><span class="line">  <span class="comment">// highWaterMark: 10, // 设置每次on(&#x27;data&#x27;)读取的字节数</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">let</span> fileContent = <span class="string">&quot;&quot;</span>;</span><br><span class="line">rs.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="function">(<span class="params">chunk</span>) =&gt;</span> &#123;</span><br><span class="line">  fileContent += chunk;</span><br><span class="line">&#125;);</span><br><span class="line">rs.<span class="title function_">on</span>(<span class="string">&quot;open&quot;</span>, <span class="function">(<span class="params">fd</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始读取文件&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">rs.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;文件已全部读取完毕，文件内容：&quot;</span>, fileContent.<span class="title function_">toString</span>());</span><br><span class="line">&#125;);</span><br><span class="line">rs.<span class="title function_">on</span>(<span class="string">&quot;close&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;文件被关闭&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">rs.<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;读取文件失败&quot;</span>, err);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建文件流对象（写）</span></span><br><span class="line"><span class="keyword">const</span> ws = fs.<span class="title function_">createWriteStream</span>(<span class="string">&quot;./file.txt&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">encoding</span>: <span class="string">&quot;utf8&quot;</span>, <span class="comment">// 设置编码格式</span></span><br><span class="line">  <span class="comment">// flags: &#x27;a&#x27;, // 设置写入文件的方式，默认是w，a是追加</span></span><br><span class="line">  <span class="comment">// mode: 0o666, // 设置写入文件的权限，4：可读，2：可写，1：可执行</span></span><br><span class="line">  <span class="comment">// start: 10, // 设置写入的起始位置</span></span><br><span class="line">  <span class="comment">// highWaterMark: 3, // 设置每次写入的字节数</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">write</span>(<span class="string">&quot;hello world1&quot;</span>); <span class="comment">// 如果没有设置encoding，可以传入一个Buffer</span></span><br><span class="line">ws.<span class="title function_">end</span>(<span class="string">&quot;hello world2&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;文件写入完毕，写入数量：&quot;</span>, ws.<span class="property">bytesWritten</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&quot;open&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;文件被打开了&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&quot;close&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;文件被关闭了&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&quot;drain&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;写入数据超过highWaterMark，暂停写入&quot;</span>); <span class="comment">// 但是本次写入是可以成功的</span></span><br><span class="line">&#125;);</span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;写入文件失败&quot;</span>, err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h1 id="Buffer"><a href="#Buffer" class="headerlink" title="Buffer"></a>Buffer</h1><p>在读写文件时，如果不指定编码，则默认操作二进制对象 Buffer。<br>Buffer 是一个类数组对象，其存放一定长度的字节序列。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Buffer</span></span><br><span class="line"><span class="keyword">let</span> buf1 = fs.<span class="title function_">readFileSync</span>(<span class="string">&quot;file.obj&quot;</span>); <span class="comment">// 从二进制文件创建，不指定encoding</span></span><br><span class="line"><span class="keyword">let</span> buf2 = <span class="title class_">Buffer</span>.<span class="title function_">alloc</span>(<span class="number">1024</span>); <span class="comment">// 指定长度创建空Buffer：&lt;Buffer 00 00 00 …… 一共1024个00&gt;</span></span><br><span class="line"><span class="keyword">let</span> buf3 = <span class="title class_">Buffer</span>.<span class="title function_">from</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">255</span>, <span class="number">256</span>]); <span class="comment">// 从十进制数组创建，这里每个元素不能超过一个字节（256），否则会溢出：&lt;Buffer 01 02 08 10 ff 00&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// String转Buffer</span></span><br><span class="line"><span class="keyword">let</span> buf4 = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(<span class="string">&quot;hello world&quot;</span>, <span class="string">&quot;utf8&quot;</span>); <span class="comment">// &lt;Buffer 68 65 6c 6c 6f 20 77 6f 72 6c 64&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Buffer转String</span></span><br><span class="line"><span class="keyword">let</span> str1 = buf3.<span class="title function_">toString</span>(<span class="string">&quot;hex&quot;</span>); <span class="comment">// 将Buffer转为16进制字符串：&#x27;01020810ff00&#x27;</span></span><br><span class="line"><span class="keyword">let</span> str2 = buf3.<span class="title function_">toString</span>(<span class="string">&quot;utf8&quot;</span>); <span class="comment">// 将Buffer转为utf8字符串，可能会乱码</span></span><br><span class="line"><span class="keyword">let</span> str3 = buf4.<span class="title function_">toString</span>(<span class="string">&quot;hex&quot;</span>); <span class="comment">// &#x27;68656c6c6f20776f726c64&#x27;</span></span><br><span class="line"><span class="keyword">let</span> str4 = buf4.<span class="title function_">toString</span>(<span class="string">&quot;utf8&quot;</span>); <span class="comment">// &#x27;hello world&#x27;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://blog.csdn.net/qq_45040919/article/details/109751579" >Node.js 中的 fs 模块（三） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://blog.csdn.net/aaaa_aaab/article/details/141208412" >【Nodejs】一、Buffer（缓冲器）学习 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>文件系统</tag>
        <tag>Node.js</tag>
      </tags>
  </entry>
  <entry>
    <title>nodejs爬虫</title>
    <url>/2023/12/05/nodejs%E7%88%AC%E8%99%AB/</url>
    <content><![CDATA[<p>起因是花钱买了一个服务器，又没什么重要服务需要跑，所以就做了一个爬虫，爬取我自己在github page上的博客，方便国内访问，也顺便学习一下爬虫。</p>
<p>我这个爬虫的逻辑是通过访问网站根目录的index.html文件，然后解析出文件中所有的引用的本站的url，包括html、css、js等文件，然后再递归访问这些url，最后将所有触及到的文件结构化地保存到本地。</p>
<p><a class="link"   href="https://github.com/GJYyyyy/webCrawler" >github地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Node.js</tag>
        <tag>爬虫</tag>
      </tags>
  </entry>
  <entry>
    <title>uniapp自定义picker</title>
    <url>/2024/06/05/uniapp%E8%87%AA%E5%AE%9A%E4%B9%89picker/</url>
    <content><![CDATA[<p>这事的起因是领导让我接手一个 uniapp 的项目的开发，<br>开发期间我用 <a class="link"   href="https://uniapp.dcloud.net.cn/component/picker.html" >picker <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 组件做了<strong>弹出选择框</strong>，但是领导说要修改一个按钮里的文字颜色，</p>
<p><strong>很明显，使用 <a class="link"   href="https://uniapp.dcloud.net.cn/component/picker.html" >picker <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 是改不了这种细致入微的样式的</strong>，</p>
<p>所以干脆自己做一个<strong>弹出选择框</strong>，利用 <a class="link"   href="https://uniapp.dcloud.net.cn/component/picker-view.html" >picker-view <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 的高灵活性，以及 <a class="link"   href="https://uniapp.dcloud.net.cn/component/uniui/uni-popup.html" >uni-popup <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 的弹框功能来开发。</p>
<p>因为我们公司的设计师傅名字首字母拼音是<strong>zh</strong>，所以这个自定义组件就叫<strong>zh-picker</strong>。</p>
<p>由于是为了替换 <a class="link"   href="https://uniapp.dcloud.net.cn/component/picker.html" >picker <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 组件，所以 <strong>zh-picker</strong> 和 <a class="link"   href="https://uniapp.dcloud.net.cn/component/picker.html" >picker <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 用法都差不多。</p>
<p>上代码</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;zh-picker&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;slot&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;openPicker&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uni-popup</span> <span class="attr">ref</span>=<span class="string">&quot;popup&quot;</span> <span class="attr">type</span>=<span class="string">&quot;bottom&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;onPopupChange&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;popup&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;actions&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cancel&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;onCancel&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;sure&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;onSure&quot;</span>&gt;</span>完成<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">picker-view</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;picker-view&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:value</span>=<span class="string">&quot;indexs&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">change</span>=<span class="string">&quot;onPickerViewChange&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">picker-view-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">v-for</span>=<span class="string">&quot;(item,index) in range&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span>&#123;&#123;getText(item)&#125;&#125;&lt;/view</span><br><span class="line">            &gt;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">picker-view-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">picker-view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">uni-popup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&quot;zh-picker&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">range</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="function">() =&gt;</span> [],</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">rangeText</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="string">&quot;text&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">visible</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">indexs</span>: [<span class="number">0</span>],</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">openPicker</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">popup</span>.<span class="title function_">open</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">onPopupChange</span>(<span class="params">&#123; show &#125;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">visible</span> = show;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">getText</span>(<span class="params">item</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (item[<span class="variable language_">this</span>.<span class="property">rangeText</span>]) <span class="keyword">return</span> item[<span class="variable language_">this</span>.<span class="property">rangeText</span>];</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(item);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">onPickerViewChange</span>(<span class="params">ev</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">indexs</span> = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(ev.<span class="property">detail</span>.<span class="property">value</span>));</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">onSure</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> _ev = &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">detail</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// picker-view是可以多列同时选择的，但此处只需要一列，所以只取ev.detail.value[0]</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">value</span>: <span class="variable language_">this</span>.<span class="property">indexs</span>[<span class="number">0</span>],</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$emit(<span class="string">&quot;change&quot;</span>, _ev);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">popup</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">onCancel</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">popup</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.zh-picker</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.popup</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-top-left-radius</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-top-right-radius</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: white;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      &gt; <span class="selector-class">.actions</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        &amp;<span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">height</span>: <span class="number">1px</span>;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">clear</span>: both;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#e5e5e5</span>;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">color</span>: <span class="number">#e5e5e5</span>;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">transform-origin</span>: <span class="number">0</span> <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">transform</span>: <span class="built_in">scaleY</span>(<span class="number">0.5</span>);</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        &gt; view &#123;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">width</span>: <span class="number">120</span>rpx;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">height</span>: <span class="number">90</span>rpx;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">line-height</span>: <span class="number">90</span>rpx;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">font-size</span>: <span class="number">34</span>rpx;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">          &amp;<span class="selector-class">.cancel</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="number">#888</span>;</span></span><br><span class="line"><span class="language-css">          &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">          &amp;<span class="selector-class">.sure</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="number">#30ac8f</span>;</span></span><br><span class="line"><span class="language-css">          &#125;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.picker-view</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">750</span>rpx;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">30vh</span>;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">          <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>最后，用这个组件 <strong>zh-picker</strong> ，你想改哪里的样式都能改了。</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>uniapp</tag>
      </tags>
  </entry>
  <entry>
    <title>git分支的新建与合并</title>
    <url>/2024/06/01/git%E5%88%86%E6%94%AF%E7%9A%84%E6%96%B0%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6/</url>
    <content><![CDATA[<p>查漏补缺系列</p>
<span id="more"></span>

<h1 id="创建新分支"><a href="#创建新分支" class="headerlink" title="创建新分支"></a>创建新分支</h1><p>当需要开发新特性，又不想影响主分支的开发进度时，可以新建一个分支。</p>
<p><strong>在创建新分支前，请确保修改的文件都已经 <em>暂存</em> 或 <em>提交</em></strong></p>
<p><em>新分支会从当前分支已提交（commit）的文件中克隆出一个副本，即新分支本身</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建一个新分支</span></span><br><span class="line">git branch NEW_BRANCH_NAME</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到新创建的分支</span></span><br><span class="line">git checkout NEW_BRANCH_NAME</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者合并以上两步，创建并切换到新分支</span></span><br><span class="line">git checkout -b NEW_BRANCH_NAME</span><br></pre></td></tr></table></figure></div>

<h1 id="合并分支"><a href="#合并分支" class="headerlink" title="合并分支"></a>合并分支</h1><p>需要注意的是：</p>
<ul>
<li>新分支被合并到主分支后会一直保留，不会自动删除</li>
<li>且在主分支 push 时，不会自动 push 新分支到远端</li>
</ul>
<p>如果需要将新分支合并到主分支，操作如下。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 切换到主分支</span></span><br><span class="line">git checkout main</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并其他分支</span></span><br><span class="line"><span class="comment"># 将其他分支，例如NEW_BRANCH_NAME合并到当前分支（会自动commit）</span></span><br><span class="line">git merge NEW_BRANCH_NAME</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并其他分支</span></span><br><span class="line"><span class="comment"># 将其他分支，例如NEW_BRANCH_NAME合并到当前分支（不会自动commit，会将修改放到暂存区）</span></span><br><span class="line">git merge --no-commit NEW_BRANCH_NAME</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并其他分支的一个提交</span></span><br><span class="line"><span class="comment"># 不会合并其他分支的所有提交，仅合并指定的一个提交</span></span><br><span class="line">git cherry-pick COMMIT_HASH</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将新分支同步到远端</span></span><br><span class="line">git push --set-upstream origin NEW_BRANCH_NAME</span><br><span class="line"></span><br><span class="line"><span class="comment"># 推送本地所有分支到远端</span></span><br><span class="line">git push --all</span><br></pre></td></tr></table></figure></div>

<h1 id="删除分支"><a href="#删除分支" class="headerlink" title="删除分支"></a>删除分支</h1><p>当一个分支不再被需要时，可以删除</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 强制删除，即使分支上有未合并的提交</span></span><br><span class="line">git branch -D BRANCH_NAME</span><br><span class="line"></span><br><span class="line"><span class="comment"># 普通删除，仅分支上没有未合并的提交时才能删除</span></span><br><span class="line">git branch -d BRANCH_NAME</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除远端分支，前提是需要将本地分支删除，才能使用</span></span><br><span class="line">git push origin --delete BRANCH_NAME</span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%9A%84%E6%96%B0%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6" >3.2 Git 分支 - 分支的新建与合并 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86" >3.3 Git 分支 - 分支管理 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>版本管理工具</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>nodejs项目使用tesseract的文字识别功能</title>
    <url>/2025/01/03/nodejs%E9%A1%B9%E7%9B%AE%E4%BD%BF%E7%94%A8tesseract%E7%9A%84%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB%E5%8A%9F%E8%83%BD/</url>
    <content><![CDATA[<p>记录一下在 Node.js 项目中使用 tesseract 的文字识别功能。</p>
<span id="more"></span>

<h1 id="安装-Tesseract-js"><a href="#安装-Tesseract-js" class="headerlink" title="安装 Tesseract.js"></a>安装 Tesseract.js</h1><p>使用 Node.js 版本 16.19.1</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 指定版本，成功率更高</span></span><br><span class="line"><span class="comment"># 还需要安装canvas</span></span><br><span class="line">npm install tesseract.js@5.0.4 canvas@2.11.2</span><br></pre></td></tr></table></figure></div>

<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// WordProcess.class.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; createWorker &#125; = <span class="built_in">require</span>(<span class="string">&quot;tesseract.js&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; createCanvas, loadImage &#125; = <span class="built_in">require</span>(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 图片文字处理类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> <span class="title class_">WordProcess</span> &#123;</span><br><span class="line">  resultFormat = <span class="regexp">/[\r\n\s]/g</span>;</span><br><span class="line">  worker;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 初始化</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; modelCachePath  tesseract模型缓存路径</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; langs 支持的语言包，默认为chi_sim+eng，表示中文简体和英文</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">init</span>(<span class="params">modelCachePath, langs</span>) &#123;</span><br><span class="line">    modelCachePath = modelCachePath || path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./lang&quot;</span>);</span><br><span class="line">    langs = langs || <span class="string">&quot;chi_sim+eng&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">createWorker</span>(langs, <span class="number">1</span>, &#123;</span><br><span class="line">        <span class="attr">cachePath</span>: path.<span class="title function_">resolve</span>(__dirname, modelCachePath),</span><br><span class="line">      &#125;)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function">(<span class="params">worker</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">worker</span> = worker;</span><br><span class="line">          <span class="title function_">resolve</span>(<span class="variable language_">this</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="title function_">reject</span>(err);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 图片文字识别</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">string|Buffer</span>&#125; imgPath 图片地址</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Boolean</span>&#125; format 是否去掉换行空格等符号</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> &#123;<span class="type">Promise&lt;string&gt;</span>&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">ocr</span>(<span class="params">imgPath, format = <span class="literal">false</span></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">worker</span>.<span class="title function_">recognize</span>(imgPath);</span><br><span class="line">    <span class="keyword">let</span> &#123;</span><br><span class="line">      <span class="attr">data</span>: &#123; text &#125;,</span><br><span class="line">    &#125; = res;</span><br><span class="line">    <span class="keyword">if</span> (format) text = text.<span class="title function_">replace</span>(<span class="variable language_">this</span>.<span class="property">resultFormat</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> text;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 图片文字位置搜索，如果找到则返回文字在图片中的绝对坐标</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; str 要搜索位置的文字</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; imgPath 被搜索的图片</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; x 搜索起始坐标x</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; y 搜索起始坐标y</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; width 搜索宽度</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; height 搜索高度</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">[string, string]</span>&#125; colorRange 图片颜色过滤，这个范围外的颜色会被替换为白色</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> &#123;<span class="type">Promise&lt;&#123;x: number, y: number</span>&#125;&gt;&#125; 绝对坐标点</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">findStr</span>(<span class="params"></span></span><br><span class="line"><span class="params">    str,</span></span><br><span class="line"><span class="params">    imgPath,</span></span><br><span class="line"><span class="params">    x = <span class="number">0</span>,</span></span><br><span class="line"><span class="params">    y = <span class="number">0</span>,</span></span><br><span class="line"><span class="params">    width,</span></span><br><span class="line"><span class="params">    height,</span></span><br><span class="line"><span class="params">    colorRange = [<span class="string">&quot;000000&quot;</span>, <span class="string">&quot;9f2e3f&quot;</span>]</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="comment">// 读取图片</span></span><br><span class="line">    <span class="keyword">let</span> image = <span class="keyword">await</span> <span class="title function_">loadImage</span>(imgPath);</span><br><span class="line"></span><br><span class="line">    width = width || image.<span class="property">width</span>;</span><br><span class="line">    height = height || image.<span class="property">height</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 截取图片</span></span><br><span class="line">    <span class="keyword">let</span> canvas = <span class="title function_">createCanvas</span>(image.<span class="property">width</span>, image.<span class="property">height</span>);</span><br><span class="line">    <span class="keyword">let</span> ctx = canvas.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line">    ctx.<span class="title function_">drawImage</span>(image, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">let</span> imageData = ctx.<span class="title function_">getImageData</span>(x, y, width, height);</span><br><span class="line">    <span class="keyword">let</span> croppedCanvas = <span class="title function_">createCanvas</span>(width, height);</span><br><span class="line">    <span class="keyword">let</span> croppedCtx = croppedCanvas.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line">    croppedCtx.<span class="title function_">putImageData</span>(imageData, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// 过滤图片颜色</span></span><br><span class="line">    <span class="keyword">let</span> imageData2 = croppedCtx.<span class="title function_">getImageData</span>(<span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line">    <span class="keyword">let</span> data = imageData2.<span class="property">data</span>;</span><br><span class="line">    <span class="keyword">let</span> colorRangeMin = colorRange[<span class="number">0</span>]</span><br><span class="line">        .<span class="title function_">match</span>(<span class="regexp">/\w&#123;2&#125;/g</span>)</span><br><span class="line">        .<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> <span class="built_in">parseInt</span>(v, <span class="number">16</span>)),</span><br><span class="line">      colorRangeMax = colorRange[<span class="number">1</span>].<span class="title function_">match</span>(<span class="regexp">/\w&#123;2&#125;/g</span>).<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> <span class="built_in">parseInt</span>(v, <span class="number">16</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> red = data[i];</span><br><span class="line">      <span class="keyword">let</span> green = data[i + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">let</span> blue = data[i + <span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        red &gt;= colorRangeMin[<span class="number">0</span>] &amp;&amp;</span><br><span class="line">        red &lt;= colorRangeMax[<span class="number">0</span>] &amp;&amp;</span><br><span class="line">        green &gt;= colorRangeMin[<span class="number">1</span>] &amp;&amp;</span><br><span class="line">        green &lt;= colorRangeMax[<span class="number">1</span>] &amp;&amp;</span><br><span class="line">        blue &gt;= colorRangeMin[<span class="number">2</span>] &amp;&amp;</span><br><span class="line">        blue &lt;= colorRangeMax[<span class="number">2</span>]</span><br><span class="line">      )</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      data[i] = <span class="number">255</span>;</span><br><span class="line">      data[i + <span class="number">1</span>] = <span class="number">255</span>;</span><br><span class="line">      data[i + <span class="number">2</span>] = <span class="number">255</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    croppedCtx.<span class="title function_">putImageData</span>(imageData2, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 存储过滤了颜色后的图片</span></span><br><span class="line">    <span class="keyword">let</span> buffer = croppedCanvas.<span class="title function_">toBuffer</span>(<span class="string">&quot;image/png&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> tempImgPath = path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./temp.png&quot;</span>);</span><br><span class="line">    fs.<span class="title function_">writeFileSync</span>(tempImgPath, buffer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 文字识别</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">worker</span>.<span class="title function_">recognize</span>(tempImgPath);</span><br><span class="line">    <span class="keyword">let</span> &#123;</span><br><span class="line">      <span class="attr">data</span>: &#123; lines &#125;,</span><br><span class="line">    &#125; = res;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除图片</span></span><br><span class="line">    fs.<span class="title function_">unlinkSync</span>(tempImgPath);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 搜索行</span></span><br><span class="line">    <span class="keyword">let</span> line = lines.<span class="title function_">find</span>(<span class="function">(<span class="params">line, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> line.<span class="property">text</span>.<span class="title function_">replace</span>(<span class="variable language_">this</span>.<span class="property">resultFormat</span>, <span class="string">&quot;&quot;</span>).<span class="title function_">indexOf</span>(str) &gt; -<span class="number">1</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!line) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 搜索列</span></span><br><span class="line">    <span class="keyword">let</span> word = line.<span class="property">words</span>.<span class="title function_">find</span>(<span class="function">(<span class="params">word, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> word.<span class="property">text</span>.<span class="title function_">replace</span>(<span class="variable language_">this</span>.<span class="property">resultFormat</span>, <span class="string">&quot;&quot;</span>).<span class="title function_">indexOf</span>(str[<span class="number">0</span>]) &gt; -<span class="number">1</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">if</span> (!word) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> point = &#123;</span><br><span class="line">      <span class="attr">x</span>: x + word.<span class="property">bbox</span>.<span class="property">x0</span>,</span><br><span class="line">      <span class="attr">y</span>: y + word.<span class="property">bbox</span>.<span class="property">y0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> point;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p>测试如下：</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// test.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">WordProcess</span> = <span class="built_in">require</span>(<span class="string">&quot;./WordProcess.class.js&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试文字识别</span></span><br><span class="line"><span class="keyword">const</span> wp = <span class="keyword">new</span> <span class="title class_">WordProcess</span>();</span><br><span class="line">wp.<span class="title function_">init</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">async</span> (ins) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> imgPath = path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./test.png&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试文字识别</span></span><br><span class="line">    <span class="keyword">let</span> text = <span class="keyword">await</span> ins.<span class="title function_">ocr</span>(imgPath);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(text);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试文字位置搜索</span></span><br><span class="line">    <span class="keyword">let</span> point = <span class="keyword">await</span> ins.<span class="title function_">findStr</span>(<span class="string">&quot;av&quot;</span>, imgPath);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(point);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Node.js</tag>
      </tags>
  </entry>
  <entry>
    <title>shell脚本记录</title>
    <url>/2023/12/06/shell%E8%84%9A%E6%9C%AC%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h1 id="Here-document-语法"><a href="#Here-document-语法" class="headerlink" title="Here document 语法"></a>Here document 语法</h1><p><a class="link"   href="https://blog.csdn.net/liumiaocn/article/details/86715953" >参考 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>Here Document 也被称为 here-document&#x2F;here-text&#x2F;heredoc&#x2F;hereis&#x2F;here-string&#x2F;here-script，在 Linux&#x2F;Unix 中的 shell 中被广泛地应用，尤其在于用于传入多行分割参数给执行命令。除了 shell（包含 sh&#x2F;csh&#x2F;tcsh&#x2F;ksh&#x2F;bash&#x2F;zsh 等），这种方式的功能也影响和很多其他语言诸如 Perl，PHP 以及 Ruby 等。这篇文章以 bash 为例进行使用说明。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 打印多行参数</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">This is a here document.</span></span><br><span class="line"><span class="string">It can span multiple lines.</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者改个名字为CUSTOMEOF，只要结构一样，都是可以的</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">CUSTOMEOF</span></span><br><span class="line"><span class="string">This is a here document.</span></span><br><span class="line"><span class="string">It can span multiple lines.</span></span><br><span class="line"><span class="string">CUSTOMEOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将内容写入文件</span></span><br><span class="line"><span class="built_in">cat</span> &gt; test.txt &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">This is a here document.</span></span><br><span class="line"><span class="string">It can span multiple lines.</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
]]></content>
  </entry>
  <entry>
    <title>vbs控制鼠标键盘</title>
    <url>/2023/07/03/vbs%E6%8E%A7%E5%88%B6%E9%BC%A0%E6%A0%87%E9%94%AE%E7%9B%98/</url>
    <content><![CDATA[<h1 id="控制键盘"><a href="#控制键盘" class="headerlink" title="控制键盘"></a>控制键盘</h1><div class="highlight-container" data-rel="Vbscript"><figure class="iseeu highlight vbscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">&#x27;按一次R键</span></span><br><span class="line"><span class="keyword">Set</span> WShell = <span class="built_in">CreateObject</span>(<span class="string">&quot;WScript.shell&quot;</span>)</span><br><span class="line">WShell.SendKeys <span class="string">&quot;r&quot;</span></span><br></pre></td></tr></table></figure></div>

<span id="more"></span>

<div class="highlight-container" data-rel="Vbscript"><figure class="iseeu highlight vbscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">&#x27;创建对象</span></span><br><span class="line"><span class="keyword">Set</span> WShell = <span class="built_in">CreateObject</span>(<span class="string">&quot;WScript.shell&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;声明子程序（非函数程序）</span></span><br><span class="line"><span class="keyword">Sub</span> sendKeyR()</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;等待3秒钟</span></span><br><span class="line">    WScript.Sleep <span class="number">3000</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;发送10次向下方向键</span></span><br><span class="line">    WShell.SendKeys <span class="string">&quot;&#123;DOWN 10&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;循环发送R键信号20次</span></span><br><span class="line">    <span class="keyword">Dim</span> count</span><br><span class="line">	count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">Do</span> <span class="keyword">While</span> count &lt; <span class="number">20</span></span><br><span class="line">        WShell.SendKeys <span class="string">&quot;r&quot;</span></span><br><span class="line">        count = count + <span class="number">1</span></span><br><span class="line">    <span class="keyword">Loop</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> a</span><br><span class="line">	a = <span class="number">2</span></span><br><span class="line">    <span class="keyword">If</span> a &lt; <span class="number">3</span> <span class="keyword">Then</span></span><br><span class="line">		<span class="comment">&#x27;发送SHIFT + r</span></span><br><span class="line">        WShell.SendKeys <span class="string">&quot;+(r)&quot;</span></span><br><span class="line">    <span class="keyword">ElseIf</span> a &gt; <span class="number">3</span> <span class="keyword">Then</span></span><br><span class="line">        WShell.SendKeys <span class="string">&quot;q&quot;</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        WShell.SendKeys <span class="string">&quot;w&quot;</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;调用子程序</span></span><br><span class="line">sendKeyR()</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;激活窗口</span></span><br><span class="line">WShell.appactivate(<span class="string">&quot;窗口名称&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;结束进程</span></span><br><span class="line">WShell.Run <span class="string">&quot;taskkill /im wscript.exe -f&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h2 id="特殊字符"><a href="#特殊字符" class="headerlink" title="特殊字符"></a>特殊字符</h2><ul>
<li>%：ALT</li>
<li>+：SHIFT</li>
<li>^：CTRL</li>
</ul>
<p>比如百分号是表示按住ALT键，如果想要直接发送百分号，需要用大括号包裹起来</p>
<h1 id="控制鼠标"><a href="#控制鼠标" class="headerlink" title="控制鼠标"></a>控制鼠标</h1><p>目前看来<a class="link"   href="https://www.jvruo.com/archives/108/" >需要安装Excel <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>才能控制,<br>以后再写</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>VBScript</tag>
        <tag>自动化</tag>
      </tags>
  </entry>
  <entry>
    <title>vue2模拟3D效果组件</title>
    <url>/2024/06/28/vue2%E6%A8%A1%E6%8B%9F3D%E6%95%88%E6%9E%9C%E7%BB%84%E4%BB%B6/</url>
    <content><![CDATA[<p>公司本来有一个用 Three.js 实现的效果一样的组件，后来项目重构，我觉得单纯的让一张平面图有 3D 效果没必要用 Three.js，于是就有了 Simulate3D 组件的诞生</p>
<p><a class="link"   href="https://github.com/GJYyyyy/simulate3D" >git 地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.npmjs.com/package/simulate3d" >npm 地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
        <tag>javascript</tag>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>vue2镜面倒影效果组件</title>
    <url>/2024/07/16/vue2%E9%95%9C%E9%9D%A2%E5%80%92%E5%BD%B1%E6%95%88%E6%9E%9C%E7%BB%84%E4%BB%B6/</url>
    <content><![CDATA[<p>从公司项目里提炼出来的组件，效果为镜面倒影效果</p>
<p><a class="link"   href="https://github.com/GJYyyyy/mirror" >git 地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.npmjs.com/package/edge-mirror" >npm 地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
        <tag>javascript</tag>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack基础使用</title>
    <url>/2023/04/27/webpack%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<p>这里记录下 webpack 的基本使用，因为每次我新建项目的时候都要去搜索一下 webpack，感觉很麻烦，所以还是自己记录下使用的方法，增强下记忆。</p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="webpack-安装"><a href="#webpack-安装" class="headerlink" title="webpack 安装"></a>webpack 安装</h2><p>写文章的时候，webpack 最新版本是 5.81.0，可以参考<a class="link"   href="https://www.webpackjs.com/guides/getting-started/#basic-setup" >官网 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">npm install webpack webpack-cli -D</span><br></pre></td></tr></table></figure></div>

<p>一般都是使用命令行来操作 webpack，所以顺便把 webpack-cli 给安装了</p>
<span id="more"></span>

<h2 id="其他常用插件安装"><a href="#其他常用插件安装" class="headerlink" title="其他常用插件安装"></a>其他常用插件安装</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">npm install webpack-dev-server html-webpack-plugin copy-webpack-plugin clean-webpack-plugin babel-loader @babel/preset-env @babel/plugin-transform-optional-chaining url-loader raw-loader -D</span><br></pre></td></tr></table></figure></div>

<p>这里分别装了：</p>
<ul>
<li>webpack-dev-server<br> 用来开启本地服务器（开发时使用）</li>
<li>html-webpack-plugin<br> 用来设置不用打包的静态文件，比如 html 文件</li>
<li>copy-webpack-plugin<br> 用来将不需要 webpack 处理的静态文件复制到指定的打包目录</li>
<li>clean-webpack-plugin<br> 该插件负责每次打包之前都清空打包目录，保证目录干净</li>
<li>babel-loader<br> babel 的 webpack 版本，负责将 js 高版本语法编译为低版本语法，解决兼容性问题</li>
<li>@babel&#x2F;preset-env<br> babel 的预设库，用来预先设置一些常用的配置选项，比如编译目标预设为 ES5</li>
<li>@babel&#x2F;plugin-proposal-optional-chaining<br> 用来处理可选链操作符”?.”，解决兼容性问题（提议阶段版本，目前不建议使用）</li>
<li>@babel&#x2F;plugin-transform-optional-chaining<br> 用来处理可选链操作符”?.”，解决兼容性问题（正式版本）</li>
<li>url-loader<br> 用来引入文件 url，依赖 file-loader，如果文件大小小于限制 limit，会将文件内容进行 base64 编码然后返回，否则会直接调用 file-loader 返回文件 url</li>
<li>raw-loader<br> 用来引入文件内容</li>
</ul>
<h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>在项目根目录下新建配置文件：</p>
<ol>
<li>webpack.config.js（基本配置）</li>
<li>webpack.dev.config.js（开发环境配置）</li>
<li>webpack.pro.config.js（生产环境配置）</li>
</ol>
<p>webpack 配置<a class="link"   href="https://www.webpackjs.com/guides/getting-started/#using-a-configuration" >官网参考 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h3><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">CleanWebpackPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;clean-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CopyWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;copy-webpack-plugin&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">// target: &#x27;node&#x27;, // 如果需要打包后运行在nodejs环境下，需要设置此值，参考：https://www.webpackjs.com/configuration/target/#target</span></span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&quot;./src/index.js&quot;</span>,</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.js$/i</span>,</span><br><span class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>, <span class="comment">// 不编译node_modules里的代码</span></span><br><span class="line">        <span class="attr">loader</span>: <span class="string">&quot;babel-loader&quot;</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">          <span class="attr">presets</span>: [[<span class="string">&quot;@babel/preset-env&quot;</span>, &#123; <span class="attr">targets</span>: <span class="string">&quot;defaults&quot;</span> &#125;]], <span class="comment">// 使用babel预设</span></span><br><span class="line">          <span class="attr">plugins</span>: [</span><br><span class="line">            <span class="comment">// &quot;@babel/plugin-proposal-optional-chaining&quot;, // 使用可选链操作符&quot;?.&quot;，不建议使用</span></span><br><span class="line">            <span class="string">&quot;@babel/plugin-transform-optional-chaining&quot;</span>, <span class="comment">// 使用可选链操作符&quot;?.&quot;</span></span><br><span class="line">          ],</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)$/i</span>,</span><br><span class="line">        <span class="attr">loader</span>: <span class="string">&quot;url-loader&quot;</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">          <span class="attr">limit</span>: <span class="number">8192</span>, <span class="comment">// 单位：字节。如果文件大小&lt;=这个大小，会将文件内容base64编码，否则会调用file-loader</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(txt|json|vert)$/i</span>,</span><br><span class="line">        <span class="attr">loader</span>: <span class="string">&quot;raw-loader&quot;</span>, <span class="comment">// 用来引入文件的内容</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">CleanWebpackPlugin</span>(), <span class="comment">// 先删除打包目标目录再打包,</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">template</span>: <span class="string">&quot;./public/index.html&quot;</span>, <span class="comment">// 配置模板index.html文件</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// 把文件（CNAME等）移动到打包目录，如果没有需要移动的文件，则需要注释</span></span><br><span class="line">    <span class="comment">// 注意，该插件使用了空值合并操作符“??=”，需要node版本至少16</span></span><br><span class="line">    <span class="comment">// new CopyWebpackPlugin(&#123;</span></span><br><span class="line">    <span class="comment">//     patterns: [</span></span><br><span class="line">    <span class="comment">//         &#123; from: &#x27;./public/CNAME&#x27; &#125;</span></span><br><span class="line">    <span class="comment">//     ]</span></span><br><span class="line">    <span class="comment">// &#125;),</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">        设置import和require路径的别名</span></span><br><span class="line"><span class="comment">        设置后可使用</span></span><br><span class="line"><span class="comment">        import MyModule from &#x27;@/MyModule.js&#x27;</span></span><br><span class="line"><span class="comment">        替代</span></span><br><span class="line"><span class="comment">        import MyModule from &#x27;../../../../../MyModule.js&#x27;</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="string">&quot;@&quot;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;src&quot;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p><strong>注意：</strong><br>如果配置了 <strong>resolve.alias</strong> ，在 vscode 下一般需要在项目根目录同步配置引入模块的别名，才能通过 intellisense 查看引入模块的类型，参考<a href="/2024/05/20/%E8%A7%A3%E5%86%B3vscode%E6%97%A0%E6%B3%95%E8%AF%86%E5%88%ABwebpack%E4%B8%AD%E7%94%A8-%E4%BD%9C%E4%B8%BA%E5%88%AB%E5%90%8D%E7%9A%84%E6%A8%A1%E5%9D%97%E7%B1%BB%E5%9E%8B/">解决 vscode 无法识别 webpack 中用@作为别名的模块类型</a></p>
<h3 id="webpack-dev-config-js"><a href="#webpack-dev-config-js" class="headerlink" title="webpack.dev.config.js"></a>webpack.dev.config.js</h3><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.dev.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">&quot;./webpack.config&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(baseConfig, &#123;</span><br><span class="line">  <span class="comment">// 开发模式配置</span></span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line">  <span class="attr">devtool</span>: <span class="string">&quot;source-map&quot;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;dist&quot;</span>),</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    <span class="attr">publicPath</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">devServer</span>: &#123;</span><br><span class="line">    <span class="attr">static</span>: &#123;</span><br><span class="line">      <span class="attr">directory</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;dist&quot;</span>), <span class="comment">// 开发服务器根目录</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">compress</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">8888</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h3 id="webpack-pro-config-js"><a href="#webpack-pro-config-js" class="headerlink" title="webpack.pro.config.js"></a>webpack.pro.config.js</h3><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.pro.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">&quot;./webpack.config&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(baseConfig, &#123;</span><br><span class="line">  <span class="comment">// 生产模式配置</span></span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;production&quot;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;dist&quot;</span>),</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;scripts/bundle.js&quot;</span>,</span><br><span class="line">    <span class="attr">publicPath</span>: <span class="string">&quot;./&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h3 id="gitignore"><a href="#gitignore" class="headerlink" title=".gitignore"></a>.gitignore</h3><div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line">node_modules</span><br><span class="line">/dist</span><br></pre></td></tr></table></figure></div>

<h3 id="public-x2F-index-html"><a href="#public-x2F-index-html" class="headerlink" title="public&#x2F;index.html"></a>public&#x2F;index.html</h3><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="运行脚本"><a href="#运行脚本" class="headerlink" title="运行脚本"></a>运行脚本</h2><p>最后为了方便，我们把启动 webpack 的命令行脚本添加到 npm 项目的 package.json 中</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack-dev-server --config ./webpack.dev.config.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack --config ./webpack.pro.config.js&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>最后就可以快乐地使用项目了。<br><em>文章实时更新中…</em></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>VUE递归组件</title>
    <url>/2024/03/06/vue%E9%80%92%E5%BD%92%E7%BB%84%E4%BB%B6/</url>
    <content><![CDATA[<p>VUE 组件是可以调用自己的，这是递归组件的前提。</p>
<span id="more"></span>

<p>这里使用典型的 <em>文件目录树</em> 来展示递归组件的实现</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- FileTree.vue --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span> <span class="attr">v-for</span>=<span class="string">&quot;(item,index) in catalogue&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;item.type === &#x27;file&#x27;&quot;</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else-if</span>=<span class="string">&quot;item.type === &#x27;folder&#x27;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dt</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file-tree</span> <span class="attr">:catalogue</span>=<span class="string">&quot;item.children&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">file-tree</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">catalogue</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: [],</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;file-tree&quot;</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;./FileTree.vue&quot;</span>), <span class="comment">// 重点，引入自己，实现递归</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>在父组件引入组件</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Parent.vue --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">file-tree</span> <span class="attr">:catalogue</span>=<span class="string">&quot;catalogue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">file-tree</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: <span class="function">() =&gt;</span> (&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">catalogue</span>: [</span></span><br><span class="line"><span class="language-javascript">        &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&quot;folder&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">name</span>: <span class="string">&quot;目录1&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">children</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">type</span>: <span class="string">&quot;file&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;文件2&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">type</span>: <span class="string">&quot;file&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;文件222&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">            &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">type</span>: <span class="string">&quot;folder&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">name</span>: <span class="string">&quot;目录2&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">children</span>: [</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">type</span>: <span class="string">&quot;file&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;文件3&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123;</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">type</span>: <span class="string">&quot;folder&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">name</span>: <span class="string">&quot;目录3&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">children</span>: [</span></span><br><span class="line"><span class="language-javascript">                    &#123; <span class="attr">type</span>: <span class="string">&quot;file&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;文件4&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                    &#123;</span></span><br><span class="line"><span class="language-javascript">                      <span class="attr">type</span>: <span class="string">&quot;folder&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                      <span class="attr">name</span>: <span class="string">&quot;目录4&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                      <span class="attr">children</span>: [&#123; <span class="attr">type</span>: <span class="string">&quot;file&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;文件5&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">                      <span class="attr">children</span>: [&#123; <span class="attr">type</span>: <span class="string">&quot;file&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;文件555&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">                      <span class="attr">children</span>: [&#123; <span class="attr">type</span>: <span class="string">&quot;file&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;文件55555&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">                    &#125;,</span></span><br><span class="line"><span class="language-javascript">                  ],</span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">              ],</span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">type</span>: <span class="string">&quot;file&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;文件22222&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">type</span>: <span class="string">&quot;file&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;文件1&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      ],</span></span><br><span class="line"><span class="language-javascript">    &#125;),</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;file-tree&quot;</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;./FileTree.vue&quot;</span>), <span class="comment">// 引入FileTree.vue</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>vue</tag>
        <tag>面试题</tag>
      </tags>
  </entry>
  <entry>
    <title>web端通过百度地图获取当前位置的省市区信息</title>
    <url>/2023/07/27/web%E7%AB%AF%E9%80%9A%E8%BF%87%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%E7%9A%84%E7%9C%81%E5%B8%82%E5%8C%BA%E4%BF%A1%E6%81%AF/</url>
    <content><![CDATA[<p>很常见的一个需求：在 web 端获取到当前位置的省市区信息<br>这里使用百度地图来实现</p>
<h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><p>去<a class="link"   href="https://lbsyun.baidu.com/index.php?title=jspopularGL/guide/getkey" >百度地图开放平台 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>申请密钥ak，代码里需要用到。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>地图<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">100vw</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#map</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.anchorBL</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">src</span>=<span class="string">&quot;https://api.map.baidu.com/api?v=3.0&amp;ak=您的密钥&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//v3.0版本的引用方式：src=&quot;https://api.map.baidu.com/api?v=3.0&amp;ak=您的密钥&quot;</span></span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&#x27;map&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 判断浏览器是否支持获取定位功能</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (!navigator.<span class="property">geolocation</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">alert</span>(<span class="string">&#x27;您的浏览器不支持地图定位！&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                navigator.<span class="property">geolocation</span>.<span class="title function_">getCurrentPosition</span>(</span></span><br><span class="line"><span class="language-javascript">                    onLocationSuccess,</span></span><br><span class="line"><span class="language-javascript">                    onLocationError,</span></span><br><span class="line"><span class="language-javascript">                    &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">timeout</span>: <span class="number">10000</span>, <span class="comment">// 获取定位超时时间</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">enableHighAccuracy</span>: <span class="literal">true</span> <span class="comment">// 是否需要高精度定位</span></span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                );</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 * 获取定位成功处理函数</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 */</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">onLocationSuccess</span>(<span class="params">position</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">let</span> &#123; longitude, latitude &#125; = position.<span class="property">coords</span>;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">let</span> geoLocation = <span class="keyword">await</span> <span class="title function_">getGeoLocation</span>(longitude, latitude);</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">let</span> &#123; address, addressComponents &#125; = geoLocation;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(geoLocation.<span class="property">addressComponents</span>); <span class="comment">// 省市区对象</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">alert</span>(<span class="string">`您当前的位置是：<span class="subst">$&#123;address&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 * 获取定位失败处理函数</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 */</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">onLocationError</span>(<span class="params">err</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">let</span> codeZh;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">switch</span> (err.<span class="property">code</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">case</span> err.<span class="property">PERMISSION_DENIED</span>:</span></span><br><span class="line"><span class="language-javascript">                            codeZh = <span class="string">&#x27;用户拒绝了获取地理位置的请求！&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                            <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">case</span> err.<span class="property">POSITION_UNAVAILABLE</span>:</span></span><br><span class="line"><span class="language-javascript">                            codeZh = <span class="string">&#x27;位置信息不可用！&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                            <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">case</span> err.<span class="property">TIMEOUT</span>:</span></span><br><span class="line"><span class="language-javascript">                            codeZh = <span class="string">&#x27;请求超时！&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                            <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">case</span> err.<span class="property">UNKNOWN_ERROR</span>:</span></span><br><span class="line"><span class="language-javascript">                            codeZh = <span class="string">&#x27;未知错误！&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                            <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">alert</span>(<span class="string">`<span class="subst">$&#123;codeZh&#125;</span>;code=<span class="subst">$&#123;err.code&#125;</span>;<span class="subst">$&#123;err.message&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 * 通过百度地图将当前经纬度定位转化为省市区</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 */</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getGeoLocation</span>(<span class="params">longitude, latitude</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">let</span> geo = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Geocoder</span>();</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                        geo.<span class="title function_">getLocation</span>(</span></span><br><span class="line"><span class="language-javascript">                            <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(longitude, latitude),</span></span><br><span class="line"><span class="language-javascript">                            <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                                <span class="title function_">resolve</span>(result);</span></span><br><span class="line"><span class="language-javascript">                            &#125;</span></span><br><span class="line"><span class="language-javascript">                        );</span></span><br><span class="line"><span class="language-javascript">                    &#125;);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)();</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>一个兼容触摸屏的拖拽分页组件</title>
    <url>/2024/12/03/%E4%B8%80%E4%B8%AA%E5%85%BC%E5%AE%B9%E8%A7%A6%E6%91%B8%E5%B1%8F%E7%9A%84%E6%8B%96%E6%8B%BD%E5%88%86%E9%A1%B5%E7%BB%84%E4%BB%B6/</url>
    <content><![CDATA[<p>从公司项目里提炼出来的组件，用于鼠标滚轮翻页、鼠标拖拽翻页，以及触摸屏的手指滑动翻页</p>
<p><a class="link"   href="https://github.com/GJYyyyy/swiperPagination" >git 地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.npmjs.com/package/swiper-pagination" >npm 地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
        <tag>javascript</tag>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>一个对HTML/JS进行压缩丑化的工具</title>
    <url>/2025/09/24/%E4%B8%80%E4%B8%AA%E5%AF%B9HTML-JS%E8%BF%9B%E8%A1%8C%E5%8E%8B%E7%BC%A9%E4%B8%91%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/</url>
    <content><![CDATA[<p><a class="link"   href="https://t.xx-xx.top/htmlCompress.html" >HTML&#x2F;JS 兼容性转换与压缩工具 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>一个调用电脑摄像头的自拍组件</title>
    <url>/2024/11/11/%E4%B8%80%E4%B8%AA%E8%B0%83%E7%94%A8%E7%94%B5%E8%84%91%E6%91%84%E5%83%8F%E5%A4%B4%E7%9A%84%E8%87%AA%E6%8B%8D%E7%BB%84%E4%BB%B6/</url>
    <content><![CDATA[<p>从公司业务中提炼出来的一个组件，用于利用电脑摄像头自拍，然后获取自拍的照片文件</p>
<span id="more"></span>

<p>贴上 vue2 的代码实现。<br><em>代码里引入的其他资源文件这里就不展示了，仅供参考</em></p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;zh-camera&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 展示拍完的照片 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;selfie&quot;</span> <span class="attr">v-show</span>=<span class="string">&quot;photoVisible&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">ref</span>=<span class="string">&quot;selfie&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; bordered &#125;&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;dataUrl&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;selfie&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;actions row-between&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">class</span>=<span class="string">&quot;zh-button danger middle&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;reTakeAPhoto&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>重拍&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">class</span>=<span class="string">&quot;zh-button primary middle&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;surePhoto&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>确认&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 正在拍摄中摄像头 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;camera&quot;</span> <span class="attr">v-show</span>=<span class="string">&quot;!photoVisible&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">video</span> <span class="attr">ref</span>=<span class="string">&quot;camera&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; bordered &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-if</span>=<span class="string">&quot;cameraCanUse&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;zh-button primary large sure&quot;</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">click</span>=<span class="string">&quot;takeAPhoto&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span>拍照&lt;/el-button</span><br><span class="line">      &gt;</span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;info&quot;</span>&gt;</span>暂无摄像头或正在加载中<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">bordered</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>: <span class="function">() =&gt;</span> (&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">video</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">stream</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">img</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">dataUrl</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">file</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">photoVisible</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">cameraCanUse</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">delayTimer</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;),</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">init</span>();</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">playCamera</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">destroyCamera</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">init</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">video</span> = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">camera</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">img</span> = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">selfie</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">playCamera</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 添加延时加载视频流，防止快速频繁切换导致的问题。</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> delay = <span class="number">1000</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">delayTimer</span> = <span class="built_in">setTimeout</span>(<span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">cameraCanUse</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 获取浏览器摄像头</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (navigator.<span class="property">mediaDevices</span> &amp;&amp; navigator.<span class="property">mediaDevices</span>.<span class="property">getUserMedia</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="property">stream</span> = <span class="keyword">await</span> navigator.<span class="property">mediaDevices</span>.<span class="title function_">getUserMedia</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">video</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">audio</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;);</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">let</span> getWebcam =</span></span><br><span class="line"><span class="language-javascript">                navigator.<span class="property">getUserMedia</span> ||</span></span><br><span class="line"><span class="language-javascript">                navigator.<span class="property">webKitGetUserMedia</span> ||</span></span><br><span class="line"><span class="language-javascript">                navigator.<span class="property">moxGetUserMedia</span> ||</span></span><br><span class="line"><span class="language-javascript">                navigator.<span class="property">mozGetUserMedia</span> ||</span></span><br><span class="line"><span class="language-javascript">                navigator.<span class="property">msGetUserMedia</span>;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="property">stream</span> = <span class="keyword">await</span> <span class="title function_">getWebcam</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">video</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">audio</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">video</span>.<span class="property">srcObject</span> = <span class="variable language_">this</span>.<span class="property">stream</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">video</span>.<span class="title function_">play</span>();</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">resolve</span>();</span></span><br><span class="line"><span class="language-javascript">          &#125;, delay);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">destroyCamera</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">delayTimer</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">video</span>.<span class="title function_">pause</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">stream</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> tracks = <span class="variable language_">this</span>.<span class="property">stream</span>.<span class="title function_">getTracks</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">for</span> (<span class="keyword">let</span> track <span class="keyword">of</span> tracks) &#123;</span></span><br><span class="line"><span class="language-javascript">            track.<span class="title function_">stop</span>();</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">takeAPhoto</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> canvas = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;canvas&quot;</span>),</span></span><br><span class="line"><span class="language-javascript">          context = canvas.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        canvas.<span class="property">width</span> = <span class="variable language_">this</span>.<span class="property">video</span>.<span class="property">videoWidth</span>;</span></span><br><span class="line"><span class="language-javascript">        canvas.<span class="property">height</span> = <span class="variable language_">this</span>.<span class="property">video</span>.<span class="property">videoHeight</span>;</span></span><br><span class="line"><span class="language-javascript">        context.<span class="title function_">drawImage</span>(</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">video</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">video</span>.<span class="property">videoWidth</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">video</span>.<span class="property">videoHeight</span></span></span><br><span class="line"><span class="language-javascript">        );</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">dataUrl</span> = canvas.<span class="title function_">toDataURL</span>(<span class="string">&quot;image/png&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">file</span> = <span class="variable language_">this</span>.<span class="title function_">dataURLtoFile</span>(<span class="variable language_">this</span>.<span class="property">dataUrl</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">destroyCamera</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">photoVisible</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">reTakeAPhoto</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">photoVisible</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">playCamera</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">surePhoto</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$emit(<span class="string">&quot;picture&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">file</span>: <span class="variable language_">this</span>.<span class="property">file</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">dataUrl</span>: <span class="variable language_">this</span>.<span class="property">dataUrl</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       * DataUrl转为File</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">dataUrl</span> - dataUrl地址</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">fileName</span> - file文件名</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       */</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">dataURLtoFile</span>(<span class="params">dataUrl, fileName = <span class="string">&quot;picture.png&quot;</span></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> arr = dataUrl.<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>),</span></span><br><span class="line"><span class="language-javascript">          mime = arr[<span class="number">0</span>].<span class="title function_">match</span>(<span class="regexp">/:(.*?);/</span>)[<span class="number">1</span>],</span></span><br><span class="line"><span class="language-javascript">          bstr = <span class="title function_">atob</span>(arr[<span class="number">1</span>]),</span></span><br><span class="line"><span class="language-javascript">          n = bstr.<span class="property">length</span>,</span></span><br><span class="line"><span class="language-javascript">          u8arr = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(n);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">while</span> (n--) &#123;</span></span><br><span class="line"><span class="language-javascript">          u8arr[n] = bstr.<span class="title function_">charCodeAt</span>(n);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">File</span>([u8arr], fileName, &#123; <span class="attr">type</span>: mime &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span></span><br><span class="line">  // 引入自定义封装排版样式、工具样式</span><br><span class="line">  @import &quot;@/assets/style/custom.scss&quot;;</span><br><span class="line">  @import &quot;@/views/monitor/monitorV2/zh.scss&quot;;</span><br><span class="line"></span><br><span class="line">  .zh-camera &#123;</span><br><span class="line">    width: 360px;</span><br><span class="line">    height: 270px;</span><br><span class="line">    $bottomHeight: 2rem;</span><br><span class="line"></span><br><span class="line">    &gt; .camera &#123;</span><br><span class="line">      width: 100%;</span><br><span class="line">      height: 100%;</span><br><span class="line"></span><br><span class="line">      &gt; video &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: calc(100% - #&#123;$bottomHeight&#125;);</span><br><span class="line">        background-color: black;</span><br><span class="line"></span><br><span class="line">        &amp;.bordered &#123;</span><br><span class="line">          border: 1px solid #81a7d5;</span><br><span class="line">          border-radius: 4px;</span><br><span class="line">          padding: 4px;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &gt; .sure,</span><br><span class="line">      &gt; .info &#123;</span><br><span class="line">        height: $bottomHeight;</span><br><span class="line">        width: 100%;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &gt; .info &#123;</span><br><span class="line">        margin: 0;</span><br><span class="line">        color: #ff983c;</span><br><span class="line">        text-align: center;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &gt; .selfie &#123;</span><br><span class="line">      width: 100%;</span><br><span class="line">      height: 100%;</span><br><span class="line"></span><br><span class="line">      &gt; img &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: calc(100% - #&#123;$bottomHeight&#125;);</span><br><span class="line">        object-fit: contain;</span><br><span class="line">        background-color: black;</span><br><span class="line"></span><br><span class="line">        &amp;.bordered &#123;</span><br><span class="line">          border: 1px solid #81a7d5;</span><br><span class="line">          border-radius: 4px;</span><br><span class="line">          padding: 4px;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &gt; .actions &#123;</span><br><span class="line">        height: $bottomHeight;</span><br><span class="line">        width: 100%;</span><br><span class="line"></span><br><span class="line">        &gt; .el-button &#123;</span><br><span class="line">          width: calc(100% / 2 - 0.1rem);</span><br><span class="line">          height: 100%;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>不要再手动替换代码中引用的中文文件名了</title>
    <url>/2024/05/14/%E4%B8%8D%E8%A6%81%E5%86%8D%E6%89%8B%E5%8A%A8%E6%9B%BF%E6%8D%A2%E4%BB%A3%E7%A0%81%E4%B8%AD%E5%BC%95%E7%94%A8%E7%9A%84%E4%B8%AD%E6%96%87%E6%96%87%E4%BB%B6%E5%90%8D%E4%BA%86/</url>
    <content><![CDATA[<p>如果你的项目代码里有中文文件名，并且服务器不支持中文文件名，那么你可能需要手动替换它们。<br>但如果你项目里引用的中文文件名非常多，那么你可能需要一个工具来帮助你替换它们。</p>
<span id="more"></span>

<p>参考<a class="link"   href="https://github.com/GJYyyyy/replaceChinese" >replaceChinese <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>Node.js</tag>
        <tag>拯救屎山</tag>
      </tags>
  </entry>
  <entry>
    <title>为thinkphp6.1添加双token认证</title>
    <url>/2025/12/19/%E4%B8%BAthinkphp6-1%E6%B7%BB%E5%8A%A0%E5%8F%8Ctoken%E8%AE%A4%E8%AF%81/</url>
    <content><![CDATA[<p>记录一下为 thinkphp6.1 添加双 token 认证的过程</p>
<h1 id="项目环境介绍"><a href="#项目环境介绍" class="headerlink" title="项目环境介绍"></a>项目环境介绍</h1><p>我的项目是前后端分离的 thinkphp6.1 框架项目，php 版本为 7.4，<br>后端已经使用了<a class="link"   href="https://www.kancloud.cn/sfzl/tp6-jwtauth/2481656" >thans&#x2F;tp-jwt-auth <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>库提供的单 token 认证功能，<br>前端使用 Axios 来进行数据请求，会将 token 放在自定义请求头中。</p>
<h1 id="库介绍"><a href="#库介绍" class="headerlink" title="库介绍"></a>库介绍</h1><p>前端不需要新增库，只需要稍微修改使用 Axios 的逻辑即可。</p>
<p>后端使用<a class="link"   href="https://www.kancloud.cn/sfzl/tp6-jwtauth/2481656" >thans&#x2F;tp-jwt-auth <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>库提供的刷新 token API 来实现双 token 认证功能。</p>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>这里要强调一下，传统的双 token 认证是在用户登陆时生成两个 token，一个用于验证用户的 accessToken（访问用 token，生存时间短，以分钟为单位），一个用于刷新 accessToken 的 refreshToken（刷新用 token，生存时间长，以天为单位）。<br>前端访问后端的普通的接口时使用 accessToken 来鉴权，当 accessToken 过期时，就需要将 refreshToken 发送给专用的刷新接口来重新生成 accessToken（也可以不需要专用的刷新接口，而在后端实现无感刷新，这里不介绍）。</p>
<p>但是我这里说的双 token 认证和传统始的 token 认证是有区别的，因为<a class="link"   href="https://www.kancloud.cn/sfzl/tp6-jwtauth/2481656" >thans&#x2F;tp-jwt-auth <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>库已经提供一个刷新 token 的 API，<strong>所以我们在用户登录时只需要创建一个 token，即 accessToken，此时 refreshToken 已经被包含在 accessToken 的 payload 中，所以不需要单独创建 refreshToken。</strong></p>
<p>为了安全起见，该 accessToken 会在登陆时，由后端直接 Set-Cookie，并且设置 httponly&#x3D;true、secure&#x3D;true、samesite&#x3D;strict，不需要前端来管理存储。</p>
<p>前端访问后端接口时，需要携带存放了 accessToken 的 cookie，当访问普通的接口返回 401 时，就需要去访问专用的刷新接口来重新生成 accessToken。</p>
<p>和传统的双 token 认证不一样的是：<strong>这里不管是访问普通接口还是刷新接口，都是只需要携带一个 token，即 accessToken，因为 refreshToken 已经被包含在 accessToken 的 payload 中，所以不需要单独发送 refreshToken</strong>。后端解析 accessToken 时，会判断 payload 中的 refreshToken 是否过期，从而根据条件来返回 401 或者刷新 accessToken。</p>
<p>还有一处不一样的是，在 refreshToken 的过期时间内调用<a class="link"   href="https://www.kancloud.cn/sfzl/tp6-jwtauth/2481656" >thans&#x2F;tp-jwt-auth <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>库的刷新 token 的 API 后，连带着 refreshToken 也会被刷新，<br><strong>就是说，如果你的 refreshToken 的生存时间是 7 天，那么在 7 天之内调用刷新接口，refreshToken 的生存时间也会被重置为 7 天。</strong>逻辑上来讲，如果你一直是 7 天内刷新 token，那么理论上你可以永远不再手动登录。</p>
<h1 id="前端修改"><a href="#前端修改" class="headerlink" title="前端修改"></a>前端修改</h1><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 修改request.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baseURL = process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求超时时间</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> timeout = <span class="number">300</span> * <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 默认请求头</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> headers = &#123; <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 是否携带Cookie</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> withCredentials = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建一个标志，防止多个请求同时触发刷新</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> isRefreshing = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 存储刷新过程中堆积的请求</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> failedQueue = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> axiosIns = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  baseURL,</span><br><span class="line">  timeout,</span><br><span class="line">  headers,</span><br><span class="line">  withCredentials,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理队列中等待的请求</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Error|String</span>&#125; <span class="variable">error</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; token 因为token已经被cookie管理，所以这个参数完全可以忽略</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">processQueue</span>(<span class="params">error, token = <span class="literal">null</span></span>) &#123;</span><br><span class="line">  failedQueue.<span class="title function_">forEach</span>(<span class="function">(<span class="params">prom</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">      prom.<span class="title function_">reject</span>(error);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      prom.<span class="title function_">resolve</span>(token);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  failedQueue = [];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 关键修改，在响应拦截器中处理刷新逻辑</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">axiosIns.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> response.<span class="property">data</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">async</span> (error) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> originalRequestConfig = error.<span class="property">config</span>;</span><br><span class="line">    <span class="keyword">const</span> status = error.<span class="property">response</span>?.<span class="property">status</span> ?? error.<span class="property">status</span> ?? -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> errorMsg =</span><br><span class="line">      error.<span class="property">response</span>?.<span class="property">data</span>?.<span class="property">message</span> ?? error.<span class="property">message</span> ?? <span class="string">&quot;未知错误&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (status === <span class="number">401</span> &amp;&amp; !originalRequestConfig.<span class="property">_retry</span>) &#123;</span><br><span class="line">      <span class="comment">// 如果是刷新Token请求本身失败了，直接跳登录页</span></span><br><span class="line">      <span class="keyword">if</span> (originalRequestConfig.<span class="property">url</span>.<span class="title function_">includes</span>(<span class="string">&quot;auth/refreshToken&quot;</span>)) &#123;</span><br><span class="line">        router.<span class="title function_">push</span>(&#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;Login&quot;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        message.<span class="title function_">error</span>(<span class="string">`状态码：<span class="subst">$&#123;status&#125;</span>，<span class="subst">$&#123;errorMsg&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> error;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 标记这个请求，防止无限循环</span></span><br><span class="line">      originalRequestConfig.<span class="property">_retry</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 如果正在刷新，将当前请求加入队列等待</span></span><br><span class="line">      <span class="keyword">if</span> (isRefreshing) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">/**</span></span><br><span class="line"><span class="comment">           * 这个地方为每个刷新期间发送的请求添加一个等待控制（将resolve和reject方法放到等待队列中），</span></span><br><span class="line"><span class="comment">           * 当刷新token成功后，会依次调用队列中的resolve或者reject方法，以此实现等待的逻辑</span></span><br><span class="line"><span class="comment">           */</span></span><br><span class="line">          failedQueue.<span class="title function_">push</span>(&#123; resolve, reject &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">          .<span class="title function_">then</span>(<span class="keyword">async</span> (token) =&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">              <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="title function_">axiosIns</span>(originalRequestConfig);</span><br><span class="line">              <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(res.<span class="property">data</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">              <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err);</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      isRefreshing = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 尝试调用专用的刷新接口</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> axiosIns.<span class="title function_">post</span>(<span class="string">&quot;/auth/refreshToken&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> newToken = response.<span class="property">data</span>.<span class="property">token</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 处理队列中等待的请求</span></span><br><span class="line">        <span class="title function_">processQueue</span>(<span class="literal">null</span>, newToken);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 重新发送原始的请求</span></span><br><span class="line">        <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="title function_">axiosIns</span>(originalRequestConfig);</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(res.<span class="property">data</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (refreshError) &#123;</span><br><span class="line">        <span class="comment">// 刷新也失败，引导用户重新登录</span></span><br><span class="line">        <span class="title function_">processQueue</span>(refreshError, <span class="literal">null</span>);</span><br><span class="line">        router.<span class="title function_">push</span>(&#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;Login&quot;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> error;</span><br><span class="line">      &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        isRefreshing = <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      message.<span class="title function_">error</span>(<span class="string">`状态码：<span class="subst">$&#123;status&#125;</span>，<span class="subst">$&#123;errorMsg&#125;</span>`</span>);</span><br><span class="line">      <span class="keyword">return</span> error;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure></div>

<h1 id="后端修改"><a href="#后端修改" class="headerlink" title="后端修改"></a>后端修改</h1><div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line"># 修改根目录下的.env文件，添加如下配置</span><br><span class="line"></span><br><span class="line">[JWT]</span><br><span class="line">SECRET=你的JWT密钥</span><br><span class="line"># 单位：秒</span><br><span class="line">TTL=7200</span><br><span class="line"># 单位：分钟</span><br><span class="line">REFRESH_TTL=20160</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 修改 Auth.php 控制器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">thans</span>\<span class="title">jwt</span>\<span class="title">exception</span>\<span class="title">JWTException</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">thans</span>\<span class="title">jwt</span>\<span class="title">facade</span>\<span class="title">JWTAuth</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">facade</span>\<span class="title">Cookie</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Auth</span> <span class="keyword">extends</span> <span class="title">BaseController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Summary of refreshToken</span></span><br><span class="line"><span class="comment">     * 刷新token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \think\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">refreshToken</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$token</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable">$token</span> = <span class="title class_">JWTAuth</span>::<span class="title function_ invoke__">refresh</span>();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JWTException <span class="variable">$e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">fJsonError</span>(<span class="string">&#x27;登录过期，&#x27;</span> . <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>(), <span class="number">401</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">setUserCookie</span>(<span class="variable">$token</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">fJsonSuccess</span>([<span class="string">&#x27;token&#x27;</span> =&gt; <span class="variable">$token</span>], <span class="string">&#x27;刷新token成功&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Summary of setUserCookie</span></span><br><span class="line"><span class="comment">     * 设置用户cookie</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mixed $token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">setUserCookie</span>(<span class="params"><span class="variable">$token</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title class_">Cookie</span>::<span class="title function_ invoke__">delete</span>(<span class="string">&#x27;token&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$tokenOption</span> = [</span><br><span class="line">            <span class="string">&#x27;expire&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;JWT_REFRESH_TTL&#x27;</span>) * <span class="number">60</span> * <span class="number">2</span>, <span class="comment">// 使cookie的有效期是refreshToken有效期的2倍，防止refreshToken过期和cookie过期同时触发</span></span><br><span class="line">            <span class="string">&#x27;httponly&#x27;</span> =&gt; <span class="literal">true</span>, <span class="comment">// 使cookie只能通过http协议读取，无法通过js读取</span></span><br><span class="line">            <span class="string">&#x27;secure&#x27;</span> =&gt; <span class="literal">true</span>, <span class="comment">// 使cookie只能通过https协议访问，不能通过http协议访问</span></span><br><span class="line">            <span class="string">&#x27;samesite&#x27;</span> =&gt; <span class="string">&#x27;Strict&#x27;</span>, <span class="comment">// 使cookie只能通过当前域名访问，不能通过其他域名访问</span></span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 测试环境</span></span><br><span class="line">        <span class="variable">$isDebug</span> = <span class="title function_ invoke__">env</span>(<span class="string">&#x27;app_debug&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$isDebug</span>) &#123;</span><br><span class="line">            <span class="variable">$tokenOption</span>[<span class="string">&#x27;httponly&#x27;</span>] = <span class="literal">false</span>;</span><br><span class="line">            <span class="variable">$tokenOption</span>[<span class="string">&#x27;secure&#x27;</span>] = <span class="literal">false</span>;</span><br><span class="line">            <span class="variable">$tokenOption</span>[<span class="string">&#x27;samesite&#x27;</span>] = <span class="string">&#x27;Lax&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title class_">Cookie</span>::<span class="title function_ invoke__">set</span>(<span class="string">&#x27;token&#x27;</span>, <span class="variable">$token</span>, <span class="variable">$tokenOption</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h1><p>如果你想实现传统的双 token 认证，而不是我上面介绍的这种特殊的双 token 认证，你可以直接生成两个 token，这个过程就不再赘叙了。</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>php</tag>
        <tag>thinkphp</tag>
        <tag>Axios</tag>
      </tags>
  </entry>
  <entry>
    <title>为不规则图形添加阴影</title>
    <url>/2024/09/14/%E4%B8%BA%E4%B8%8D%E8%A7%84%E5%88%99%E5%9B%BE%E5%BD%A2%E6%B7%BB%E5%8A%A0%E9%98%B4%E5%BD%B1/</url>
    <content><![CDATA[<p>记录一个添加阴影的例子<br><a class="link"   href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/filter-function/drop-shadow" >drop-shadow() <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Css"><figure class="iseeu highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">filter</span>: <span class="built_in">drop-shadow</span>(<span class="number">0px</span> <span class="number">0px</span> <span class="number">50px</span> <span class="number">#183454</span>);</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
        <tag>特效</tag>
      </tags>
  </entry>
  <entry>
    <title>人月神话</title>
    <url>/2025/12/10/%E4%BA%BA%E6%9C%88%E7%A5%9E%E8%AF%9D/</url>
    <content><![CDATA[<p>免责声明：本材料不作为商业目的，仅交流使用，如有侵权，联系删除即可。</p>
<p><a href="/mydoc/%E4%BA%BA%E6%9C%88%E7%A5%9E%E8%AF%9D(40%E5%91%A8%E5%B9%B4%E4%B8%AD%E6%96%87%E7%BA%AA%E5%BF%B5%E7%89%88)%EF%BC%88%E5%B8%A6%E7%9B%AE%E5%BD%95%EF%BC%89.pdf">人月神话(40 周年中文纪念版)（带目录）</a></p>
<p>最开始吸引我的是这本书的名字“人月神话”，作为一本讲软件工程的书，怎么会跟“月亮”、“神话”扯上关系？究竟为什么会这么起名？我很好奇，所以专门去问了 AI，回答如下：</p>
<blockquote>
<p>首先《人月神话》的书名（英文原名：The Mythical Man-Month）并非翻译偏差，而是以隐喻揭示软件工程的本质矛盾：“人月”是管理者的一厢情愿，“神话”则是被现实反复戳破的泡沫。</p>
<ul>
<li><p>“人月”的定义：<br>人月（Man-Month）：指软件开发中衡量工作量的单位，即“1 个人工作 1 个月”的累计工时。例如 3 人工作 2 个月 &#x3D; 6 个人月。管理者常假设“人员与时间可线性替代”，认为 10 人工作 1 月 &#x3D; 1 人工作 10 月。这种观念在农业或流水线作业中可能成立（如收割小麦），但在软件开发中却行不通。</p>
</li>
<li><p>“神话”的批判性：<br>布鲁克斯法则（Brooks’ Law）：书名中的“神话”直指“人月可替换”的虚假性。作者提出核心观点：<strong>“向进度落后的项目增加人手，只会使进度更加落后”</strong>，因为软件开发依赖<strong>沟通协作</strong>，增加人员会大幅提升沟通成本（如会议、文档同步），反而会消耗原有生产力。</p>
</li>
</ul>
</blockquote>
]]></content>
      <categories>
        <category>生活</category>
      </categories>
      <tags>
        <tag>图书</tag>
      </tags>
  </entry>
  <entry>
    <title>使用AWS EC2 配置SSTap服务</title>
    <url>/2023/09/15/%E4%BD%BF%E7%94%A8AWS-EC2-%E9%85%8D%E7%BD%AESSTap%E6%9C%8D%E5%8A%A1/</url>
    <content><![CDATA[<p>github 有时候访问不了，很难受，所以自己搞个国外服务器作为代理来访问 github 中转站。</p>
<h1 id="1-选择云服务器"><a href="#1-选择云服务器" class="headerlink" title="1. 选择云服务器"></a>1. 选择云服务器</h1><p>既然要无障碍访问 github，当然是选择<a class="link"   href="https://aws.amazon.com/cn/" >AWS 亚马逊云 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>了，登录 AWS，选择 EC2 服务，然后启动新实例。</p>
<h1 id="2-配置云服务器并启动"><a href="#2-配置云服务器并启动" class="headerlink" title="2. 配置云服务器并启动"></a>2. 配置云服务器并启动</h1><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025380_b4e354c4cd67e6f2489d7a8fd6f59fd6.png"
                     
                ></p>
<ol>
<li>系统类型选择<em>Amazon Linux</em></li>
<li>系统镜像选择<em>Amazon Linux 2 AMI (HVM) - Kernel 5.10, SSD Volume Type</em><br><strong>如果没有这个系统镜像，也尽量不要选择太新的系统镜像</strong></li>
<li>系统架构选择<em>64 位(x86)<em>（更新一下，当选择</em>t4g.nano</em>时，需要选择*64 位(ARM)*）</li>
<li>实例类型选择<em>t3a.nano</em>（更新一下，其实选择<em>t4g.nano</em>更便宜）<br>我选择这个实例是因为以下几点： - 我只需要在特定时候用（比如偶尔访问 Github），不需要它每天都运行，所以选择按需计费 - 在按需计费实例里面属于最便宜的那几个，并且它的网络性能好（代理服务器需要网络性能好）；我只跑两个服务（宝塔面板和 SSTap），不需要 CPU 和内存性能太好<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025381_3489f9ba38d31e1063836f26f73803f8.png"
                     
                ></li>
</ol>
<p>这些都配置完毕后，就可以使用 PuTTY 远程控制实例了。</p>
<h1 id="3-安装宝塔面板"><a href="#3-安装宝塔面板" class="headerlink" title="3. 安装宝塔面板"></a>3. 安装宝塔面板</h1><p>安装宝塔主要是为了更好的监控服务器的资源消耗，以及更方便地控制端口的开放<br><a class="link"   href="https://www.bt.cn/new/download.html" >宝塔面板下载 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>如果不清楚自己的系统是什么类型，就选择<em>万能安装脚本</em><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025381_ee5805873652d6076a062339ff42421a.png"
                     
                ></p>
<h1 id="4-安装-SSTap-服务端"><a href="#4-安装-SSTap-服务端" class="headerlink" title="4. 安装 SSTap 服务端"></a>4. 安装 SSTap 服务端</h1><p>复制下面自动安装脚本到终端运行 <strong>（需要 root 权限）</strong></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo -i</span><br><span class="line">wget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssr.sh &amp;&amp; <span class="built_in">chmod</span> +x ssr.sh &amp;&amp; bash ssr.sh</span><br></pre></td></tr></table></figure></div>

<p><a class="link"   href="https://blog.csdn.net/fly1574/article/details/89841311?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169474253316800226526362%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169474253316800226526362&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-89841311-null-null.142%5Ev94%5Einsert_down28v1&utm_term=aws%20ec2%20%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8&spm=1018.2226.3001.4187" >参考 CSDN 博客配置 SSTap <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a href="">参考阿里云博客配置 SSTap</a></p>
<p>要注意几个设置（没有提的设置项都采用默认值，直接回车即可）</p>
<ol>
<li>端口选择默认<em>2333</em><br><strong>注意要把实例的防火墙开放，还有 AWS 安全组的防火墙也要开放</strong></li>
<li>加密方式选择<em>aes-256-cfb</em></li>
<li>协议插件选择<em>auth_aes128_md5</em></li>
</ol>
<p>然后一直回车就可以安装成功，安装成功后如果启动失败，可能是下面的原因：</p>
<ol>
<li>系统镜像版本太新（选择一个老版本的系统镜像）</li>
<li>实例服务端口没开放（使用宝塔面板开启）或者 AWS 安全组的端口没开放（去安全组配置端口）</li>
</ol>
<h2 id="4-1-服务端问题"><a href="#4-1-服务端问题" class="headerlink" title="4.1. 服务端问题"></a>4.1. 服务端问题</h2><p>如果突然出现连接不上的情况，可以打开服务器实例终端，切换 root 权限，然后进入“~”目录，执行下面的命令</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">./ssr.sh</span><br></pre></td></tr></table></figure></div>

<p>然后选择“8. 手动 修改配置”，重新配置后就可以连接上了。</p>
<h1 id="5-安装-SSTap-客户端"><a href="#5-安装-SSTap-客户端" class="headerlink" title="5. 安装 SSTap 客户端"></a>5. 安装 SSTap 客户端</h1><h2 id="5-1-Windows-客户端"><a href="#5-1-Windows-客户端" class="headerlink" title="5.1 Windows 客户端"></a>5.1 Windows 客户端</h2><p><a class="link"   href="https://www.sockscap64.com/sstap-enjoy-gaming-enjoy-sstap/" >SSTap 官网 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><em>注意，SSTap 和 SocksCap64 已于 2017 年 11 月 19 日停止开发及维护和下载，使用该软件请自觉遵守国家相关法律</em><br><a class="link"   href="https://pan.baidu.com/s/12puOm4bPnFQ6i555iTyQMw&code=22qi" >SSTap 百度云下载 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h2 id="5-2-Ubuntu-客户端"><a href="#5-2-Ubuntu-客户端" class="headerlink" title="5.2 Ubuntu 客户端"></a>5.2 Ubuntu 客户端</h2><p>需要准备：</p>
<ol>
<li>python2 和 python3</li>
<li>SSR 客户端（需要 python2）<br>用来连接 SSR 服务端，并在对本地暴露代理功能。</li>
<li>ProxyChains（需要 python3）<br>用来代理本地的请求，通过 SSR 客户端在本地暴露的代理功能，将数据转发给 SSTap 服务端。使用时在命令前面加上 proxychains 即可</li>
</ol>
<h3 id="5-2-1-安装-Python2-和-Python3"><a href="#5-2-1-安装-Python2-和-Python3" class="headerlink" title="5.2.1 安装 Python2 和 Python3"></a>5.2.1 安装 Python2 和 Python3</h3><p>首先使用下列命令判断系统是否安装了 python2 和 python3，如果有安装，则跳过安装步骤，直接进行命令配置步骤</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">python2 --version</span><br><span class="line">python3 --version</span><br></pre></td></tr></table></figure></div>

<p>如果没有安装，则使用下列命令安装 python2 和 python3</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 没有安装 python2 就安装 python2</span></span><br><span class="line">sudo apt install python2</span><br><span class="line"><span class="comment"># 没有安装 python3 就安装 python3</span></span><br><span class="line">sudo apt install python3</span><br></pre></td></tr></table></figure></div>

<p>最后，进行命令配置步骤，<br>因为很多软件都需要使用 python 命令，而 python2 和 python3 的命令分别为 python2 和 python3，所以需要创建一个 python 命令，用来需要时分别指向 python2 或者 python3。<br>参考<a href="/2023/04/22/Ubuntu%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/#%E5%88%87%E6%8D%A2%E5%91%BD%E4%BB%A4%E7%89%88%E6%9C%AC">切换命令版本</a></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 添加python2 到命令 python</span></span><br><span class="line">sudo update-alternatives --install /usr/bin/python python /usr/bin/python2 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加python2 到命令 python</span></span><br><span class="line">sudo update-alternatives --install /usr/bin/python python /usr/bin/python3 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加完毕后，使用该命令切换python版本</span></span><br><span class="line">sudo update-alternatives --config python</span><br></pre></td></tr></table></figure></div>

<h3 id="5-2-2-安装-SSR-客户端"><a href="#5-2-2-安装-SSR-客户端" class="headerlink" title="5.2.2 安装 SSR 客户端"></a>5.2.2 安装 SSR 客户端</h3><p>参考：<a class="link"   href="https://www.cnblogs.com/pythonal/p/9301350.html" >kali 安装后配置 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>下载 ssr 脚本</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://onlyless.github.io/ssr</span><br><span class="line">sudo <span class="built_in">mv</span> ssr /usr/local/bin</span><br><span class="line">sudo <span class="built_in">chmod</span> 766 /usr/local/bin/ssr</span><br></pre></td></tr></table></figure></div>

<p>执行 ssr 安装脚本</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">ssr install</span><br></pre></td></tr></table></figure></div>

<p>配置 ssr 客户端信息</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">ssr config</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;server&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.0.0&quot;</span><span class="punctuation">,</span> <span class="comment">// SSR服务端IP地址</span></span><br><span class="line">  <span class="attr">&quot;server_ipv6&quot;</span><span class="punctuation">:</span> <span class="string">&quot;::&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;server_port&quot;</span><span class="punctuation">:</span> <span class="number">9999</span><span class="punctuation">,</span> <span class="comment">// SSR服务端端口</span></span><br><span class="line">  <span class="attr">&quot;local_address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;127.0.0.1&quot;</span><span class="punctuation">,</span> <span class="comment">// 提供给本地代理（ProxyChains）的IP地址</span></span><br><span class="line">  <span class="attr">&quot;local_port&quot;</span><span class="punctuation">:</span> <span class="number">1080</span><span class="punctuation">,</span> <span class="comment">// 提供给本地代理（ProxyChains）的端口</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;password&quot;</span><span class="punctuation">,</span> <span class="comment">// SSR服务端密码</span></span><br><span class="line">  <span class="attr">&quot;method&quot;</span><span class="punctuation">:</span> <span class="string">&quot;aes-256-cfb&quot;</span><span class="punctuation">,</span> <span class="comment">// SSR服务端加密方式</span></span><br><span class="line">  <span class="attr">&quot;protocol&quot;</span><span class="punctuation">:</span> <span class="string">&quot;auth_aes128_md5&quot;</span><span class="punctuation">,</span> <span class="comment">// SSR服务端协议</span></span><br><span class="line">  <span class="attr">&quot;protocol_param&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;obfs&quot;</span><span class="punctuation">:</span> <span class="string">&quot;plain&quot;</span><span class="punctuation">,</span> <span class="comment">// SSR服务端混淆方式</span></span><br><span class="line">  <span class="attr">&quot;obfs_param&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;speed_limit_per_con&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;speed_limit_per_user&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;additional_ports&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;additional_ports_only&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;timeout&quot;</span><span class="punctuation">:</span> <span class="number">120</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;udp_timeout&quot;</span><span class="punctuation">:</span> <span class="number">60</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dns_ipv6&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;connect_verbose_info&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;redirect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;fast_open&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>最后启动 ssr 客户端<br><strong>注意，这里需要切换到使用 python2 版本的 python 命令参考<a href="/2023/04/22/Ubuntu%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/#%E5%88%87%E6%8D%A2%E5%91%BD%E4%BB%A4%E7%89%88%E6%9C%AC">切换命令版本</a></strong></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 启动</span></span><br><span class="line">ssr start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭</span></span><br><span class="line">ssr stop</span><br></pre></td></tr></table></figure></div>

<h3 id="5-2-3-安装-ProxyChains"><a href="#5-2-3-安装-ProxyChains" class="headerlink" title="5.2.3 安装 ProxyChains"></a>5.2.3 安装 ProxyChains</h3><p>参考 <a class="link"   href="https://blog.csdn.net/qq_40178878/article/details/115618387" >proxychains–network 代理 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>安装 ProxyChains</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install proxychains</span><br></pre></td></tr></table></figure></div>

<p>配置 ProxyChains</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/proxychains.conf</span><br></pre></td></tr></table></figure></div>

<p>在配置文件中进行以下修改</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line"># 注释掉 proxy_dns</span><br><span class="line"># proxy_dns</span><br><span class="line"></span><br><span class="line"># 取消注释 dynamic_chain</span><br><span class="line">dynamic_chain</span><br><span class="line"></span><br><span class="line"># 添加 socks5 代理，指向上一步 ssr 的 local_address 和 local_port</span><br><span class="line"># 并且如果有socks4, 需要注释socks4</span><br><span class="line">socks5 127.0.0.1 1080</span><br></pre></td></tr></table></figure></div>

<p>测试 ProxyChains<br><strong>注意，这里需要切换到使用 python3 版本的 python 命令参考<a href="/2023/04/22/Ubuntu%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/#%E5%88%87%E6%8D%A2%E5%91%BD%E4%BB%A4%E7%89%88%E6%9C%AC">切换命令版本</a></strong></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains ping google.com</span><br></pre></td></tr></table></figure></div>

<h1 id="6-其他问题"><a href="#6-其他问题" class="headerlink" title="6. 其他问题"></a>6. 其他问题</h1><p>按需计费实例停止或终止就会停止计费（存储空间除外），但是重新启动的实例的公网 ip 以及公网 dns 会改变，SSH 和 SSTap 需要修改 ip 或域名才能重新连接。</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
        <tag>AWS</tag>
        <tag>PuTTY</tag>
        <tag>SSTap</tag>
      </tags>
  </entry>
  <entry>
    <title>使用Emscripten编译WASM供NodeJS调用</title>
    <url>/2023/11/03/%E4%BD%BF%E7%94%A8Emscripten%E7%BC%96%E8%AF%91WASM%E4%BE%9BNodeJS%E8%B0%83%E7%94%A8/</url>
    <content><![CDATA[<h1 id="配置-emscripten"><a href="#配置-emscripten" class="headerlink" title="配置 emscripten"></a>配置 emscripten</h1><p>找到一个空文件夹，运行下面的命令安装 <em>emscripten</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Get the emsdk repo</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/emscripten-core/emsdk.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># Enter that directory</span></span><br><span class="line"><span class="built_in">cd</span> emsdk</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fetch the latest version of the emsdk (not needed the first time you clone)</span></span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line"><span class="comment"># Download and install the latest SDK tools.</span></span><br><span class="line">./emsdk install latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make the &quot;latest&quot; SDK &quot;active&quot; for the current user. (writes .emscripten file)</span></span><br><span class="line">./emsdk activate latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># Activate PATH and other environment variables in the current terminal</span></span><br><span class="line"><span class="built_in">source</span> ./emsdk_env.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># On Windows, run emsdk.bat instead of ./emsdk, and emsdk_env.bat instead of source ./emsdk_env.sh.</span></span><br></pre></td></tr></table></figure></div>

<p>安装完成后需要把 <em>emscripten</em> 安装 根目录 和 根目录下的 <em>upstream&#x2F;emscripten</em> 添加到环境变量，方便全局调用</p>
<h1 id="Node-js-调用-WASM"><a href="#Node-js-调用-WASM" class="headerlink" title="Node.js 调用 WASM"></a>Node.js 调用 WASM</h1><h2 id="编写-c"><a href="#编写-c" class="headerlink" title="编写 c++"></a>编写 c++</h2><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;emscripten.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EXTERN_C extern <span class="string">&quot;C&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EXTERN_C</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">EXTERN_C EMSCRIPTEN_KEEPALIVE <span class="type">void</span> <span class="title">sayHi</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hi!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">EXTERN_C EMSCRIPTEN_KEEPALIVE <span class="type">double</span> <span class="title">add</span><span class="params">(<span class="type">double</span> num1, <span class="type">double</span> num2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>如果源码中引入头文件语法报错，需要在 <em>.vscode</em> 中修改 <em>c_cpp_properties.json</em> 文件内容如下<br>加上”D:\Emscripten\emsdk\upstream\emscripten\system\include\**”<br>*<em>！！注意！！*</em><br>**这里的 *c_cpp_properties.json* 是基于 MinGW 设置的语法检测，如果没有安装 MinGW，可以无视语法检测，后面一样可以编译成功**</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Win32&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;includePath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;$&#123;workspaceFolder&#125;/**&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;D:\\Emscripten\\emsdk\\upstream\\emscripten\\system\\include\\**&quot;</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;defines&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;_DEBUG&quot;</span><span class="punctuation">,</span> <span class="string">&quot;UNICODE&quot;</span><span class="punctuation">,</span> <span class="string">&quot;_UNICODE&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;compilerPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\MinGW\\mingw64\\bin\\gcc.exe&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;cStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c17&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;cppStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gnu++14&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;intelliSenseMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;windows-gcc-x64&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;configurationProvider&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ms-vscode.makefile-tools&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="number">4</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="编译-c"><a href="#编译-c" class="headerlink" title="编译 c++"></a>编译 c++</h2><p><strong>！！注意！！</strong><br><strong>emscripten 后台会使用 <em>clang++</em> 来编译 c++程序，如果源码里面包含了 <em>MinGW</em> 提供的头文件，将会有兼容性问题，导致编译无法通过</strong></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">emsdk_env &amp;&amp; emcc .\src\main.cpp -o .\wasm\wasm_api.js -s WASM=1</span><br><span class="line"><span class="comment"># 如果在C++函数没有标识 EMSCRIPTEN_KEEPALIVE ，则编译需要加上参数 -s EXPORTED_FUNCTIONS=&quot;[&#x27;_sayHi&#x27;,&#x27;_add&#x27;]&quot;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="调用-c"><a href="#调用-c" class="headerlink" title="调用 c++"></a>调用 c++</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> wasm_api = <span class="built_in">require</span>(<span class="string">&quot;../wasm/wasm_api.js&quot;</span>);</span><br><span class="line"></span><br><span class="line">wasm_api.<span class="property">onRuntimeInitialized</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  wasm_api.<span class="title function_">_sayHi</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(wasm_api.<span class="title function_">_add</span>(<span class="number">0.1</span>, <span class="number">0.2</span>));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://emscripten.org/docs/getting_started/downloads.html" >Emscripten 官网 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.ruanyifeng.com/blog/2017/09/asmjs_emscripten.html" >阮一峰 asm.js 和 Emscripten 入门教程 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://zhuanlan.zhihu.com/p/593694882" >VSCode + WebAssembly 简易工程化配置 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://pythonjishu.com/mrsiboxxqmzfqnw/" >Node.js 使用 WebAssembly <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://blog.csdn.net/qq_16893329/article/details/128017294" >解决“……called before runtime initialization”问题 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://blog.csdn.net/foupwang/article/details/128030999" >EMSCRIPTEN_KEEPALIVE 的作用 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>VSCode</tag>
        <tag>Node.js</tag>
        <tag>WASM</tag>
      </tags>
  </entry>
  <entry>
    <title>使用Java自动控制键盘鼠标完成高重复性工作</title>
    <url>/2023/11/09/%E4%BD%BF%E7%94%A8Java%E8%87%AA%E5%8A%A8%E6%8E%A7%E5%88%B6%E9%94%AE%E7%9B%98%E9%BC%A0%E6%A0%87%E5%AE%8C%E6%88%90%E9%AB%98%E9%87%8D%E5%A4%8D%E6%80%A7%E5%B7%A5%E4%BD%9C/</url>
    <content><![CDATA[<p><a class="link"   href="https://github.com/GJYyyyy/JavaAutoControl" >github地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/GJYyyyy/JavaAutoControl.git</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>自动化</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>使用PuTTY和ssh密钥登录Ubuntu</title>
    <url>/2023/04/22/%E4%BD%BF%E7%94%A8PuTTY%E5%92%8Cssh%E5%AF%86%E9%92%A5%E7%99%BB%E5%BD%95Ubuntu/</url>
    <content><![CDATA[<h1 id="1-服务端配置"><a href="#1-服务端配置" class="headerlink" title="1. 服务端配置"></a>1. 服务端配置</h1><h2 id="1-1-允许密钥登录"><a href="#1-1-允许密钥登录" class="headerlink" title="1.1 允许密钥登录"></a>1.1 允许密钥登录</h2><p>配置 &#x2F;etc&#x2F;ssh&#x2F;sshd_config</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure></div>

<span id="more"></span>

<p>添加内容</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line"># 启用RSA认证</span><br><span class="line">RSAAuthentication yes</span><br><span class="line"># 启用公钥认证</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line"># 禁止root用户登录</span><br><span class="line">PermitRootLogin no</span><br></pre></td></tr></table></figure></div>
<h2 id="1-2-生成密钥对"><a href="#1-2-生成密钥对" class="headerlink" title="1.2 生成密钥对"></a>1.2 生成密钥对</h2><p>-t: 密钥类型，可以选择 dsa | ecdsa | ed25519 | rsa; 省略的情况下默认是rsa</p>
<p>-f: 密钥目录位置，指定生成密钥的保存路径和文件名。省略的情况下， 默认为当前用户home路径下的.ssh隐藏目录，也就是<del>&#x2F;.ssh&#x2F;，同时默认密钥文件名以id_rsa开头。省略的情况下，默认目录就是</del>&#x2F;.ssh&#x2F;，不会再次提醒输入。但是会再次提是你输入文件名，如果不输入直接回车，则默认的密钥文件名就是id_rsa</p>
<p>-C: 指定此密钥的备注信息，需要配置多个免密登录时，建议携带;生成的公钥会在最后面显示此备注信息</p>
<p>-N: 指定此密钥对的密码，如果指定此参数，则命令执行过程中就不会出现交互确认密码的信息了。如果省略此参数，会提示你输入密码和密码确认。一般情况下不用输入，直接回车就行。如果输入密码之后，以后每次都要输入密码。这里请根据你的安全需要决定是否需要密码，如果不需要，直接回车。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -f ~/.ssh/id_rsa -N shoufeng -C shoufeng</span><br></pre></td></tr></table></figure></div>
<p>生成成功后会在 ~&#x2F;.</p>
<h2 id="1-3-在服务器上安装公钥"><a href="#1-3-在服务器上安装公钥" class="headerlink" title="1.3. 在服务器上安装公钥"></a>1.3. 在服务器上安装公钥</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.ssh</span><br><span class="line"><span class="built_in">cat</span> id_rsa.pub &gt;&gt; authorized_keys</span><br></pre></td></tr></table></figure></div>
<p>保证只有自己的账户能够对ssh读写，只要确保后面两位都是0就行了</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">chmod</span> 600 authorized_keys</span><br><span class="line"><span class="built_in">chmod</span> 700 ~/.ssh</span><br></pre></td></tr></table></figure></div>

<h2 id="1-4-重启ssh"><a href="#1-4-重启ssh" class="headerlink" title="1.4. 重启ssh"></a>1.4. 重启ssh</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">service sshd restart</span><br></pre></td></tr></table></figure></div>

<h1 id="2-客户端配置"><a href="#2-客户端配置" class="headerlink" title="2. 客户端配置"></a>2. 客户端配置</h1><h2 id="2-1-PuTTY"><a href="#2-1-PuTTY" class="headerlink" title="2.1. PuTTY"></a>2.1. PuTTY</h2><h3 id="2-2-私钥格式转换"><a href="#2-2-私钥格式转换" class="headerlink" title="2.2. 私钥格式转换"></a>2.2. 私钥格式转换</h3><p>把生成的私钥文件 id.rsa 下载下来，然后通过PuTTygen转化为 ppk 格式。<br>一般安装了PuTTY都会附加安装PuTTYgen。  </p>
<h4 id="2-2-1-rsa转ppk"><a href="#2-2-1-rsa转ppk" class="headerlink" title="2.2.1 rsa转ppk"></a>2.2.1 rsa转ppk</h4><p>电脑搜索打开PuTTYgen，选择上方菜单栏 Conversions -&gt; Import key 导入下载的 id.rsa 文件，点击 Save private Key 按钮保存到本地。</p>
<h4 id="2-2-2-pem转ppk"><a href="#2-2-2-pem转ppk" class="headerlink" title="2.2.2 pem转ppk"></a>2.2.2 pem转ppk</h4><p><a class="link"   href="https://help.aliyun.com/zh/simple-application-server/user-guide/connect-to-linux-server-remotely#cd239863f9zqh" >参考阿里云轻量级服务器的私钥转换方法 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><em>注意，阿里云轻量级服务器变更密钥对后，需要重启服务器，才能使用新密钥对</em></p>
<h3 id="2-3-配置PuTTY"><a href="#2-3-配置PuTTY" class="headerlink" title="2.3. 配置PuTTY"></a>2.3. 配置PuTTY</h3><p>打开PuTTy。<br>找到 Connection -&gt; SSH -&gt; Auth ，在 Private key file for authentication 区域选择私钥ppk文件。<br>找到 Connection -&gt; Data ，在 Auto-login username 填入用户名<br>找到 Session ，输入服务器地址，然后 Save，最后再 Open 就可以了</p>
<h1 id="遇到问题"><a href="#遇到问题" class="headerlink" title="遇到问题"></a>遇到问题</h1><h2 id="突然无法使用密钥登录"><a href="#突然无法使用密钥登录" class="headerlink" title="突然无法使用密钥登录"></a>突然无法使用密钥登录</h2><p>因为登录用户的家文件夹所属用户被更改为其他用户了，使用chown改回来即可。</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>PuTTY</tag>
      </tags>
  </entry>
  <entry>
    <title>使用SVN检出和导入项目</title>
    <url>/2023/11/11/%E4%BD%BF%E7%94%A8SVN%E6%A3%80%E5%87%BA%E5%92%8C%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE/</url>
    <content><![CDATA[<h1 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h1><p><em>这里感觉导入（import）和检入（checkin）差不多，所以就直接用导入</em></p>
<h2 id="1-选中要导入-svn-的文件夹右键"><a href="#1-选中要导入-svn-的文件夹右键" class="headerlink" title="1. 选中要导入 svn 的文件夹右键"></a>1. 选中要导入 svn 的文件夹右键</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025374_fb6d8c628cd834b89e13a767d80d74f2.png"
                     
                ></p>
<h2 id="2-选择-svn-目录"><a href="#2-选择-svn-目录" class="headerlink" title="2. 选择 svn 目录"></a>2. 选择 svn 目录</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025375_da64bee31bec271ac5d4113867f0aecc.png"
                     
                ></p>
<h2 id="3-创建-svn-目录"><a href="#3-创建-svn-目录" class="headerlink" title="3. 创建 svn 目录"></a>3. 创建 svn 目录</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025381_8e132e8d42d48321d881ef8033efc3a1.png"
                     
                ><br>然后上传到新建的目录就行了</p>
<h1 id="检出"><a href="#检出" class="headerlink" title="检出"></a>检出</h1><p><em>检出（checkout）和导出（export）的不同之处在于前者会带着.svn 目录，后者不带.svn 目录，后者常用于部署</em></p>
<h2 id="1-选中要检出的文件夹右键"><a href="#1-选中要检出的文件夹右键" class="headerlink" title="1. 选中要检出的文件夹右键"></a>1. 选中要检出的文件夹右键</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025374_a0a4d0349c2d574375d231b50844b176.png"
                     
                ></p>
<h2 id="2-选择-svn-目录-1"><a href="#2-选择-svn-目录-1" class="headerlink" title="2. 选择 svn 目录"></a>2. 选择 svn 目录</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025375_2e9a1bd98efef7ede7f4d356778def41.png"
                     
                ><br>然后检出就行了</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>版本管理工具</tag>
        <tag>SVN</tag>
      </tags>
  </entry>
  <entry>
    <title>使用css中的mask特性为html元素添加渐变透明边缘</title>
    <url>/2024/05/09/%E4%BD%BF%E7%94%A8css%E4%B8%AD%E7%9A%84mask%E7%89%B9%E6%80%A7%E4%B8%BAhtml%E5%85%83%E7%B4%A0%E6%B7%BB%E5%8A%A0%E6%B8%90%E5%8F%98%E9%80%8F%E6%98%8E%E8%BE%B9%E7%BC%98/</url>
    <content><![CDATA[<p>上代码！</p>
<span id="more"></span>

<p><a class="link"   href="https://github.com/GJYyyyy/edgeOpacity" >git 地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.npmjs.com/package/edgeopacity" >npm 地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>渐变透明边框<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      * &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100vw</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">25vh</span> <span class="number">25vw</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-image</span>: <span class="built_in">conic-gradient</span>(</span></span><br><span class="line"><span class="language-css">          red <span class="number">6deg</span>,</span></span><br><span class="line"><span class="language-css">          orange <span class="number">6deg</span> <span class="number">18deg</span>,</span></span><br><span class="line"><span class="language-css">          yellow <span class="number">18deg</span> <span class="number">45deg</span>,</span></span><br><span class="line"><span class="language-css">          green <span class="number">45deg</span> <span class="number">110deg</span>,</span></span><br><span class="line"><span class="language-css">          blue <span class="number">110deg</span> <span class="number">200deg</span>,</span></span><br><span class="line"><span class="language-css">          purple <span class="number">200deg</span></span></span><br><span class="line"><span class="language-css">        );</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="comment">/* 第一层，主要解决左右的渐变透明边缘 */</span></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.left-right</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">50vw</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">50vh</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">mask</span>: <span class="built_in">linear-gradient</span>(</span></span><br><span class="line"><span class="language-css">          to right,</span></span><br><span class="line"><span class="language-css">          transparent <span class="number">0%</span>,</span></span><br><span class="line"><span class="language-css">          white <span class="number">15%</span>,</span></span><br><span class="line"><span class="language-css">          white <span class="number">85%</span>,</span></span><br><span class="line"><span class="language-css">          transparent <span class="number">100%</span></span></span><br><span class="line"><span class="language-css">        );</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="comment">/* 第二层，主要解决上下的渐变透明边缘 */</span></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.top-bottom</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">50vw</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">50vh</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">mask</span>: <span class="built_in">linear-gradient</span>(</span></span><br><span class="line"><span class="language-css">          to bottom,</span></span><br><span class="line"><span class="language-css">          transparent <span class="number">0%</span>,</span></span><br><span class="line"><span class="language-css">          white <span class="number">15%</span>,</span></span><br><span class="line"><span class="language-css">          white <span class="number">85%</span>,</span></span><br><span class="line"><span class="language-css">          transparent <span class="number">100%</span></span></span><br><span class="line"><span class="language-css">        );</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.content</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: black;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 第一层，主要解决左右的渐变透明边缘 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left-right&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 第二层，主要解决上下的渐变透明边缘 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;top-bottom&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 主体内容，可以很复杂，边缘都会渐变透明化 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">          又一热点城市，房地产政策出现重大变动！</span><br><span class="line">          5月9日，杭州市住房保障和房产管理局官网发布《关于优化调整房地产市场调控政策的通知》（简称《通知》），宣布全面取消住房限购。</span><br><span class="line">          中新财经梳理发现，目前全国仍保留住房限购的省份或城市，除了北京、上海、广州、深圳四个一线城市，仅剩海南省、天津市、西安市仍处于部分放开限购的状态。</span><br><span class="line">          又一热点城市，房地产政策出现重大变动！</span><br><span class="line">          5月9日，杭州市住房保障和房产管理局官网发布《关于优化调整房地产市场调控政策的通知》（简称《通知》），宣布全面取消住房限购。</span><br><span class="line">          中新财经梳理发现，目前全国仍保留住房限购的省份或城市，除了北京、上海、广州、深圳四个一线城市，仅剩海南省、天津市、西安市仍处于部分放开限购的状态。</span><br><span class="line">          又一热点城市，房地产政策出现重大变动！</span><br><span class="line">          5月9日，杭州市住房保障和房产管理局官网发布《关于优化调整房地产市场调控政策的通知》（简称《通知》），宣布全面取消住房限购。</span><br><span class="line">          中新财经梳理发现，目前全国仍保留住房限购的省份或城市，除了北京、上海、广州、深圳四个一线城市，仅剩海南省、天津市、西安市仍处于部分放开限购的状态。</span><br><span class="line">          又一热点城市，房地产政策出现重大变动！</span><br><span class="line">          5月9日，杭州市住房保障和房产管理局官网发布《关于优化调整房地产市场调控政策的通知》（简称《通知》），宣布全面取消住房限购。</span><br><span class="line">          中新财经梳理发现，目前全国仍保留住房限购的省份或城市，除了北京、上海、广州、深圳四个一线城市，仅剩海南省、天津市、西安市仍处于部分放开限购的状态。</span><br><span class="line">          又一热点城市，房地产政策出现重大变动！</span><br><span class="line">          5月9日，杭州市住房保障和房产管理局官网发布《关于优化调整房地产市场调控政策的通知》（简称《通知》），宣布全面取消住房限购。</span><br><span class="line">          中新财经梳理发现，目前全国仍保留住房限购的省份或城市，除了北京、上海、广州、深圳四个一线城市，仅剩海南省、天津市、西安市仍处于部分放开限购的状态。</span><br><span class="line">          又一热点城市，房地产政策出现重大变动！</span><br><span class="line">          5月9日，杭州市住房保障和房产管理局官网发布《关于优化调整房地产市场调控政策的通知》（简称《通知》），宣布全面取消住房限购。</span><br><span class="line">          中新财经梳理发现，目前全国仍保留住房限购的省份或城市，除了北京、上海、广州、深圳四个一线城市，仅剩海南省、天津市、西安市仍处于部分放开限购的状态。</span><br><span class="line">          又一热点城市，房地产政策出现重大变动！</span><br><span class="line">          5月9日，杭州市住房保障和房产管理局官网发布《关于优化调整房地产市场调控政策的通知》（简称《通知》），宣布全面取消住房限购。</span><br><span class="line">          中新财经梳理发现，目前全国仍保留住房限购的省份或城市，除了北京、上海、广州、深圳四个一线城市，仅剩海南省、天津市、西安市仍处于部分放开限购的状态。</span><br><span class="line">          又一热点城市，房地产政策出现重大变动！</span><br><span class="line">          5月9日，杭州市住房保障和房产管理局官网发布《关于优化调整房地产市场调控政策的通知》（简称《通知》），宣布全面取消住房限购。</span><br><span class="line">          中新财经梳理发现，目前全国仍保留住房限购的省份或城市，除了北京、上海、广州、深圳四个一线城市，仅剩海南省、天津市、西安市仍处于部分放开限购的状态。</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
        <tag>特效</tag>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>使用VSCode的代码片段提高效率</title>
    <url>/2024/09/27/%E4%BD%BF%E7%94%A8VSCode%E7%9A%84%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5%E6%8F%90%E9%AB%98%E6%95%88%E7%8E%87/</url>
    <content><![CDATA[<p>工作中有很多重复的代码，使用 VSCode 的代码片段可以快速实现重复代码的编写，提高效率。</p>
<span id="more"></span>

<h1 id="vue-常用代码片段"><a href="#vue-常用代码片段" class="headerlink" title="vue 常用代码片段"></a>vue 常用代码片段</h1><p>这里放几个工作中经常用到的代码片段：</p>
<h2 id="vue2-和-scss-初始页面代码片段"><a href="#vue2-和-scss-初始页面代码片段" class="headerlink" title="vue2 和 scss 初始页面代码片段"></a>vue2 和 scss 初始页面代码片段</h2><div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;vue2的scss页面&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;scope&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue-scss&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;&lt;template&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&lt;div class=\&quot;component-name\&quot;&gt;&lt;/div&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/template&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;script&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;export default &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\tdata: () =&gt; (&#123;&#125;),&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&#125;;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/script&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;style scoped lang=\&quot;scss\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;.component-name &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/style&gt;&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;在vue2下，使用scss创建一个初始页面&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="vue2-下-ElementUI-的-el-table-初始页面代码片段"><a href="#vue2-下-ElementUI-的-el-table-初始页面代码片段" class="headerlink" title="vue2 下 ElementUI 的 el-table 初始页面代码片段"></a>vue2 下 ElementUI 的 el-table 初始页面代码片段</h2><div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;vue2的el-table页面&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;scope&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue-el-table&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;&lt;template&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&lt;div class=\&quot;component-name\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&lt;el-table :data=\&quot;tableData\&quot; height=\&quot;100%\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-table-column&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tv-for=\&quot;column in columns\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t:key=\&quot;column.prop\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t:label=\&quot;column.label\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;template slot-scope=\&quot;scope\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t&lt;template v-if=\&quot;column.prop === &#x27;actions&#x27;\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\t&lt;el-button&gt;按钮&lt;/el-button&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t&lt;/template&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t&lt;template v-else&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\t&#123;&#123; scope.row[column.prop] &#125;&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t&lt;/template&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;/template&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-table-column&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&lt;/el-table&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&lt;/div&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/template&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;script&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;export default &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\tdata: () =&gt; (&#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tcolumns: [&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#123; prop: \&quot;xxxxx1\&quot;, label: \&quot;列1\&quot; &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#123; prop: \&quot;actions\&quot;, label: \&quot;操作\&quot; &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t],&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\ttableData: [&#123; xxxxx1: \&quot;值1\&quot; &#125;],&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&#125;),&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&#125;;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/script&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;style scoped lang=\&quot;scss\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;.component-name &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/style&gt;&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;在vue2下，使用elementUI的el-table创建一个初始页面&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="vue2-下-ElementUI-的-el-dialog-初始页面代码片段"><a href="#vue2-下-ElementUI-的-el-dialog-初始页面代码片段" class="headerlink" title="vue2 下 ElementUI 的 el-dialog 初始页面代码片段"></a>vue2 下 ElementUI 的 el-dialog 初始页面代码片段</h2><div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;vue2的el-dialog页面&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;scope&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue-el-dialog&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;&lt;template&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&lt;el-dialog&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t:visible.sync=\&quot;_visible\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t:title=\&quot;title\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tcustom-class=\&quot;component-name\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\twidth=\&quot;35vw\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t:modal=\&quot;true\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t:close-on-click-modal=\&quot;true\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t:close-on-press-escape=\&quot;true\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t:append-to-body=\&quot;false\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&lt;div class=\&quot;test\&quot;&gt;弹窗内容&lt;/div&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&lt;span slot=\&quot;footer\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-button @click=\&quot;_visible = false\&quot;&gt;取消&lt;/el-button&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-button type=\&quot;primary\&quot; @click=\&quot;_visible = false\&quot;&gt;确定&lt;/el-button&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&lt;/span&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&lt;/el-dialog&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/template&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&lt;script&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;export default &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\tprops: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tvisible: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\ttype: Boolean,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\tdefault: false,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\tdata: () =&gt; (&#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\ttitle: \&quot;弹窗标题\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&#125;),&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\tcomputed: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t_visible: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\tget() &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\treturn this.visible;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\tset(newVal) &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tthis.$$emit(\&quot;update:visible\&quot;, newVal);&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&#125;;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/script&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&lt;style scoped lang=\&quot;scss\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;.component-name &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&gt; .el-dialog__header &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&gt; .el-dialog__body &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&gt; .test &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/style&gt;&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;在vue2下，使用elementUI的el-dialog创建一个初始页面&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="vue2-下-ElementUI-的-el-form-初始页面代码片段"><a href="#vue2-下-ElementUI-的-el-form-初始页面代码片段" class="headerlink" title="vue2 下 ElementUI 的 el-form 初始页面代码片段"></a>vue2 下 ElementUI 的 el-form 初始页面代码片段</h2><div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;vue2的el-form页面&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;scope&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue-el-form&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;&lt;template&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&lt;div class=\&quot;component-name\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&lt;el-form&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\tref=\&quot;fuleForm\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t:model=\&quot;formData\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\tlabel-position=\&quot;top\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t:rules=\&quot;formRules\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx1\&quot; label=\&quot;文本框\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-input v-model=\&quot;formData.xxxxx1\&quot; clearable&gt;&lt;/el-input&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx2\&quot; label=\&quot;下拉框\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-select&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tv-model=\&quot;formData.xxxxx2\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tplaceholder=\&quot;请选择下拉框\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t:multiple=\&quot;false\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tclearable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t&lt;el-option&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\tv-for=\&quot;item in selectItems\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\t:key=\&quot;item.value\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\t:label=\&quot;item.label\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\t:value=\&quot;item.value\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t&gt;&lt;/el-option&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;/el-select&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx3\&quot; label=\&quot;级联下拉框\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-cascader&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tv-model=\&quot;formData.xxxxx3\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t:props=\&quot;cascProps\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tplaceholder=\&quot;请选择级联下拉框\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tclearable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt;&lt;/el-cascader&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx4\&quot; label=\&quot;日期\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-date-picker&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tv-model=\&quot;formData.xxxxx4\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\ttype=\&quot;date\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tplaceholder=\&quot;选择日期\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tformat=\&quot;yyyy-MM-dd\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tvalue-format=\&quot;yyyy-MM-dd\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tclearable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt;&lt;/el-date-picker&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx5\&quot; label=\&quot;日期范围\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-date-picker&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tv-model=\&quot;formData.xxxxx5\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\ttype=\&quot;daterange\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\trange-separator=\&quot;至\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tstart-placeholder=\&quot;开始日期\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tend-placeholder=\&quot;结束日期\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tplaceholder=\&quot;选择日期范围\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tformat=\&quot;yyyy-MM-dd\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tvalue-format=\&quot;yyyy-MM-dd\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tclearable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt;&lt;/el-date-picker&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx6\&quot; label=\&quot;时间\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-time-picker&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tv-model=\&quot;formData.xxxxx6\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tplaceholder=\&quot;选择时间\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tformat=\&quot;HH:mm:ss\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tvalue-format=\&quot;HH:mm:ss\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tclearable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt;&lt;/el-time-picker&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx7\&quot; label=\&quot;时间范围\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-time-picker&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tv-model=\&quot;formData.xxxxx7\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tis-range&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\trange-separator=\&quot;至\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tstart-placeholder=\&quot;开始时间\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tend-placeholder=\&quot;结束时间\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tplaceholder=\&quot;选择时间范围\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tformat=\&quot;HH:mm:ss\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tvalue-format=\&quot;HH:mm:ss\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tclearable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt;&lt;/el-time-picker&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx8\&quot; label=\&quot;日期时间\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-date-picker&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tv-model=\&quot;formData.xxxxx8\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\ttype=\&quot;datetime\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tplaceholder=\&quot;选择日期时间\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tformat=\&quot;yyyy-MM-dd HH:mm:ss\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tvalue-format=\&quot;yyyy-MM-dd HH:mm:ss\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tclearable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;/el-date-picker&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx9\&quot; label=\&quot;日期时间范围\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-date-picker&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tv-model=\&quot;formData.xxxxx9\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\ttype=\&quot;datetimerange\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tplaceholder=\&quot;选择日期时间范围\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\trange-separator=\&quot;至\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tstart-placeholder=\&quot;开始日期\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tend-placeholder=\&quot;结束日期\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tformat=\&quot;yyyy-MM-dd HH:mm:ss\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tvalue-format=\&quot;yyyy-MM-dd HH:mm:ss\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tclearable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;/el-date-picker&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item label=\&quot;开关\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-switch&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tv-model=\&quot;formData.xxxxx10\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tactive-color=\&quot;green\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tinactive-color=\&quot;red\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tactive-text=\&quot;开启\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tinactive-text=\&quot;关闭\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt;&lt;/el-switch&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx11\&quot; label=\&quot;多选框\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-checkbox-group v-model=\&quot;formData.xxxxx11\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t&lt;el-checkbox&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\tv-for=\&quot;item in checkboxItems\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\t:key=\&quot;item.value\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\t:label=\&quot;item.value\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\t&gt;&#123;&#123; item.label &#125;&#125;&lt;/el-checkbox&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;/el-checkbox-group&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx12\&quot; label=\&quot;单选框\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-radio-group v-model=\&quot;formData.xxxxx12\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t&lt;el-radio&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\tv-for=\&quot;item in radioItems\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\t:key=\&quot;item.value\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\t:label=\&quot;item.value\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t\t&gt;&#123;&#123; item.label &#125;&#125;&lt;/el-radio&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;/el-radio-group&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;el-form-item prop=\&quot;xxxxx13\&quot; label=\&quot;文本域\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-input&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tv-model=\&quot;formData.xxxxx13\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\ttype=\&quot;textarea\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tplaceholder=\&quot;请输入内容\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t:autosize=\&quot;&#123; minRows: 2, maxRows: 4 &#125;\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tmaxlength=\&quot;10\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tclearable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt;&lt;/el-input&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/el-form-item&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;div&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-button type=\&quot;primary\&quot; @click=\&quot;onSubmit(&#x27;fuleForm&#x27;)\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t&gt;提交&lt;/el-button&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&lt;el-button&gt;取消&lt;/el-button&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&lt;/div&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&lt;/el-form&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&lt;/div&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/template&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;script&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;export default &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\tdata: () =&gt; (&#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tselectItems: [&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#123; label: \&quot;区域一\&quot;, value: \&quot;shanghai\&quot; &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#123; label: \&quot;区域二\&quot;, value: \&quot;beijing\&quot; &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t],&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tcascItms: [&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tvalue: \&quot;zhinan\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tlabel: \&quot;指南\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t],&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tcheckboxItems: [&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#123; label: \&quot;美食/餐厅线上活动\&quot;, value: 1 &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#123; label: \&quot;地推活动\&quot;, value: 2 &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#123; label: \&quot;线下主题活动\&quot;, value: 3 &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#123; label: \&quot;单纯品牌曝光\&quot;, value: 4 &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t],&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tradioItems: [&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#123; label: \&quot;线上品牌商赞助\&quot;, value: 1 &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#123; label: \&quot;线下场地免费\&quot;, value: 2 &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t],&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tformRules: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx1: &#123; required: true, message: \&quot;请输入内容\&quot;, trigger: \&quot;blur\&quot; &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx2: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\trequired: true,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tmessage: \&quot;请选择内容\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\ttrigger: \&quot;change\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx3: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\trequired: true,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tmessage: \&quot;请选择内容\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\ttrigger: \&quot;change\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx4: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\trequired: true,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tmessage: \&quot;请选择日期\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\ttrigger: \&quot;change\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx5: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\trequired: true,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tmessage: \&quot;请选择日期范围\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\ttrigger: \&quot;change\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx6: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\trequired: true,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tmessage: \&quot;请选择时间\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\ttrigger: \&quot;change\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx7: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\trequired: true,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tmessage: \&quot;请选择时间范围\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\ttrigger: \&quot;change\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx8: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\trequired: true,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tmessage: \&quot;请选择日期时间\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\ttrigger: \&quot;change\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx9: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\trequired: true,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tmessage: \&quot;请选择日期时间范围\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\ttrigger: \&quot;change\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx11: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\trequired: true,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tmessage: \&quot;请选择多选框\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\ttrigger: \&quot;change\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx12: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\trequired: true,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tmessage: \&quot;请选择单选框\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\ttrigger: \&quot;change\&quot;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx13: &#123; required: true, message: \&quot;请输入内容\&quot;, trigger: \&quot;blur\&quot; &#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tformData: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx1: undefined,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx2: undefined,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx3: undefined,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx4: undefined,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx5: [],&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx6: undefined,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx7: [],&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx8: undefined,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx9: [],&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx10: false,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx11: [],&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx12: undefined,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\txxxxx13: undefined,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&#125;),&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\tcomputed: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tcascProps() &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\treturn &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tmultiple: false,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tlazy: true,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tlazyLoad: this.cascLazyLoad, // 此处如果要引用this的方法，则不能将cascProps放到data里，而是需要将cascProps设置为计算属性&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\tmethods: &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tcascLazyLoad(node, resolve) &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\tlet &#123; level &#125; = node; // level从0开始&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\tsetTimeout(() =&gt; &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tlet result = this.cascItms.map((v) =&gt; (&#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\t...v,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tleaf: level &gt;= 2, // 叶子节点，代表最终结果，不会再异步查询&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&#125;));&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tresolve(result);&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;, 500);&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\tonSubmit(formName) &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\tthis.$$refs[formName].validate((valid) =&gt; &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\tif (valid) &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\tconsole.log(this.formData);&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&#125; else &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\treturn false;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;);&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&#125;,&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&#125;;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/script&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;style scoped lang=\&quot;scss\&quot;&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;.component-name &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&gt; .el-form &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&gt; .el-form-item &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t/deep/ &gt; .el-form-item__content &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&gt; * &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t\twidth: 100%;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t\t&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t\t&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t\t&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;\t&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;&lt;/style&gt;&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;在vue2下，使用elementUI的el-form创建一个初始页面&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>代码片段中的 <strong>scope</strong> 字段如果不填写，则会对所有类型的代码语言生效</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>VSCode</tag>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>使用iframe来解决大部分web项目的兼容性问题</title>
    <url>/2023/07/27/%E4%BD%BF%E7%94%A8iframe%E6%9D%A5%E8%A7%A3%E5%86%B3%E5%A4%A7%E9%83%A8%E5%88%86web%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>工作中遇到一个需求，要在一个比较老的 web 项目中添加新功能，但是最好不要动老项目的代码。<br>思来想去，就用 iframe 来实现吧，iframe 的内容和老项目的内容互不干扰，数据传输使用 postMessage 来实现。<br><a class="link"   href="https://github.com/GJYyyyy/iframe-msg.js" >github地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.npmjs.com/package/iframe-msg.js" >npm地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><ul>
<li>IframeMsg.js 核心类(封装发送和接收信息的逻辑)</li>
<li>index.html 父页面</li>
<li>child.html 子页面</li>
</ul>
<h2 id="IframeMsg-js"><a href="#IframeMsg-js" class="headerlink" title="IframeMsg.js"></a>IframeMsg.js</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">IframeMsg</span> <span class="keyword">extends</span> <span class="title class_ inherited__">EventTarget</span> &#123;</span><br><span class="line">    data; <span class="comment">// 接收到的信息</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通信对方的window对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Window</span>&#125; <span class="variable">_window</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">_window</span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_window</span> = _window;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">init</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化接收信息处理函数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">onMessage</span> = (<span class="params">ev</span>) =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (ev.<span class="property">data</span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> &#123; action, data &#125; = ev.<span class="property">data</span>;</span><br><span class="line">                <span class="keyword">if</span> (action === <span class="literal">undefined</span>) <span class="keyword">return</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">data</span> = ev.<span class="property">data</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;message&#x27;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, onMessage, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送消息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; action 动作</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">any</span>&#125; data 消息体</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">send</span>(<span class="params">action, data</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_window</span>.<span class="title function_">postMessage</span>(</span><br><span class="line">            &#123;</span><br><span class="line">                action,</span><br><span class="line">                data</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&#x27;*&#x27;</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h2><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>iframe通信<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">&quot;child&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./child.html&quot;</span> <span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./IframeMsg.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> child = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;child&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            child.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> iframeMsg = <span class="keyword">new</span> <span class="title class_">IframeMsg</span>(child.<span class="property">contentWindow</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                iframeMsg.<span class="title function_">send</span>(<span class="string">&#x27;jump&#x27;</span>, <span class="string">&#x27;这条信息从父window发送到子window&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                iframeMsg.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(ev.<span class="property">target</span>.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">alert</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(ev.<span class="property">target</span>.<span class="property">data</span>));</span></span><br><span class="line"><span class="language-javascript">                &#125;);</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="child-html"><a href="#child-html" class="headerlink" title="child.html"></a>child.html</h2><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>iframe通信<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./IframeMsg.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> iframeMsg = <span class="keyword">new</span> <span class="title class_">IframeMsg</span>(<span class="variable language_">window</span>.<span class="property">parent</span>);</span></span><br><span class="line"><span class="language-javascript">            iframeMsg.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(ev.<span class="property">target</span>.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">alert</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(ev.<span class="property">target</span>.<span class="property">data</span>));</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                iframeMsg.<span class="title function_">send</span>(<span class="string">&#x27;jump&#x27;</span>, <span class="string">&#x27;这条信息从子window发送到父window&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;, <span class="number">1000</span>);</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>使用自签证书开启本地https服务</title>
    <url>/2023/05/09/%E4%BD%BF%E7%94%A8%E8%87%AA%E7%AD%BE%E8%AF%81%E4%B9%A6%E5%BC%80%E5%90%AF%E6%9C%AC%E5%9C%B0https%E6%9C%8D%E5%8A%A1/</url>
    <content><![CDATA[<p>记录一下如何在本地搭建https服务</p>
<span id="more"></span>

<h1 id="下载OpenSSL"><a href="#下载OpenSSL" class="headerlink" title="下载OpenSSL"></a>下载OpenSSL</h1><p>Ubuntu环境自带OpenSSL，Windows环境需要先下载<br><a class="link"   href="https://slproweb.com/products/Win32OpenSSL.html" >OpenSSL下载页 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>选择“<strong>Win64 OpenSSL vx.x.x Light</strong>”下载，如果是IIS使用，需要下载版本低一点的<strong>v.1.1.1</strong></p>
<h1 id="生成证书"><a href="#生成证书" class="headerlink" title="生成证书"></a>生成证书</h1><h2 id="一步到位"><a href="#一步到位" class="headerlink" title="一步到位"></a>一步到位</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 需要先cd到一个新的文件夹，这个文件夹用来存放生成的密钥和证书</span></span><br><span class="line"><span class="comment"># server.key是密钥文件名称</span></span><br><span class="line"><span class="comment"># server.crt是证书文件名称</span></span><br><span class="line"><span class="comment"># 3650是有效天数</span></span><br><span class="line"><span class="comment"># C=CN表示中国区域</span></span><br><span class="line"><span class="comment"># CN=testhttps.com表示证书绑定的域名</span></span><br><span class="line">openssl req -newkey rsa:2048 -nodes -keyout server.key -x509 -days 3650 -subj <span class="string">&quot;/C=CN/CN=testhttps.com&quot;</span> -out server.crt</span><br></pre></td></tr></table></figure></div>

<h2 id="分步生成"><a href="#分步生成" class="headerlink" title="分步生成"></a>分步生成</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 生成密钥</span></span><br><span class="line">openssl genrsa -out server.key 2048</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 生成证书请求文件</span></span><br><span class="line"><span class="comment"># Common Name 是自己的域名，测试的话可以随便写一个</span></span><br><span class="line">openssl req -new -key server.key -out server.csr</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 生成证书</span></span><br><span class="line">openssl x509 -req -days 3650 -<span class="keyword">in</span> server. csr -signkey server.key -out server.crt</span><br></pre></td></tr></table></figure></div>

<h1 id="开启nodejs-https服务"><a href="#开启nodejs-https服务" class="headerlink" title="开启nodejs https服务"></a>开启nodejs https服务</h1><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> https = <span class="built_in">require</span>(<span class="string">&#x27;https&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">443</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> serverOption = &#123;</span><br><span class="line">    <span class="attr">key</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./ssl/server.key&#x27;</span>),</span><br><span class="line">    <span class="attr">cert</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./ssl/server.crt&#x27;</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handler</span> = (<span class="params">req, res</span>) =&gt; &#123;</span><br><span class="line">    res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/plain;charset=utf8&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&#x27;服务器响应的数据&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = https.<span class="title function_">createServer</span>(serverOption, handler);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`---server listen on <span class="subst">$&#123;port&#125;</span>---`</span>);</span><br><span class="line">server.<span class="title function_">listen</span>(port);</span><br></pre></td></tr></table></figure></div>

<p>最后浏览器打开<strong><a class="link"   href="https://localhost/" >https://localhost <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></strong>就可以访问https服务器了  </p>
<p><em>因为是自签证书，所以浏览器会警告，不过没关系，继续访问就行了，另外域名不用证书绑定的testhttps.com也行，目前不清楚原理</em></p>
<p>参考<br><a class="link"   href="https://blog.csdn.net/xgangzai/article/details/112300962" >https://blog.csdn.net/xgangzai/article/details/112300962 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://blog.csdn.net/huyaguang/article/details/128192978" >https://blog.csdn.net/huyaguang/article/details/128192978 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>Node.js</tag>
      </tags>
  </entry>
  <entry>
    <title>使用ServiceWorker强大的缓存能力将网站变为本地应用</title>
    <url>/2024/02/29/%E4%BD%BF%E7%94%A8ServiceWorker%E5%BC%BA%E5%A4%A7%E7%9A%84%E7%BC%93%E5%AD%98%E8%83%BD%E5%8A%9B%E5%B0%86%E7%BD%91%E7%AB%99%E5%8F%98%E4%B8%BA%E6%9C%AC%E5%9C%B0%E5%BA%94%E7%94%A8/</url>
    <content><![CDATA[<p>持续更新中…</p>
<span id="more"></span>

<h1 id="注册-ServiceWorker"><a href="#注册-ServiceWorker" class="headerlink" title="注册 ServiceWorker"></a>注册 ServiceWorker</h1><p>将网站根目录下的 serviceWorker.js 文件注册为 ServiceWorker。<br><strong>尽量保证 serviceWorker.js 文件在网站根目录，这样才能监听整个网站的请求</strong></p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="string">&quot;serviceWorker&quot;</span> <span class="keyword">in</span> navigator) &#123;</span><br><span class="line">  <span class="comment">// 判断浏览器是否支持ServiceWorker</span></span><br><span class="line">  navigator.<span class="property">serviceWorker</span></span><br><span class="line">    .<span class="title function_">register</span>(<span class="string">&quot;/serviceWorker.js&quot;</span>, &#123;</span><br><span class="line">      <span class="attr">scope</span>: <span class="string">&quot;/&quot;</span>, <span class="comment">// 作用域，默认为serviceWorker.js文件所在目录，也是serviceWorker.js能够监听请求的目录，不能越级监听</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">registration</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ServiceWorker registration successful&quot;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;ServiceWorker registration failed: &quot;</span>, err);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="编写-ServiceWorker"><a href="#编写-ServiceWorker" class="headerlink" title="编写 ServiceWorker"></a>编写 ServiceWorker</h1><p>静态资源一般作为网站的骨架，包括通用的样式、字体、图片等，一般不会有太大变化，所以可以作为长期缓存缓存到本地浏览器。</p>
<p><em>长期缓存的文件会永久的存在于本地，如果出现了静态资源的更新，可在浏览器中使用 <strong>ctrl + F5</strong> 组合键来强制清除缓存</em></p>
<h2 id="缓存静态资源"><a href="#缓存静态资源" class="headerlink" title="缓存静态资源"></a>缓存静态资源</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// serviceWorker.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 静态缓存库名称</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CACHE_STATIC_NAME</span> = <span class="string">&quot;blog_static_cache&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 静态资源url数组，存放永久/长久不变的静态资源url</span></span><br><span class="line"><span class="keyword">const</span> staticUrls = [</span><br><span class="line">  <span class="string">&quot;/index.html&quot;</span>, <span class="comment">// 永久缓存网站首页</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&quot;install&quot;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ServiceWorker install&quot;</span>);</span><br><span class="line">  <span class="comment">// 添加静态缓存</span></span><br><span class="line">  ev.<span class="title function_">waitUntil</span>(</span><br><span class="line">    caches.<span class="title function_">open</span>(<span class="variable constant_">CACHE_STATIC_NAME</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">cache</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> cache.<span class="title function_">addAll</span>(staticUrls);</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&quot;fetch&quot;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">  ev.<span class="title function_">respondWith</span>(</span><br><span class="line">    caches.<span class="title function_">match</span>(ev.<span class="property">request</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">cacheResponse</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 匹配到了缓存就使用缓存</span></span><br><span class="line">      <span class="keyword">if</span> (cacheResponse) <span class="keyword">return</span> cacheResponse;</span><br><span class="line">      <span class="comment">// 没匹配到就直接请求</span></span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">fetch</span>(ev.<span class="property">request</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h2 id="添加动态资源缓存"><a href="#添加动态资源缓存" class="headerlink" title="添加动态资源缓存"></a>添加动态资源缓存</h2><p>这里的动态资源特指变化周期很短的资源，但即使是变化很快的动态资源，如果它很大，也会影响到页面的加载速度，<br>所以可以将动态资源缓存到内存中，自定义一个较短的过期时间，过期后重新缓存。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// serviceWorker.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 静态缓存库名称</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CACHE_STATIC_NAME</span> = <span class="string">&quot;blog_static_cache&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 动态缓存库名称</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CACHE_NAME</span> = <span class="string">&quot;blog_cache&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 静态资源url数组，存放永久/长久不变的静态资源url</span></span><br><span class="line"><span class="keyword">const</span> staticUrls = [</span><br><span class="line">  <span class="string">&quot;/index.html&quot;</span>, <span class="comment">// 永久缓存网站首页</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 动态资源url的Map对象，存放内容容易变化的资源url以及上次缓存的时间戳</span></span><br><span class="line"><span class="keyword">const</span> dynamicUrls = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判断缓存是否过期</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Request</span>&#125; req // 请求对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; parameter // 配置对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">Promise&lt;Boolean&gt;</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isCacheExpired</span>(<span class="params">req, parameter = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> neededParms = <span class="title class_">Object</span>.<span class="title function_">assign</span>(</span><br><span class="line">    &#123;&#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">timeout</span>: <span class="number">8</span> * <span class="number">3600</span>, <span class="comment">// 超时时间，默认8个小时</span></span><br><span class="line">    &#125;,</span><br><span class="line">    parameter</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> expired = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">let</span> prevTimestamp = dynamicUrls.<span class="title function_">get</span>(req.<span class="property">url</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (prevTimestamp) &#123;</span><br><span class="line">    <span class="keyword">let</span> currentTimestamp = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="keyword">let</span> flag = currentTimestamp &gt; prevTimestamp + neededParms.<span class="property">timeout</span> * <span class="number">1000</span>;</span><br><span class="line">    expired = flag;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    expired = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(expired);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判断缓存是否是静态缓存</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; url 请求的url</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string[]</span>&#125; staticUrls 静态缓存url数组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Boolean</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isUrlStaticCache</span>(<span class="params">url, staticUrls</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> find = staticUrls.<span class="title function_">find</span>(<span class="function">(<span class="params">staticUrl</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">encodeURIComponent</span>(url).<span class="title function_">includes</span>(<span class="built_in">encodeURIComponent</span>(staticUrl));</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">if</span> (find) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判断url是否在当前域</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; url 请求的url</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Boolean</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isUrlCurrentOrigin</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> url.<span class="title function_">includes</span>(self.<span class="property">location</span>.<span class="property">origin</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&quot;install&quot;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ServiceWorker install&quot;</span>);</span><br><span class="line">  <span class="comment">// 添加静态缓存</span></span><br><span class="line">  ev.<span class="title function_">waitUntil</span>(</span><br><span class="line">    caches.<span class="title function_">open</span>(<span class="variable constant_">CACHE_STATIC_NAME</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">cache</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> cache.<span class="title function_">addAll</span>(staticUrls);</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&quot;fetch&quot;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">  ev.<span class="title function_">respondWith</span>(</span><br><span class="line">    caches.<span class="title function_">match</span>(ev.<span class="property">request</span>).<span class="title function_">then</span>(<span class="keyword">async</span> (cacheResponse) =&gt; &#123;</span><br><span class="line">      <span class="comment">// 有缓存</span></span><br><span class="line">      <span class="keyword">if</span> (cacheResponse) &#123;</span><br><span class="line">        <span class="comment">// 如果缓存是静态缓存，则直接返回</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isUrlStaticCache</span>(ev.<span class="property">request</span>.<span class="property">url</span>, staticUrls)) <span class="keyword">return</span> cacheResponse;</span><br><span class="line">        <span class="comment">// 如果是非静态缓存，则判断是否过期，过期则更新缓存</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">let</span> expired = <span class="keyword">await</span> <span class="title function_">isCacheExpired</span>(ev.<span class="property">request</span>);</span><br><span class="line">          <span class="keyword">if</span> (expired) &#123;</span><br><span class="line">            <span class="comment">// 更新缓存</span></span><br><span class="line">            <span class="keyword">let</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(ev.<span class="property">request</span>);</span><br><span class="line">            <span class="keyword">const</span> responseClone = response.<span class="title function_">clone</span>();</span><br><span class="line">            <span class="keyword">let</span> cache = <span class="keyword">await</span> caches.<span class="title function_">open</span>(<span class="variable constant_">CACHE_NAME</span>);</span><br><span class="line">            cache.<span class="title function_">put</span>(ev.<span class="property">request</span>, responseClone);</span><br><span class="line">            dynamicUrls.<span class="title function_">set</span>(ev.<span class="property">request</span>.<span class="property">url</span>, <span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br><span class="line">            <span class="keyword">return</span> response;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> cacheResponse;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 没有缓存</span></span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isUrlCurrentOrigin</span>(ev.<span class="property">request</span>.<span class="property">url</span>)) &#123;</span><br><span class="line">          <span class="comment">// 添加缓存</span></span><br><span class="line">          <span class="keyword">let</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(ev.<span class="property">request</span>);</span><br><span class="line">          <span class="keyword">const</span> responseClone = response.<span class="title function_">clone</span>();</span><br><span class="line">          <span class="keyword">let</span> cache = <span class="keyword">await</span> caches.<span class="title function_">open</span>(<span class="variable constant_">CACHE_NAME</span>);</span><br><span class="line">          cache.<span class="title function_">put</span>(ev.<span class="property">request</span>, responseClone);</span><br><span class="line">          dynamicUrls.<span class="title function_">set</span>(ev.<span class="property">request</span>.<span class="property">url</span>, <span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br><span class="line">          <span class="keyword">return</span> response;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">fetch</span>(ev.<span class="property">request</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>做一个自娱自乐的模拟大乐透彩票的程序</title>
    <url>/2023/07/14/%E5%81%9A%E4%B8%80%E4%B8%AA%E8%87%AA%E5%A8%B1%E8%87%AA%E4%B9%90%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%A7%E4%B9%90%E9%80%8F%E5%BD%A9%E7%A5%A8%E7%9A%84%E7%A8%8B%E5%BA%8F/</url>
    <content><![CDATA[<p>模拟大乐透彩票</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025378_5b4bc8fe4ed9c2ce19f653958b3aca20.png"
                     
                ></p>
<span id="more"></span>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025379_9b633e6a11cbc756a4579d0c81f7101a.png"
                     
                ></p>
<p><a class="link"   href="https://github.com/GJYyyyy/drawPrize" >github 地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://gjyyyyy.github.io/drawPrize/" >预览地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>玩具</tag>
      </tags>
  </entry>
  <entry>
    <title>前端导出各种Office文档</title>
    <url>/2025/05/30/%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BA%E5%90%84%E7%A7%8DOffice%E6%96%87%E6%A1%A3/</url>
    <content><![CDATA[<p>近来业务上出现了很多关于导出 Office 文档的需求，比如导出 Excel、Word、PDF 等，所以就写了一个简单的整合工具，方便使用。</p>
<p><a class="link"   href="https://github.com/GJYyyyy/getOffice" >github 地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.npmjs.com/package/get-office" >npm 地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>前端模块化理解</title>
    <url>/2024/02/26/%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96%E7%90%86%E8%A7%A3/</url>
    <content><![CDATA[<p>持续补充中…</p>
<p>模块化是为了更高效地复用代码，减少重复代码，提高代码的可读性，可维护性，可复用性。<br>javascript 中的模块化有多种实现方式，本文主要介绍 CommonJS、AMD、CMD、ES6 模块化以及 UMD（通用模块定义）。</p>
<span id="more"></span>

<h1 id="模块化分类"><a href="#模块化分类" class="headerlink" title="模块化分类"></a>模块化分类</h1><h3 id="按端分类"><a href="#按端分类" class="headerlink" title="按端分类"></a>按端分类</h3><ul>
<li>服务端<br>CommonJS</li>
<li>浏览器端<br>AMD、CMD、ES6 Module</li>
</ul>
<h3 id="按同步异步分类"><a href="#按同步异步分类" class="headerlink" title="按同步异步分类"></a>按同步异步分类</h3><ul>
<li>同步<br>CommonJS</li>
<li>异步<br>AMD、CMD、ES6 Module</li>
</ul>
<h3 id="按是否可以条件加载分类"><a href="#按是否可以条件加载分类" class="headerlink" title="按是否可以条件加载分类"></a>按是否可以条件加载分类</h3><ul>
<li>可以条件加载<br>CommonJS、AMD、CMD</li>
<li>不能条件加载<br>ES6 Module</li>
</ul>
<h1 id="CommonJS（CJS）"><a href="#CommonJS（CJS）" class="headerlink" title="CommonJS（CJS）"></a>CommonJS（CJS）</h1><p>CommonJS 是服务器端模块化的一种实现方式，最初是由 Node.js 团队实现的，它通过 require()和 exports()来实现模块的加载和使用。</p>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul>
<li>在服务端使用</li>
<li><strong><em>导出的模块为原始值的复制或深拷贝（重点）</em></strong></li>
</ul>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p><strong>目录结构：</strong></p>
<ul>
<li>main.js</li>
<li>module1.js</li>
<li>module2.js</li>
</ul>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// module1.js</span></span><br><span class="line"><span class="keyword">let</span> name1 = <span class="string">&quot;模块1&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">introduce1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我是<span class="subst">$&#123;name1&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// exports = &#123; name1, introduce1 &#125;; // 导出方式1，不建议使用</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; name1, introduce1 &#125;; <span class="comment">// 导出方式1</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// module2.js</span></span><br><span class="line"><span class="keyword">let</span> name2 = <span class="string">&quot;模块2&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">introduce2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我是<span class="subst">$&#123;name2&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// exports = &#123; name2, introduce2 &#125;; // 导出方式1，不建议使用</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; name2, introduce2 &#125;; <span class="comment">// 导出方式1</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="comment">// const module = require(&#x27;./module.js&#x27;); // 引入方式1</span></span><br><span class="line"><span class="keyword">const</span> &#123; name1, introduce1 &#125; = <span class="built_in">require</span>(<span class="string">&quot;./module1.js&quot;</span>); <span class="comment">// 引入方式2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name1);</span><br><span class="line"><span class="title function_">introduce1</span>(); <span class="comment">// 我是模块1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; name2, introduce2 &#125; = <span class="built_in">require</span>(<span class="string">&quot;./module2.js&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name2);</span><br><span class="line"><span class="title function_">introduce2</span>(); <span class="comment">// 我是模块2</span></span><br></pre></td></tr></table></figure></div>

<h1 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h1><p>AMD 是浏览器端模块化的一种实现方式，最早是由 RequireJS 团队实现的，它通过 define()和 require()来实现模块的加载和使用。<br><a class="link"   href="https://requirejs.org/" >RequireJS 官网 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h3><ul>
<li>不能按需加载（和 CMD 相比）<br>AMD 的依赖只要声明了就会被加载</li>
</ul>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><p><strong>目录结构：</strong></p>
<ul>
<li>index.html</li>
<li>js<ul>
<li>main.js</li>
<li>require2.3.6.js</li>
<li>lib<ul>
<li>module1.js</li>
<li>module2.js</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/require2.3.6.js&quot;</span> <span class="attr">data-main</span>=<span class="string">&quot;js/main&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="built_in">require</span>.<span class="title function_">config</span>(&#123;</span><br><span class="line">  <span class="attr">baseUrl</span>: <span class="string">&quot;js/lib&quot;</span>,</span><br><span class="line">  <span class="comment">// 配置一些模块引用别名</span></span><br><span class="line">  <span class="comment">// paths: &#123;</span></span><br><span class="line">  <span class="comment">//     &quot;module3&quot;: &quot;a/b/c/module3.long.name.min&quot;,  //实际路径为js/lib/a/b/c/module3.long.name.min.js</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>([<span class="string">&quot;module1&quot;</span>], <span class="keyword">function</span> (<span class="params">module1</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(module1.<span class="property">name1</span>);</span><br><span class="line">  module1.<span class="title function_">introduce1</span>();</span><br><span class="line">  module1.<span class="title function_">myFriend</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// module1.js</span></span><br><span class="line"><span class="title function_">define</span>([<span class="string">&quot;module2&quot;</span>], <span class="keyword">function</span> (<span class="params">module2</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> name1 = <span class="string">&quot;模块1&quot;</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">introduce1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我是<span class="subst">$&#123;name1&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">myFriend</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我是<span class="subst">$&#123;name1&#125;</span>，我的朋友是<span class="subst">$&#123;module2.name2&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    name1,</span><br><span class="line">    introduce1,</span><br><span class="line">    myFriend,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// module2.js</span></span><br><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> name2 = <span class="string">&quot;模块2&quot;</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">introduce2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我是<span class="subst">$&#123;name2&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    name2,</span><br><span class="line">    introduce2,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h1 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h1><p>CMD 是浏览器端模块化的一种实现方式，最早是由 SeaJS 团队实现的，它通过 define()和 require()来实现模块的加载和使用。<br><a class="link"   href="https://seajs.github.io/seajs/" >SeaJS 官网 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="特点-2"><a href="#特点-2" class="headerlink" title="特点"></a>特点</h3><ul>
<li>可以按需加载（和 AMD 相比）<br>CMD 的依赖仅在需要使用时主动声明才会被加载</li>
</ul>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><p><strong>目录结构：</strong></p>
<ul>
<li>index.html</li>
<li>js<ul>
<li>main.js</li>
<li>sea.js</li>
<li>lib<ul>
<li>module1.js</li>
<li>module2.js</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/sea.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// seajs 的简单配置</span></span></span><br><span class="line"><span class="language-javascript">      seajs.<span class="title function_">config</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">base</span>: <span class="string">&quot;./js/lib&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 配置一些模块引用别名</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// alias: &#123;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//     &quot;module3&quot;: &quot;a/b/c/module3.long.name.min&quot;,  //实际路径为js/lib/a/b/c/module3.long.name.min.js</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// &#125;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 加载入口模块</span></span></span><br><span class="line"><span class="language-javascript">      seajs.<span class="title function_">use</span>(<span class="string">&quot;./js/main&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span> (<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="variable language_">module</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> module1 = <span class="built_in">require</span>(<span class="string">&quot;module1&quot;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(module1.<span class="property">name1</span>);</span><br><span class="line">  module1.<span class="title function_">introduce1</span>();</span><br><span class="line">  module1.<span class="title function_">myFriend</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// module1.js</span></span><br><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span> (<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="variable language_">module</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> name1 = <span class="string">&quot;模块1&quot;</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">introduce1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我是<span class="subst">$&#123;name1&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> module2 = <span class="built_in">require</span>(<span class="string">&quot;module2&quot;</span>);</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">myFriend</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我是<span class="subst">$&#123;name1&#125;</span>，我的朋友是<span class="subst">$&#123;module2.name2&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    name1,</span><br><span class="line">    introduce1,</span><br><span class="line">    myFriend,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// module2.js</span></span><br><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span> (<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="variable language_">module</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> name2 = <span class="string">&quot;模块2&quot;</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">introduce2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我是<span class="subst">$&#123;name2&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    name2,</span><br><span class="line">    introduce2,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h1 id="ES6-Module（ESM）"><a href="#ES6-Module（ESM）" class="headerlink" title="ES6 Module（ESM）"></a>ES6 Module（ESM）</h1><p>ES6 Module 是浏览器端模块化的一种实现方式，是在语言层面上的实现的模块化标准，它通过 import 和 export 来实现模块的加载和使用。</p>
<h3 id="特点-3"><a href="#特点-3" class="headerlink" title="特点"></a>特点</h3><ul>
<li>不能条件加载<br><em>ES6 的模块不是对象，import 命令会被 JavaScript 引擎静态分析，在编译时就引入模块代码，而不是在代码运行时加载，所以无法实现条件加载。也正因为这个，使得静态分析成为可能。</em></li>
<li>兼容性问题<br>目前谷歌浏览器已原生支持 ESM，但是考虑到不同用户的浏览器版本参差不齐，所以兼容性还是要考虑的首要问题</li>
<li>需要服务器环境<br>通过文件协议访问网页不能使用 ESM</li>
</ul>
<h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><p><strong>目录结构：</strong></p>
<ul>
<li>public<ul>
<li>index.html</li>
<li>main.js</li>
<li>module1.js</li>
<li>module2.js</li>
</ul>
</li>
<li>node_modules<ul>
<li>http-server：因为 ESM 需要部署在服务器，所以使用该第三方库来开启服务</li>
</ul>
</li>
</ul>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ESM模块的代码必须声明type=&quot;module&quot;，否则会报错 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">import</span> <span class="string">&quot;./main.js&quot;</span>; <span class="comment">// 不引入模块的导入方式，被导入的脚本自动执行</span></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; name1 <span class="keyword">as</span> newName, introduce1 &#125; <span class="keyword">from</span> <span class="string">&quot;./module1.js&quot;</span>; <span class="comment">// 通过 export 方式导出的模块可以通过解构方式导入，并且支持别名</span></span><br><span class="line"><span class="keyword">import</span> module2 <span class="keyword">from</span> <span class="string">&quot;./module2.js&quot;</span>; <span class="comment">// 通过 export default 方式导出的模块只能通过这种方式导入</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newName);</span><br><span class="line"><span class="title function_">introduce1</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(module2.<span class="property">name2</span>);</span><br><span class="line">module2.<span class="title function_">introduce2</span>();</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// module1.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> name1 = <span class="string">&quot;模块1&quot;</span>; <span class="comment">// 通过 export 方式导出</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过 export 方式导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">introduce1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我是<span class="subst">$&#123;name1&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// module2.js</span></span><br><span class="line"><span class="keyword">let</span> name2 = <span class="string">&quot;模块2&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">introduce2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我是<span class="subst">$&#123;name2&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过 export default 方式导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name2,</span><br><span class="line">  introduce2,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<h1 id="UMD"><a href="#UMD" class="headerlink" title="UMD"></a>UMD</h1><p>UMD（Universal Module Definition）并非是一个实现模块化的第三方库，<br>它只是一种用来编写 javascrit 库的通用模式，该模式会自动判断当前环境应该使用什么模块化标准，<br>比如 JQuery 就使用了 UMD 模式，所以它在 CommonJS、AMD、CMD、ES6 Module 模块化标准中都可以使用</p>
<h3 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h3><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    这个示例中，一个自调用函数将整个模块包裹起来，并判断当前环境的模块化标准，</span></span><br><span class="line"><span class="comment">    如果是AMD标准，则使用define定义模块并返回，</span></span><br><span class="line"><span class="comment">    如果是CommonJS标准，则使用module.exports返回模块</span></span><br><span class="line"><span class="comment">    否则将模块挂载到root（window）对象上</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span> (<span class="params">root, factory</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> define === <span class="string">&quot;function&quot;</span> &amp;&amp; define.<span class="property">amd</span>) &#123;</span><br><span class="line">    <span class="comment">// AMD</span></span><br><span class="line">    <span class="title function_">define</span>([<span class="string">&quot;exports&quot;</span>], factory);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">exports</span> === <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">    <span class="comment">// Node, CommonJS-like</span></span><br><span class="line">    <span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">factory</span>();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// Browser globals (root is window)</span></span><br><span class="line">    root.<span class="property">MyModule</span> = <span class="title function_">factory</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)(<span class="variable language_">this</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 模块的实际代码</span></span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">MyModule</span> = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title class_">MyModule</span>.<span class="property">someFunction</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 实现一些功能</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">MyModule</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul>
<li><a class="link"   href="https://juejin.cn/post/6844903576309858318?searchId=20240226143545322FA68BF5F7604FEC42" >前端模块化：CommonJS,AMD,CMD,ES6 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li><a class="link"   href="https://es6.ruanyifeng.com/#docs/module-loader" >Module 的加载实现 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li><a class="link"   href="https://juejin.cn/post/6935973925004247077?searchId=202402261543097D55D3E544DCAB5A77E8#heading-2" >【面试说】Javascript 中的 CJS, AMD, UMD 和 ESM 是什么？ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li><a class="link"   href="https://juejin.cn/post/6994224541312483336?searchId=20240226165805B8343DE824157A6A0771#heading-4" >「万字进阶」深入浅出 Commonjs 和 Es Module <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
</ul>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>前端跨域请求配置及Cookie</title>
    <url>/2023/12/27/%E5%89%8D%E7%AB%AF%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82%E9%85%8D%E7%BD%AE%E5%8F%8ACookie/</url>
    <content><![CDATA[<h1 id="常用跨域与非跨域请求配置"><a href="#常用跨域与非跨域请求配置" class="headerlink" title="常用跨域与非跨域请求配置"></a>常用跨域与非跨域请求配置</h1><p>通常情况下，跨域请求都需要 <strong><em>后端配合</em></strong> 返回响应头，让浏览器允许跨域请求。<br>下面用 ES6 的 <em>fetch</em> 来举例：</p>
<hr>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1. 一般跨域请求，需要后端配合，需要返回响应头：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Access-Control-Allow-Origin: * 或 具体域名</span></span><br><span class="line"><span class="comment">Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;www.example.com&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;cors&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2. 携带用户凭证(Cookie)的跨域请求，需要后端配合，需要返回响应头：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Access-Control-Allow-Origin: 必须是具体域名</span></span><br><span class="line"><span class="comment">Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS</span></span><br><span class="line"><span class="comment">Access-Control-Allow-Credentials: true</span></span><br><span class="line"><span class="comment">Access-Control-Allow-Headers: Cookie</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;www.example.com&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;cors&quot;</span>,</span><br><span class="line">  <span class="attr">credentials</span>: <span class="string">&quot;include&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3. 同域简单请求，不需要后端配合设置响应头，</span></span><br><span class="line"><span class="comment">不能用自定义请求头，自然也不能携带Cookie，</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;www.example.com&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;no-cors&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4. 同域普通请求，不需要后端配合设置响应头，</span></span><br><span class="line"><span class="comment">可以用自定义请求头，可以能携带Cookie，</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;www.example.com&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;same-origin&quot;</span>,</span><br><span class="line">  <span class="attr">credentials</span>: <span class="string">&quot;include&quot;</span>, <span class="comment">// 可以发也可以不发用户凭证(Cookie)</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h1 id="no-cors-与-same-origin-的对比"><a href="#no-cors-与-same-origin-的对比" class="headerlink" title="no-cors 与 same-origin 的对比"></a>no-cors 与 same-origin 的对比</h1><table>
<thead>
<tr>
<th>特性</th>
<th>no-cors</th>
<th>same-origin</th>
</tr>
</thead>
<tbody><tr>
<td>请求类型</td>
<td>只能是简单请求(GET、POST、HEAD)</td>
<td>可以是简单请求或复杂请求</td>
</tr>
<tr>
<td>是否允许跨域</td>
<td>不允许跨域</td>
<td>只适用于同源请求</td>
</tr>
<tr>
<td>允许发送的头信息</td>
<td>受到严格限制，不能使用自定义请求头，并且头信息内容也受到限制，比如 Content-Type 只能是 application&#x2F;x-www-form-urlencoded、multipart&#x2F;form-data 或 text&#x2F;plain</td>
<td>更灵活，可以发送自定义头信息</td>
</tr>
<tr>
<td>是否发送用户凭证</td>
<td>不发送用户凭证(Cookie)</td>
<td>可以发送也可以不发送(Cookie)</td>
</tr>
<tr>
<td>响应内容的访问权限</td>
<td>不允许 JavaScript 获取响应内容</td>
<td>可以通过 JavaScript 获取响应内容</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>Axios</tag>
        <tag>Ajax</tag>
        <tag>Fetch</tag>
        <tag>Cookie</tag>
        <tag>跨域</tag>
      </tags>
  </entry>
  <entry>
    <title>各种常见乱码的产生原因</title>
    <url>/2024/06/11/%E5%90%84%E7%A7%8D%E5%B8%B8%E8%A7%81%E4%B9%B1%E7%A0%81%E7%9A%84%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0/</url>
    <content><![CDATA[<p>先引入一张我个人认为比较在理的图，总结的很完善<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1718098045082_9dad3d8e91235e1ff38c1125482058c1.jpg"
                     
                ></p>
<span id="more"></span>

<p>根据途中所示，乱码分为下面这几种常见原因：</p>
<table>
<thead>
<tr>
<th>乱码名称</th>
<th>示例</th>
<th>特点</th>
<th>产生原因</th>
</tr>
</thead>
<tbody><tr>
<td>古文码</td>
<td>见图</td>
<td>大都为不认识的古文，并加杂日韩文</td>
<td>以GBK方式读取UTF-8编码的中文</td>
</tr>
<tr>
<td>口字码</td>
<td>见图</td>
<td>大部分字符为小方块</td>
<td>以UTF-8的方式读取GBK编码的中文</td>
</tr>
<tr>
<td>符号码</td>
<td>见图</td>
<td>大部分字符为各种符号</td>
<td>以ISO8859-1方式读取UTF-8扁码的中文</td>
</tr>
<tr>
<td>拼音码</td>
<td>见图</td>
<td>大部分字符为头顶带有各种类似声调符号的字母</td>
<td>以ISO8859-1方式读取GBK编码的中文</td>
</tr>
<tr>
<td>问句码</td>
<td>见图</td>
<td>字符串长度为偶数时正确,长度为奇教时最后的字符变为问号</td>
<td>以GBK方式读取UTF-8编码的中文，然后又用UTF-8的格式再次读取</td>
</tr>
<tr>
<td>锟拷码</td>
<td>见图</td>
<td>全中文字符，且大部分字符为“锟斤拷”这几个字符</td>
<td>以UTF-8方式读取GBK编码的中文，然后又用GBK的格式再次读取</td>
</tr>
</tbody></table>
<p>最后，知道了产生乱码的原因，就能解决乱码问题了</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>VSCode</tag>
        <tag>乱码</tag>
      </tags>
  </entry>
  <entry>
    <title>在ECharts中画一个带边框的渐变柱状图</title>
    <url>/2024/04/26/%E5%9C%A8ECharts%E4%B8%AD%E7%94%BB%E4%B8%80%E4%B8%AA%E5%B8%A6%E8%BE%B9%E6%A1%86%E7%9A%84%E6%B8%90%E5%8F%98%E6%9F%B1%E7%8A%B6%E5%9B%BE/</url>
    <content><![CDATA[<p>预览图</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025383_03a3fc7acc250065b41b77ad129aa7f0.png"
                     
                ></p>
<span id="more"></span>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 这里使用的是echarts.js@4.1.0</span></span><br><span class="line"><span class="keyword">import</span> echarts <span class="keyword">from</span> <span class="string">&quot;echarts&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 生成一个ECharts柱状图</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Element</span>&#125; el 挂载元素</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; data 数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">echarts.ECharts</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">genEcharts1</span>(<span class="params">el, data</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> echartsIns = echarts.<span class="title function_">init</span>(el);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> option = &#123;</span><br><span class="line">    <span class="attr">xAxis</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;category&quot;</span>,</span><br><span class="line">      <span class="attr">data</span>: [<span class="string">&quot;一级&quot;</span>, <span class="string">&quot;二级&quot;</span>, <span class="string">&quot;三级&quot;</span>, <span class="string">&quot;四级&quot;</span>, <span class="string">&quot;五级&quot;</span>],</span><br><span class="line">      <span class="attr">axisTick</span>: &#123;</span><br><span class="line">        <span class="attr">show</span>: <span class="literal">false</span>, <span class="comment">// 不显示横坐标刻度</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">axisLabel</span>: &#123;</span><br><span class="line">        <span class="attr">color</span>: <span class="string">&quot;#90B6E2&quot;</span>, <span class="comment">// 设置横坐标标题的颜色</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">axisLine</span>: &#123;</span><br><span class="line">        <span class="attr">lineStyle</span>: &#123;</span><br><span class="line">          <span class="attr">color</span>: <span class="string">&quot;#3868A0&quot;</span>, <span class="comment">// 设置横坐标线的颜色</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">yAxis</span>: &#123;</span><br><span class="line">      <span class="attr">show</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;value&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">series</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// data: [120, 200, 150, 80, 70],</span></span><br><span class="line">        data,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;bar&quot;</span>,</span><br><span class="line">        <span class="attr">barWidth</span>: <span class="number">15</span>,</span><br><span class="line">        <span class="attr">label</span>: &#123;</span><br><span class="line">          <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 展示柱状图数值</span></span><br><span class="line">          <span class="attr">position</span>: <span class="string">&quot;top&quot;</span>, <span class="comment">// 设置柱状图数值位置</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&quot;#BADAFF&quot;</span>, <span class="comment">// 设置柱状图数值颜色</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">          <span class="attr">borderWidth</span>: <span class="number">1</span>, <span class="comment">// 柱状图边框宽度</span></span><br><span class="line">          <span class="attr">borderColor</span>: <span class="keyword">new</span> echarts.<span class="property">graphic</span>.<span class="title class_">LinearGradient</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, [</span><br><span class="line">            <span class="comment">// 柱状图边框颜色</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">offset</span>: <span class="number">0</span>,</span><br><span class="line">              <span class="attr">color</span>: <span class="string">&quot;#8DC0FD&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">offset</span>: <span class="number">1</span>,</span><br><span class="line">              <span class="attr">color</span>: <span class="string">&quot;#8DC0FD88&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          ]),</span><br><span class="line">          <span class="attr">color</span>: <span class="keyword">new</span> echarts.<span class="property">graphic</span>.<span class="title class_">LinearGradient</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, [</span><br><span class="line">            <span class="comment">// 柱状图柱子颜色</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">offset</span>: <span class="number">0</span>,</span><br><span class="line">              <span class="attr">color</span>: <span class="string">&quot;#3D8AE7&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">offset</span>: <span class="number">1</span>,</span><br><span class="line">              <span class="attr">color</span>: <span class="string">&quot;rgba(98,160,234,0.4)&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          ]),</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  echartsIns.<span class="title function_">setOption</span>(option);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> echartsIns;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用函数</span></span><br><span class="line"><span class="keyword">const</span> data = [<span class="number">120</span>, <span class="number">200</span>, <span class="number">150</span>, <span class="number">80</span>, <span class="number">70</span>];</span><br><span class="line"><span class="keyword">const</span> el = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;echarts1&quot;</span>);</span><br><span class="line"><span class="title function_">genEcharts1</span>(el, data);</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>特效</tag>
        <tag>ECharts</tag>
      </tags>
  </entry>
  <entry>
    <title>在Ubuntu上部署和使用deepseek-r1:1.5b</title>
    <url>/2025/02/25/%E5%9C%A8Ubuntu%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%92%8C%E4%BD%BF%E7%94%A8deepseek-r1-1-5b/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>如果已经安装了宝塔面板，那么可以直接使用宝塔面板的软件商店来安装 DeepSeek-R1。</p>
<h1 id="下载-Ollama"><a href="#下载-Ollama" class="headerlink" title="下载 Ollama"></a>下载 Ollama</h1><p>去 <a class="link"   href="https://ollama.com/" >Ollama 官网 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 下载 Ollama。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">curl -fsSL https://ollama.com/install.sh | sh</span><br></pre></td></tr></table></figure></div>

<p>下载过程很慢且可能会出现网络错误，可以尝试使用代理（参考<a href="/2023/09/15/%E4%BD%BF%E7%94%A8AWS-EC2-%E9%85%8D%E7%BD%AESSTap%E6%9C%8D%E5%8A%A1/">使用 AWS EC2 配置 SSTap 服务</a>）或者使用镜像源。</p>
<h2 id="无法开机问题"><a href="#无法开机问题" class="headerlink" title="无法开机问题"></a>无法开机问题</h2><p>Ollama 安装过程中会自动更新显卡驱动和其他一些配置，在显卡硬件版本过低的情况下，主机重启会出现无法开机的问题。<br>为了解决这个问题，需要做如下操作：</p>
<ol>
<li><p>进入恢复模式<br>开机后一直点击 shift 键，直到出现选择启动方式界面，选择带有(recovery)的启动方式</p>
</li>
<li><p>删除所有 NVIDIA 显卡驱动</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">apt purge nvidia-*</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>清理残留配置</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">apt autoremove</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>安装 ubuntu-drivers</p>
<p>如果网卡也被 Ollama 影响而不能自启动，需要先临时启动网卡</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 先查看网卡信息</span></span><br><span class="line">ip <span class="built_in">link</span> show</span><br><span class="line"><span class="comment"># 然后设置网卡为 up</span></span><br><span class="line">ip <span class="built_in">link</span> <span class="built_in">set</span> enpXsX up</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">install ubuntu-drivers-common</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>安装所有适配当前硬件的驱动</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">ubuntu-drivers autoinstall</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>安装 netplan</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">apt install netplan.io</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>检查 Netplan 配置</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/netplan/*.yaml</span><br></pre></td></tr></table></figure></div>

<p>为主网卡 enpXsX 启用 DHCP</p>
<div class="highlight-container" data-rel="Yaml"><figure class="iseeu highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">network:</span></span><br><span class="line"><span class="attr">version:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">ethernets:</span></span><br><span class="line">  <span class="attr">enpXsX:</span></span><br><span class="line">    <span class="attr">dhcp4:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>应用 netplan 配置</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">netplan apply</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>安装防火墙工具</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 检查 ufw 状态</span></span><br><span class="line">ufw status</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果没有安装 ufw，则需要安装</span></span><br><span class="line">apt update</span><br><span class="line">apt install ufw</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>重启</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure></div></li>
</ol>
<h1 id="下载-AI-模型"><a href="#下载-AI-模型" class="headerlink" title="下载 AI 模型"></a>下载 AI 模型</h1><p>这里下载的是 deepseek-r1:1.5b，如果想下载其他 AI 模型，请参考 <a class="link"   href="https://ollama.com/search" >Ollama Models <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 下载并运行 deepseek-r1:1.5b</span></span><br><span class="line"><span class="comment"># 运行成功后，ollama会开启一个命令行对话窗口，根据提示使用即可</span></span><br><span class="line">ollama run deepseek-r1:1.5b</span><br></pre></td></tr></table></figure></div>

<p>下载过程很慢且可能会出现网络错误，可以尝试使用代理（参考<a href="/2023/09/15/%E4%BD%BF%E7%94%A8AWS-EC2-%E9%85%8D%E7%BD%AESSTap%E6%9C%8D%E5%8A%A1/">使用 AWS EC2 配置 SSTap 服务</a>）或者使用镜像源。</p>
<h2 id="开启-API"><a href="#开启-API" class="headerlink" title="开启 API"></a>开启 API</h2><p>纯命令行模式不太美观，所以开启 ollama 的服务，使其通过 http 协议暴露 API 接口，然后通过接口进行对话。</p>
<p>最新版本 Ollama 在安装后会自动部署为自启动服务，如果没有自动部署为服务，参考 <a class="link"   href="https://github.com/ollama/ollama/blob/main/docs/linux.md" >Ollama Linux <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 文档来手动部署为服务。</p>
<p>添加文件 <strong>&#x2F;etc&#x2F;systemd&#x2F;system&#x2F;ollama.service</strong>，内容如下</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Ollama Service</span><br><span class="line">After=network-online.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStart=/usr/bin/ollama serve</span><br><span class="line">User=ollama</span><br><span class="line">Group=ollama</span><br><span class="line">Restart=always</span><br><span class="line">RestartSec=3</span><br><span class="line">Environment=&quot;PATH=$PATH&quot;</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=default.target</span><br></pre></td></tr></table></figure></div>

<p>然后重载系统服务</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br></pre></td></tr></table></figure></div>

<p>部署为服务后，通过以下命令来操作 Ollama</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 启动服务</span></span><br><span class="line">systemctl start ollama.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭服务</span></span><br><span class="line">systemctl stop ollama.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看服务状态</span></span><br><span class="line">systemctl status ollama.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置服务自启动</span></span><br><span class="line">systemctl <span class="built_in">enable</span> ollama.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭服务自启动</span></span><br><span class="line">systemctl <span class="built_in">disable</span> ollama.service</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h2 id="使用-API"><a href="#使用-API" class="headerlink" title="使用 API"></a>使用 API</h2><p>使用以下命令来测试 Ollama 是否开启服务成功</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">curl http://localhost:11434/api/generate -d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">  &quot;model&quot;: &quot;deepseek-r1:1.5b&quot;,</span></span><br><span class="line"><span class="string">  &quot;prompt&quot;: &quot;你好，请介绍一下量子计算&quot;,</span></span><br><span class="line"><span class="string">  &quot;options&quot;: &#123;</span></span><br><span class="line"><span class="string">    &quot;temperature&quot;: 0.3,          // 降低随机性（原0.7 → 0.3）</span></span><br><span class="line"><span class="string">    &quot;num_ctx&quot;: 4096,              // 扩大上下文窗口（原2048 → 4096）</span></span><br><span class="line"><span class="string">    &quot;top_p&quot;: 0.5,                 // 新增：聚焦高概率词</span></span><br><span class="line"><span class="string">    &quot;num_predict&quot;: -1,            // 新增：允许最大长度输出</span></span><br><span class="line"><span class="string">    &quot;repeat_penalty&quot;: 1.2,        // 新增：抑制重复内容</span></span><br><span class="line"><span class="string">    &quot;seed&quot;: 12345                 // 新增：保持结果一致性</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://ollama.com/search" >Ollama Models <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://github.com/ollama/ollama/tree/main/docs" >Ollama docs <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
        <tag>AI</tag>
      </tags>
  </entry>
  <entry>
    <title>在VSCode下搭建一个SpringMVC项目</title>
    <url>/2024/06/17/%E5%9C%A8VSCode%E4%B8%8B%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AASpringMVC%E9%A1%B9%E7%9B%AE/</url>
    <content><![CDATA[<span id="more"></span>

<p><a href="/2023/06/08/%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8BJava%E7%9A%84%E5%9F%BA%E7%A1%80%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B/">前情提要 - 简单记录一下 Java 的基础开发过程</a></p>
<h1 id="SpringMVC-和-SpringBoot-的关系"><a href="#SpringMVC-和-SpringBoot-的关系" class="headerlink" title="SpringMVC 和 SpringBoot 的关系"></a>SpringMVC 和 SpringBoot 的关系</h1><ul>
<li>SpringFramework（Spring 框架）<br>SpringFramework 是一个开源的 Java 应用程序框架，主要用于构建企业级应用程序。它提供了一系列的功能，如依赖注入（DI）、面向切面编程（AOP）、事务管理、安全性等。</li>
<li>SpringBoot<br>是 Spring 框架的一个子项目，旨在简化新 Spring 应用程序的初始设置、开发和部署。它使用“约定优于配置”的原则，通过提供大量的自动配置和插件来减少开发者的工作量。</li>
<li>SpringMVC<br>是 Spring 框架中的一个模块，用于构建基于 Java 的 Web 应用程序。它实现了 MVC（Model-View-Controller）设计模式，并提供了许多用于处理 Web 请求和响应的功能。</li>
</ul>
<h1 id="创建-SpringBoot-项目"><a href="#创建-SpringBoot-项目" class="headerlink" title="创建 SpringBoot 项目"></a>创建 SpringBoot 项目</h1><h2 id="使用官方工具创建新项目"><a href="#使用官方工具创建新项目" class="headerlink" title="使用官方工具创建新项目"></a>使用官方工具创建新项目</h2><p>建议使用 SpringBoot 官方工具 <a class="link"   href="https://start.spring.io/" >https://start.spring.io/ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 创建项目<br>这里选用的 SpringBoot 的版本为 3.2.7，java 版本为 17，项目管理器为 Maven</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1719393333425_1947c3b9c6ee3ebde74518cdb60683e0.png"
                     
                ></p>
<p>如果下载不了，<a href="/mypage/%E5%9C%A8VSCode%E4%B8%8B%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AASpringMVC%E9%A1%B9%E7%9B%AE/demo.zip">可以点击这里下载备份包</a></p>
<p>其他依赖有：</p>
<ul>
<li>Spring Web<br>使用 Spring MVC 构建 web，包括 RESTful 应用程序。使用 Apache Tomcat 作为默认的嵌入式容器。</li>
<li>Spring Data JPA<br>使用 Spring data 和 Hibernate，使用 Java Persistence API 将数据持久化到 SQL 存储中。</li>
<li>MySQL Driver<br>MySQL JDBC 驱动程序。</li>
</ul>
<h3 id="配置数据库信息"><a href="#配置数据库信息" class="headerlink" title="配置数据库信息"></a>配置数据库信息</h3><p>修改配置文件 application.properties 如下：</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line">spring.application.name=demo</span><br><span class="line"></span><br><span class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/database?useUnicode=true&amp;characterEncoding=utf8</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=root</span><br><span class="line"></span><br><span class="line">spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect</span><br></pre></td></tr></table></figure></div>

<h3 id="本地启动项目"><a href="#本地启动项目" class="headerlink" title="本地启动项目"></a>本地启动项目</h3><div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 由插件 spring-boot-maven-plugin 提供的本地运行功能</span></span><br><span class="line">mvn spring<span class="literal">-boot</span>:run</span><br></pre></td></tr></table></figure></div>

<h2 id="手动创建-Maven-新项目"><a href="#手动创建-Maven-新项目" class="headerlink" title="手动创建 Maven 新项目"></a>手动创建 Maven 新项目</h2><p>参考<a href="/2023/06/08/%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8BJava%E7%9A%84%E5%9F%BA%E7%A1%80%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B/#%E6%89%8B%E5%8A%A8%E5%88%9B%E5%BB%BA-Maven-%E6%96%B0%E9%A1%B9%E7%9B%AE">手动创建 Maven 新项目</a></p>
<p><em>建议使用手动的方法来创建 SpringBoot 项目，因为目前不存在官方的 Maven 原型创建项目，官网的工具也不支持创建 SpringBoot2.7.5 版本了。</em></p>
<p>新建 pom.xml 文件，配置 SpringBoot2.7.5，要求 java11 版本</p>
<div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Maven项目的根元素，包含了POM的所有配置信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 指定POM模型的版本，对于Maven 2和Maven 3来说，它总是4.0.0 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的groupId，通常用于唯一标识项目的所属组织 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的artifactId，通常用于唯一标识项目的名称 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的版本号，用于标识项目的特定版本 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的打包方式，如jar、war等 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的名称，通常用于显示或引用项目时使用 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>My Spring Boot Project<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的描述，用于说明项目的用途、功能等 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Spring Boot and Spring MVC<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 父项目的坐标，用于继承父项目的配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 父POM的相对路径，如果为空，则表示从Maven中央仓库查找 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的一些属性配置，如Java版本等 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>11<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的依赖列表，用于声明项目所需的库和框架 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Spring Boot Starter Web 依赖，用于支持Spring MVC --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Spring Boot Starter Data JPA 依赖，用于支持JPA --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- MySQL JDBC 驱动依赖 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 根据需要添加的其他依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的构建配置，用于定义项目的构建过程 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Spring Boot Maven插件，用于打包和运行Spring Boot应用 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="基于-Maven-原型创建新项目"><a href="#基于-Maven-原型创建新项目" class="headerlink" title="基于 Maven 原型创建新项目"></a>基于 Maven 原型创建新项目</h2><p>使用 <strong><em>Ctrl+Shift+P</em></strong> 打开 VSCode 的命令，或者使用 GUI 中的 <strong><em>从 Maven 原型创建新项目</em></strong></p>
<h1 id="VSCode-插件"><a href="#VSCode-插件" class="headerlink" title="VSCode 插件"></a>VSCode 插件</h1><ul>
<li>Code Generator For Java<br>自动生成 getter&#x2F;setter 函数，使用**<em>Ctrl+Shift+P</em>** 打开 VSCode 的命令搜索 getter&#x2F;setter，或者使用 GUI 中的 <strong><em>Code Generator For Java</em></strong></li>
</ul>
<h1 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h1><h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><p>等待补充</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>VSCode</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>在Windows下使用CMake构建和管理第三方库</title>
    <url>/2024/10/29/%E5%9C%A8Windows%E4%B8%8B%E4%BD%BF%E7%94%A8CMake%E6%9E%84%E5%BB%BA%E5%92%8C%E7%AE%A1%E7%90%86%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/</url>
    <content><![CDATA[<h1 id="安装-CMake"><a href="#安装-CMake" class="headerlink" title="安装 CMake"></a>安装 CMake</h1><p><a class="link"   href="https://cmake.org/download/" >CMake 下载地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<ul>
<li><a class="link"   href="https://pan.baidu.com/s/1n0INmgUE01g38GT5ZSzmHA?pwd=a8cp" >cmake 百度云备份下载 cmake-3.30.5-windows-x86_64.zip <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li><a class="link"   href="https://pan.baidu.com/s/1Cj8XayhGY-5ri6Fyxe5O6A?pwd=su95" >cmake 百度云备份下载 cmake-3.30.6-windows-x86_64.zip <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li><a class="link"   href="https://pan.baidu.com/s/1BOn7S0dq7o38bf8WmeFtBg?pwd=ycxs" >cmake 百度云备份下载 cmake-3.31.2-windows-x86_64.zip <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
</ul>
<p>下载好后，放到磁盘中，然后配置系统变量即可在 CMD 或 PowerShell 中使用。</p>
<h1 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h1><p>目录结构</p>
<ul>
<li>src 源文件目录<ul>
<li>main.cpp 源文件</li>
</ul>
</li>
<li>include 头文件</li>
<li>lib 动态链接库<ul>
<li>your_lib1.dll</li>
<li>your_lib2.dll</li>
</ul>
</li>
<li>build 构建目录<ul>
<li>output 构建输出目录<ul>
<li>lib 动态链接库</li>
</ul>
</li>
</ul>
</li>
<li>CMakeLists.txt CMake 核心配置文件</li>
</ul>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Hello, World!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment"># CMakeLists.txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置CMake的最低版本要求</span></span><br><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置项目名称、版本号以及语言（C：C语言；CXX：C++语言）</span></span><br><span class="line"><span class="keyword">project</span>(MyProject VERSION <span class="number">1.0</span> LANGUAGES CXX)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定C++标准（可选，根据你的需要设置）</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">11</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD_REQUIRED <span class="keyword">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置各种目录</span></span><br><span class="line"><span class="comment"># CMAKE_SOURCE_DIR 表示项目的根目录</span></span><br><span class="line"><span class="comment"># CMAKE_BINARY_DIR 表示项目的构建目录，一般是build</span></span><br><span class="line"><span class="keyword">set</span>(SRC_PATH <span class="string">&quot;$&#123;CMAKE_SOURCE_DIR&#125;/src&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(INC_PATH <span class="string">&quot;$&#123;CMAKE_SOURCE_DIR&#125;/include&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(LIB_PATH <span class="string">&quot;$&#123;CMAKE_SOURCE_DIR&#125;/lib&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(OUT_PATH <span class="string">&quot;$&#123;CMAKE_BINARY_DIR&#125;/output&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(OUT_LIB_PATH <span class="string">&quot;$&#123;OUT_PATH&#125;/lib&quot;</span>) <span class="comment"># 自定义存放动态链接库的目录</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 包含头文件目录</span></span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;INC_PATH&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 匹配指定目录下的所有.cpp文件</span></span><br><span class="line"><span class="keyword">file</span>(GLOB SRC_FILES <span class="string">&quot;$&#123;SRC_PATH&#125;/*.cpp&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加编译选项</span></span><br><span class="line"><span class="keyword">add_compile_options</span>(-w) <span class="comment"># 屏蔽警告</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 引入conan生成的cmake文件</span></span><br><span class="line"><span class="keyword">include</span>(build/conandeps_legacy.cmake)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建目标可执行文件</span></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> <span class="variable">$&#123;SRC_FILES&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 链接动态链接库</span></span><br><span class="line"><span class="comment"># -lws2_32 是 winsock2 的库，httplib会使用</span></span><br><span class="line"><span class="comment"># -lgdi32 是window图形用户界面库</span></span><br><span class="line"><span class="comment"># CONANDEPS_LEGACY是conan生成的变量，包含引用的依赖库列表</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> ws2_32 gdi32 <span class="variable">$&#123;CONANDEPS_LEGACY&#125;</span>) <span class="comment"># 链接库</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果有lib库，就将lib库集成到项目中，而不是使用dll库，防止项目移植时的问题</span></span><br><span class="line"><span class="keyword">target_link_options</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PRIVATE</span><br><span class="line">    <span class="string">&quot;-static-libgcc&quot;</span></span><br><span class="line">    <span class="string">&quot;-static-libstdc++&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置目标属性</span></span><br><span class="line"><span class="keyword">set_target_properties</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PROPERTIES</span><br><span class="line">    RUNTIME_OUTPUT_DIRECTORY <span class="variable">$&#123;OUT_PATH&#125;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个自定义目标来复制DLLs到输出目录</span></span><br><span class="line"><span class="keyword">add_custom_target</span>(copy_dlls ALL</span><br><span class="line">    <span class="keyword">COMMAND</span> <span class="variable">$&#123;CMAKE_COMMAND&#125;</span> -E copy_if_different</span><br><span class="line">        <span class="variable">$&#123;LIB_PATH&#125;</span>/your_lib1.dll</span><br><span class="line">        <span class="variable">$&#123;OUT_LIB_PATH&#125;</span>/your_lib1.dll</span><br><span class="line">    <span class="keyword">COMMAND</span> <span class="variable">$&#123;CMAKE_COMMAND&#125;</span> -E copy_if_different</span><br><span class="line">        <span class="variable">$&#123;LIB_PATH&#125;</span>/your_lib2.dll</span><br><span class="line">        <span class="variable">$&#123;OUT_LIB_PATH&#125;</span>/your_lib2.dll</span><br><span class="line">    COMMENT <span class="string">&quot;Copying DLLs to output directory&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>

<h2 id="生成构建文件"><a href="#生成构建文件" class="headerlink" title="生成构建文件"></a>生成构建文件</h2><p>构建文件根据平台不同会有不同，这里仅介绍 Windows 下的 MinGW。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 进入到build目录再cmake可以方便的管理编译后的杂乱文件</span></span><br><span class="line"><span class="comment"># -G &quot;MinGW Makefiles&quot; 指定编译工具链为MinGW</span></span><br><span class="line">cmake .. -G <span class="string">&quot;MinGW Makefiles&quot;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="构建项目"><a href="#构建项目" class="headerlink" title="构建项目"></a>构建项目</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cmake --build 命令会智能的根据当前平台选择编译工具链，比如在安装了MinGW的Windows系统下，可能会选择使用mingw32-make</span></span><br><span class="line">cmake --build .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者直接使用 mingw32-make 命令</span></span><br><span class="line"><span class="comment"># 在cmake生成构建文件（Makefile）后，可以使用 MinGW 的 mingw32-make 命令来构建项目</span></span><br><span class="line">mingw32-make</span><br></pre></td></tr></table></figure></div>

<p>如果已经为 mingw32-make 创建了 make 的别名脚本文件<br>参考<a href="/2023/11/03/C-%E7%9F%A5%E8%AF%86%E7%82%B9%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA/#%E6%9E%84%E5%BB%BA%E9%A1%B9%E7%9B%AE">Makefile 构建项目</a></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">make</span><br></pre></td></tr></table></figure></div>

<h1 id="管理第三方库"><a href="#管理第三方库" class="headerlink" title="管理第三方库"></a>管理第三方库</h1><p>CMake 功能不足以满足管理第三方库，需要使用 conan 或者 vcpkg 来管理。</p>
<p>这里介绍 conan，参考<a href="/2024/12/11/c-%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8conan%E7%9A%84%E4%BD%BF%E7%94%A8/">c++包管理器 conan 的使用</a></p>
<p><strong>注意：不是所有的第三方库都可以通过 CMake 来生成 Makefile 的</strong>，<br>有些库可能需要手动调用库自带的脚本来生成 Makefile，然后使用 make 编译比如<a href="/2024/11/05/%E7%BC%96%E8%AF%91C-%E7%9A%84ICU%E5%BA%93/">ICU 库的构建</a></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="/2023/11/03/C-%E7%9F%A5%E8%AF%86%E7%82%B9%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA/#Makefile">Makefile</a><br><a class="link"   href="https://blog.csdn.net/ZBraveHeart/article/details/132736292" >Cmake 入门（一文读懂） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a href="/2024/11/05/%E7%BC%96%E8%AF%91C-%E7%9A%84ICU%E5%BA%93/">ICU 库的构建</a><br><a href="/2024/12/11/c-%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8conan%E7%9A%84%E4%BD%BF%E7%94%A8/">c++包管理器 conan 的使用</a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>VSCode</tag>
        <tag>MinGW</tag>
        <tag>CMake</tag>
      </tags>
  </entry>
  <entry>
    <title>在webpack下搭建vue3项目</title>
    <url>/2024/04/17/%E5%9C%A8webpack%E4%B8%8B%E6%90%AD%E5%BB%BAvue3%E9%A1%B9%E7%9B%AE/</url>
    <content><![CDATA[<h1 id="须知"><a href="#须知" class="headerlink" title="须知"></a>须知</h1><p>本文是在 <a href="/2023/04/27/webpack%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/">webpack 基础使用</a> 的配置基础上添加 vue3 项目。</p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>需要安装的依赖：</p>
<ul>
<li>vue<br> vue 核心库</li>
<li>vue-router<br> vue 路由库</li>
<li>less<br> less 预处理器，用来编写样式</li>
<li>axios<br> 请求库</li>
<li>mockjs<br> 模拟数据库</li>
<li>@babel&#x2F;core<br> babel 核心库，可以不安装，但如果编译时报错缺少该库，就需要安装</li>
<li>vue-loader<br> vue 文件模块加载器</li>
<li>less-loader<br> less 文件模块加载器</li>
<li>css-loader<br> css 文件模块加载器</li>
<li>style-loader<br> 安装了 css-loader，就必须安装 style-loader，用途是将样式添加到页面的 head 中</li>
</ul>
<h2 id="安装运行依赖"><a href="#安装运行依赖" class="headerlink" title="安装运行依赖"></a>安装运行依赖</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">npm install vue vue-router less axios mockjs -S</span><br></pre></td></tr></table></figure></div>

<h2 id="安装开发依赖"><a href="#安装开发依赖" class="headerlink" title="安装开发依赖"></a>安装开发依赖</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">npm install @babel/core vue-loader less-loader css-loader style-loader -D</span><br></pre></td></tr></table></figure></div>

<h1 id="配置文件修改"><a href="#配置文件修改" class="headerlink" title="配置文件修改"></a>配置文件修改</h1><h2 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h2><p>webpack.config.js 需要修改的地方如下<br><strong><em>注意，下列是增加的配置项，不是最终的配置项</em></strong></p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">VueLoaderPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;vue-loader&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.vue$/i</span>,</span><br><span class="line">        <span class="attr">loader</span>: <span class="string">&quot;vue-loader&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">        <span class="attr">use</span>: [<span class="string">&quot;style-loader&quot;</span>, <span class="string">&quot;css-loader&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.less$/i</span>,</span><br><span class="line">        <span class="attr">use</span>: [<span class="string">&quot;style-loader&quot;</span>, <span class="string">&quot;css-loader&quot;</span>, <span class="string">&quot;less-loader&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="keyword">new</span> <span class="title class_">VueLoaderPlugin</span>()],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<h1 id="源码文件"><a href="#源码文件" class="headerlink" title="源码文件"></a>源码文件</h1><h2 id="x2F-public-x2F-index-html"><a href="#x2F-public-x2F-index-html" class="headerlink" title="&#x2F;public&#x2F;index.html"></a>&#x2F;public&#x2F;index.html</h2><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="x2F-src-x2F-main-js"><a href="#x2F-src-x2F-main-js" class="headerlink" title="&#x2F;src&#x2F;main.js"></a>&#x2F;src&#x2F;main.js</h2><p>入口文件</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;@/App.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>); <span class="comment">// 使用根组件创建应用</span></span><br><span class="line">app.<span class="title function_">use</span>(router); <span class="comment">// 路由配置</span></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure></div>

<h2 id="x2F-src-x2F-App-vue"><a href="#x2F-src-x2F-App-vue" class="headerlink" title="&#x2F;src&#x2F;App.vue"></a>&#x2F;src&#x2F;App.vue</h2><p>根组件</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 路由视图区域，强烈建议使用双驼峰（PascalCase）格式以保持一致性。同时这也有助于区分原生的自定义元素。 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">RouterView</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> name = <span class="title function_">ref</span>(<span class="string">&quot;根组件&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  // 这里不使用“scoped”，引入全局自定义样式文件</span></span><br><span class="line"><span class="language-css">  <span class="keyword">@import</span> url(<span class="string">&quot;@/assets/css/less/customGlobal.less&quot;</span>);</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="x2F-src-x2F-router-x2F-index-js"><a href="#x2F-src-x2F-router-x2F-index-js" class="headerlink" title="&#x2F;src&#x2F;router&#x2F;index.js"></a>&#x2F;src&#x2F;router&#x2F;index.js</h2><p>路由配置文件</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHashHistory &#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params"></span>) =&gt; <span class="keyword">import</span>(<span class="string">&quot;@/views/Home.vue&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">User</span> = (<span class="params"></span>) =&gt; <span class="keyword">import</span>(<span class="string">&quot;@/views/User.vue&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHashHistory</span>(),</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">&quot;/home&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;home&quot;</span>, <span class="attr">component</span>: <span class="title class_">Home</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>, <span class="attr">redirect</span>: <span class="string">&quot;/home&quot;</span> &#125;, <span class="comment">// 将 “/” 重定向到 “/home”</span></span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">&quot;/user&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;user&quot;</span>, <span class="attr">component</span>: <span class="title class_">User</span> &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure></div>

<h2 id="x2F-src-x2F-views-x2F-Home-vue"><a href="#x2F-src-x2F-views-x2F-Home-vue" class="headerlink" title="&#x2F;src&#x2F;views&#x2F;Home.vue"></a>&#x2F;src&#x2F;views&#x2F;Home.vue</h2><p>主页</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;home&quot;</span>&gt;</span>&#123;&#123; name &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> name = <span class="title function_">ref</span>(<span class="string">&quot;Home&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#home</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: gray;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="x2F-src-x2F-views-x2F-User-vue"><a href="#x2F-src-x2F-views-x2F-User-vue" class="headerlink" title="&#x2F;src&#x2F;views&#x2F;User.vue"></a>&#x2F;src&#x2F;views&#x2F;User.vue</h2><p>用户页</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span>&gt;</span>&#123;&#123; name &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> name = <span class="title function_">ref</span>(<span class="string">&quot;User&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#user</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: green;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="x2F-src-x2F-assets-x2F-css-x2F-less-x2F-customGlobal-less"><a href="#x2F-src-x2F-assets-x2F-css-x2F-less-x2F-customGlobal-less" class="headerlink" title="&#x2F;src&#x2F;assets&#x2F;css&#x2F;less&#x2F;customGlobal.less"></a>&#x2F;src&#x2F;assets&#x2F;css&#x2F;less&#x2F;customGlobal.less</h2><p>自定义全局 less 样式文件</p>
<div class="highlight-container" data-rel="Less"><figure class="iseeu highlight less"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">全局less样式</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>vue</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>在租房环境下搭建DDNS服务器</title>
    <url>/2023/05/09/%E5%9C%A8%E7%A7%9F%E6%88%BF%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BADDNS%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<p>事情是这样的，自从我毕业以后，就一直想要搭建个自己的服务器，但是自己很穷且云服务器太贵，而且不能体验到自己动手搭建的乐趣，所以才有了这篇文章</p>
<span id="more"></span>

<p><strong><em>开始前要说一下，如果没有光猫的超级管理员权限，是不能配置一级路由光猫的，所以最好打电话询问网络服务商要超管账号和密码</em></strong></p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>我租的房子路由拓扑结构如下：</p>
<ol>
<li>一台光猫（顶级路由）</li>
<li>我自己的路由器（二级路由）</li>
</ol>
<h1 id="光猫配置"><a href="#光猫配置" class="headerlink" title="光猫配置"></a>光猫配置</h1><p>进入光猫配置界面，将自己的二级路由设置为静态 IP，并且设置为 DMZ 主机，这样就可以将大部分配置权限转移到二级路由去了</p>
<h1 id="二级路由"><a href="#二级路由" class="headerlink" title="二级路由"></a>二级路由</h1><p>在二级路由配置界面设置 DDNS，这里就不细说了，因为二级路由已经是 DMZ 主机了，所以可以直接设置二级路由 DDNS。</p>
<p>我使用的是 TPLINK 路由器，<del>自带 DDNS 功能</del>（TPLINK 的 DDNS 功能于 2025 年 6 月 30 日起正式停止服务）。</p>
<p>也可以使用 TPLINK 路由器附带的花生壳 DDNS，只需要在花生壳官网注册一个免费域名，然后一定要<strong>设置独立密码</strong>，最后使用花生壳账号和独立密码登录 TPLINK 的 DDNS 服务就可以了。</p>
<h1 id="重启光猫"><a href="#重启光猫" class="headerlink" title="重启光猫"></a>重启光猫</h1><p>重启光猫的防火墙，这一步是个坑，重启一下最好，不然容易遇到问题。（我用的是中兴 f450g 光猫）</p>
<h1 id="虚拟主机"><a href="#虚拟主机" class="headerlink" title="虚拟主机"></a>虚拟主机</h1><p>在二级路由里面配置虚拟主机，这样就可以在外网使用 DDNS 域名配合二级路由暴露的端口调用本地服务了，但是注意这里有个坑，外部端口需要设置的大一些，在 60000 - 65535 最好，不然容易遇到问题</p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>在内网访问 DDNS 的域名似乎不能成功，<del>暂时不能解决</del>，因为二级路由的内部网络并没有 DNS 映射，所以内网服务只能用 ip 访问。</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>DDNS</tag>
      </tags>
  </entry>
  <entry>
    <title>在vue自定义指令directives中获取this指针</title>
    <url>/2024/04/16/%E5%9C%A8vue%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4directives%E4%B8%AD%E8%8E%B7%E5%8F%96this%E6%8C%87%E9%92%88/</url>
    <content><![CDATA[<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-my-custom-directive</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">directives</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">myCustomDirective</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">inserted</span>(<span class="params">el, binding, vnode</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> that = vnode.<span class="property">context</span>; <span class="comment">// 在此处获取this指针</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>如何便宜乘坐飞机</title>
    <url>/2025/01/02/%E5%A6%82%E4%BD%95%E4%BE%BF%E5%AE%9C%E4%B9%98%E5%9D%90%E9%A3%9E%E6%9C%BA/</url>
    <content><![CDATA[<h1 id="航司会员日"><a href="#航司会员日" class="headerlink" title="航司会员日"></a>航司会员日</h1><p>如果要买便宜的机票，那么在航司的会员日购买机票是一个非常不错的选择，但是请记得一定要去各大航司官网注册会员。</p>
<p>以下是一部分的航司会员日日期：</p>
<ol>
<li>国航：1 月 1 日、2 月 2 日、3 月 3 日，以此类推</li>
<li>南航：每月 28 日</li>
<li>东航、厦航：每月 9 日</li>
<li>海航：每月 8 日</li>
<li>深航：每月 12 日</li>
<li>川航：每月 19 日</li>
<li>吉祥、华夏：每月 25 日</li>
<li>春秋：每月 27 日</li>
</ol>
<h1 id="其他注意事项"><a href="#其他注意事项" class="headerlink" title="其他注意事项"></a>其他注意事项</h1><ol>
<li>注意是否有免费托运服务</li>
<li>注意是否可以退改</li>
<li>注意是否可以免费提前值机（免费提前预定座位）</li>
</ol>
]]></content>
      <categories>
        <category>生活</category>
      </categories>
      <tags>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>实现一个基本的WebSocket前后端数据交互功能</title>
    <url>/2023/03/07/%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%9F%BA%E6%9C%AC%E7%9A%84WebSocket%E5%89%8D%E5%90%8E%E7%AB%AF%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92%E5%8A%9F%E8%83%BD/</url>
    <content><![CDATA[<p>后端使用 nodejs 开发，使用到了<a class="link"   href="https://www.npmjs.com/package/nodejs-websocket" >nodejs-websocket <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>库</p>
<p>前端使用了 H5 原生的 WebSocket 功能</p>
<hr>
<h2 id="直接上代码"><a href="#直接上代码" class="headerlink" title="直接上代码"></a>直接上代码</h2><span id="more"></span>

<h3 id="后端代码（backend-js）："><a href="#后端代码（backend-js）：" class="headerlink" title="后端代码（backend.js）："></a>后端代码（backend.js）：</h3><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ws = <span class="built_in">require</span>(<span class="string">&#x27;nodejs-websocket&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建websocket服务端，返回一个socket连接</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; <span class="variable">port</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">host</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">Promise</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">port = <span class="number">6868</span>, host = <span class="string">&#x27;localhost&#x27;</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> server = ws.<span class="title function_">createServer</span>(<span class="function">(<span class="params">connection</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;检测到新的连接&#x27;</span>);</span><br><span class="line">            <span class="title function_">resolve</span>(connection);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        server.<span class="title function_">listen</span>(port, host);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> socket = <span class="keyword">await</span> <span class="title function_">run</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 服务端主动发送信息</span></span><br><span class="line">    socket.<span class="title function_">sendText</span>(<span class="string">&#x27;服务端发出的信息&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 服务端接收信息</span></span><br><span class="line">    socket.<span class="title function_">on</span>(<span class="string">&#x27;text&#x27;</span>, <span class="function">(<span class="params">str</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`服务端收到的信息：<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>();</span><br></pre></td></tr></table></figure></div>

<h3 id="前端代码（frontend-html）："><a href="#前端代码（frontend-html）：" class="headerlink" title="前端代码（frontend.html）："></a>前端代码（frontend.html）：</h3><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">             * 创建websocket客户端，返回一个socket连接</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">             * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">url</span></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">             * <span class="doctag">@returns</span> &#123;<span class="type">Promise</span>&#125;</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">             */</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">url</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">let</span> socket = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(url);</span></span><br><span class="line"><span class="language-javascript">                    socket.<span class="title function_">addEventListener</span>(<span class="string">&#x27;open&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;创建连接成功&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                        <span class="title function_">resolve</span>(socket);</span></span><br><span class="line"><span class="language-javascript">                    &#125;);</span></span><br><span class="line"><span class="language-javascript">                &#125;);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> socket = <span class="keyword">await</span> <span class="title function_">run</span>(<span class="string">&#x27;ws://localhost:6868&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 客户端主动发送信息</span></span></span><br><span class="line"><span class="language-javascript">                socket.<span class="title function_">send</span>(<span class="string">&#x27;客户端发出的信息&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 客户端接收信息</span></span></span><br><span class="line"><span class="language-javascript">                socket.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`客户端收到的信息：<span class="subst">$&#123;res.data&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">test</span>();</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>巩固一下网页拖放事件</title>
    <url>/2024/06/01/%E5%B7%A9%E5%9B%BA%E4%B8%80%E4%B8%8B%E7%BD%91%E9%A1%B5%E6%8B%96%E6%94%BE%E4%BA%8B%E4%BB%B6/</url>
    <content><![CDATA[<p>最近在做我的【学习&amp;复习网站第二版】，在开发一个树形结构组件时遇到了个问题，之前一直都不重视，就是拖放的实现。<br>如下所示是目前已经实现好的拖放功能</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1717308947857_2cb7686e53e6883e02fcaa79818b7e3b.gif"
                     
                ></p>
<span id="more"></span>

<p>之前也有做过拖拽的组件 <a href="/2024/05/21/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AA%E5%85%AC%E5%8F%B8%E9%A1%B9%E7%9B%AE%EF%BC%88uniapp%E5%8E%9F%E7%94%9F%E5%AE%9E%E7%8E%B0%E5%BC%82%E5%BD%A2%E8%8C%83%E5%9B%B4%E9%80%89%E6%8B%A9%E5%99%A8slider%EF%BC%89/">记录一个公司项目（uniapp 原生实现异形范围选择器 slider）</a> ，这里和它一起做一个总结。</p>
<p>准确来说， <a href="/2024/05/21/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AA%E5%85%AC%E5%8F%B8%E9%A1%B9%E7%9B%AE%EF%BC%88uniapp%E5%8E%9F%E7%94%9F%E5%AE%9E%E7%8E%B0%E5%BC%82%E5%BD%A2%E8%8C%83%E5%9B%B4%E9%80%89%E6%8B%A9%E5%99%A8slider%EF%BC%89/">记录一个公司项目（uniapp 原生实现异形范围选择器 slider）</a> 仅用到了<strong>移动端特有</strong>的触摸事件，即：</p>
<ul>
<li><em>touchstart</em></li>
<li><em>touchmove</em></li>
<li><em>touchend</em></li>
</ul>
<p>以上这些 touch 系列事件能够实现了<strong>移动端网页</strong>的滑动拖拽条，<br>但我们现在要说的是不管<strong>移动端</strong>还是<strong>PC 端</strong>都可以使用的（主要是<strong>PC 端</strong>）拖放事件，即 drag 和 drop 系列事件</p>
<h1 id="drag-和-drop"><a href="#drag-和-drop" class="headerlink" title="drag 和 drop"></a>drag 和 drop</h1><p>先介绍一下今天要介绍的主角：drag 和 drop 系列事件。<br><em>在英语中：drag 就是拖拽的意思，而 drop 就是降落（放下）的意思。</em></p>
<ul>
<li>_drag_： 绑定在<strong>被拖拽的元素</strong>上，被拖拽元素移动时触发。</li>
<li>_dragStart_： 绑定在<strong>被拖拽的元素</strong>上，元素开始被拖拽时触发。</li>
<li>_dragEnd_： 绑定在<strong>被拖拽的元素</strong>上，元素结束被拖拽时触发。</li>
<li>_dragEnter_： 绑定在<strong>被放入的元素</strong>上，被拖拽元素进入被放入元素时触发。</li>
<li>_dragLeave_： 绑定在<strong>被放入的元素</strong>上，被拖拽元素离开被放入元素时触发。</li>
<li>_dragOver_： 绑定在<strong>被放入的元素</strong>上，被拖拽元素在被放入元素上移动时触发。</li>
<li>_drop_： 绑定在<strong>被放入的元素</strong>上，被拖拽元素在被放入元素上放下时触发。</li>
</ul>
<p>首先要说明一点，要实现拖放功能，那么就需要两个元素参与进来，一个是<strong>被拖拽的元素</strong>，另一个是<strong>被放入的元素</strong>。<br>以上事件有一部分是需要绑定在<strong>被拖拽的元素</strong>上的，而另一部分需要绑定在<strong>被放入的元素</strong>上，以此完成一个闭环。</p>
<p>还要注意，被拖拽的元素需要声明<strong>“draggable&#x3D;”true””</strong>，否则是拖不动的。</p>
<h1 id="代码参考"><a href="#代码参考" class="headerlink" title="代码参考"></a>代码参考</h1><p>这里仅实现一个简单的拖拽和放下的例子，不涉及到树结构。<br>如对树结构有兴趣，可以参考 <a href="/2024/03/06/vue%E9%80%92%E5%BD%92%E7%BB%84%E4%BB%B6/">VUE 递归组件</a></p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>drag and drop<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#content1</span>,</span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#content2</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">1em</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#content1</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#content2</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#drag-item</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">1em</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: greenyellow;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">cursor</span>: move;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#console</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">resize</span>: none;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>拖动绿色元素到容器1或容器2<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 容器1（被放入的元素） --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content1&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>容器1（粉色背景）<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 被拖拽的元素，需要声明：draggable=&quot;true&quot; --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;drag-item&quot;</span> <span class="attr">draggable</span>=<span class="string">&quot;true&quot;</span>&gt;</span>请拖动我<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 容器2（被放入的元素） --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content2&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>容器2（蓝色背景）<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 信息展示区 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>信息输出<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&quot;console&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> $content1 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;content1&quot;</span>),</span></span><br><span class="line"><span class="language-javascript">        $content2 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;content2&quot;</span>),</span></span><br><span class="line"><span class="language-javascript">        $dragItem = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;drag-item&quot;</span>),</span></span><br><span class="line"><span class="language-javascript">        $console = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;console&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">consoleScrollToButton</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        $console.<span class="property">scrollTop</span> = $console.<span class="property">scrollHeight</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 这里为“被拖拽的元素”绑定事件</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> dragTimer = <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">        dragInterval = <span class="number">500</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">drag</span> = (<span class="params">ev</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 拖动时每100ms产生一个事件，频率太高，所以做一个节流</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (dragTimer) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">        dragTimer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> &#123; offsetX, offsetY &#125; = ev;</span></span><br><span class="line"><span class="language-javascript">          $console.<span class="property">value</span> += <span class="string">`drag 元素正在被拖动，位置：x=<span class="subst">$&#123;offsetX&#125;</span>,y=<span class="subst">$&#123;offsetY&#125;</span>\r\n`</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">consoleScrollToButton</span>();</span></span><br><span class="line"><span class="language-javascript">          dragTimer = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;, dragInterval);</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">dragstart</span> = (<span class="params">ev</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        $console.<span class="property">value</span> += <span class="string">&quot;dragstart 元素开始拖动了\r\n&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">consoleScrollToButton</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">dragend</span> = (<span class="params">ev</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        $console.<span class="property">value</span> += <span class="string">&quot;dragstart 元素结束拖动了\r\n&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">consoleScrollToButton</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      $dragItem.<span class="title function_">addEventListener</span>(<span class="string">&quot;drag&quot;</span>, drag);</span></span><br><span class="line"><span class="language-javascript">      $dragItem.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragstart&quot;</span>, dragstart);</span></span><br><span class="line"><span class="language-javascript">      $dragItem.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragend&quot;</span>, dragend);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 这里为“被放入的元素绑定事件”</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">dragenter</span> = (<span class="params">ev</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> name = ev.<span class="property">currentTarget</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;h3&quot;</span>).<span class="property">innerText</span>;</span></span><br><span class="line"><span class="language-javascript">        $console.<span class="property">value</span> += <span class="string">`dragenter 进入了<span class="subst">$&#123;name&#125;</span>\r\n`</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">consoleScrollToButton</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">dragleave</span> = (<span class="params">ev</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> name = ev.<span class="property">currentTarget</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;h3&quot;</span>).<span class="property">innerText</span>;</span></span><br><span class="line"><span class="language-javascript">        $console.<span class="property">value</span> += <span class="string">`dragleave 离开了<span class="subst">$&#123;name&#125;</span>\r\n`</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">consoleScrollToButton</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> dragoverTimer = <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">        dragoverInterval = <span class="number">500</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">dragover</span> = (<span class="params">ev</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        ev.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> &#123; currentTarget &#125; = ev;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 拖动时每100ms产生一个事件，频率太高，所以做一个节流</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (dragoverTimer) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">        dragoverTimer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> name = currentTarget.<span class="title function_">querySelector</span>(<span class="string">&quot;h3&quot;</span>).<span class="property">innerText</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> &#123; offsetX, offsetY &#125; = ev;</span></span><br><span class="line"><span class="language-javascript">          $console.<span class="property">value</span> += <span class="string">`drag 元素正在<span class="subst">$&#123;name&#125;</span>上被拖动，位置：x=<span class="subst">$&#123;offsetX&#125;</span>,y=<span class="subst">$&#123;offsetY&#125;</span>\r\n`</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">consoleScrollToButton</span>();</span></span><br><span class="line"><span class="language-javascript">          dragoverTimer = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;, dragoverInterval);</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">drop</span> = (<span class="params">ev</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> name = ev.<span class="property">currentTarget</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;h3&quot;</span>).<span class="property">innerText</span>;</span></span><br><span class="line"><span class="language-javascript">        $console.<span class="property">value</span> += <span class="string">`drop 放入了<span class="subst">$&#123;name&#125;</span>\r\n`</span>;</span></span><br><span class="line"><span class="language-javascript">        ev.<span class="property">currentTarget</span>.<span class="title function_">appendChild</span>($dragItem);</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">consoleScrollToButton</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      $content1.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragenter&quot;</span>, dragenter);</span></span><br><span class="line"><span class="language-javascript">      $content2.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragenter&quot;</span>, dragenter);</span></span><br><span class="line"><span class="language-javascript">      $content1.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragleave&quot;</span>, dragleave);</span></span><br><span class="line"><span class="language-javascript">      $content2.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragleave&quot;</span>, dragleave);</span></span><br><span class="line"><span class="language-javascript">      $content1.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragover&quot;</span>, dragover);</span></span><br><span class="line"><span class="language-javascript">      $content2.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragover&quot;</span>, dragover);</span></span><br><span class="line"><span class="language-javascript">      $content1.<span class="title function_">addEventListener</span>(<span class="string">&quot;drop&quot;</span>, drop);</span></span><br><span class="line"><span class="language-javascript">      $content2.<span class="title function_">addEventListener</span>(<span class="string">&quot;drop&quot;</span>, drop);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="mouse-系列事件"><a href="#mouse-系列事件" class="headerlink" title="mouse 系列事件"></a>mouse 系列事件</h1><p>mouse 系列事件包括：</p>
<ul>
<li>mousedown</li>
<li>mouseup</li>
<li>mousemove</li>
<li>mouseenter</li>
<li>mouseleave</li>
<li>mouseover</li>
<li>mouseout</li>
<li>mousewheel</li>
</ul>
<p>其中，一般用于拖拽事件的有：</p>
<ul>
<li>mousedown</li>
<li>mouseup</li>
<li>mousemove</li>
</ul>
<p>进入离开事件（不会冒泡）：</p>
<ul>
<li>mouseenter</li>
<li>mouseleave</li>
</ul>
<p>进入离开事件（会冒泡）：</p>
<ul>
<li>mouseover</li>
<li>mouseout</li>
</ul>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API" >HTML 拖放 API <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>实现一个能自动合并书签的谷歌浏览器插件</title>
    <url>/2023/07/21/%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E8%83%BD%E8%87%AA%E5%8A%A8%E5%90%88%E5%B9%B6%E4%B9%A6%E7%AD%BE%E7%9A%84%E8%B0%B7%E6%AD%8C%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6/</url>
    <content><![CDATA[<p>实现了一个导入书签后自动合并的chrome插件，还有些小问题，但不影响使用，后面有空再修改。</p>
<p><a class="link"   href="https://github.com/GJYyyyy/chromePluginImportBookmarks" >github地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>总结一下安卓手机抓包流程</title>
    <url>/2023/05/27/%E6%80%BB%E7%BB%93%E4%B8%80%E4%B8%8B%E5%AE%89%E5%8D%93%E6%89%8B%E6%9C%BA%E6%8A%93%E5%8C%85%E6%B5%81%E7%A8%8B/</url>
    <content><![CDATA[<p>因为想给移动端APP做自动签到的功能，所以给手机抓包是必经的课题。</p>
<hr>
<h1 id="简单说一下思路："><a href="#简单说一下思路：" class="headerlink" title="简单说一下思路："></a>简单说一下思路：</h1><p><strong>笔记本电脑开启热点，手机连接热点，然后在电脑上对热点网卡抓包，这样，就可以完全监控手机的网络流量</strong></p>
<h1 id="主要是用到以下工具："><a href="#主要是用到以下工具：" class="headerlink" title="主要是用到以下工具："></a>主要是用到以下工具：</h1><ul>
<li>笔记本电脑热点</li>
<li>Wireshark</li>
<li>安卓手机</li>
</ul>
<span id="more"></span>


<h1 id="笔记本电脑开启移动热点"><a href="#笔记本电脑开启移动热点" class="headerlink" title="笔记本电脑开启移动热点"></a>笔记本电脑开启移动热点</h1><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025375_9f3b161f8c7d4ccd1323e62bacb1a815.png"
                     
                ></p>
<h1 id="手机连接热点"><a href="#手机连接热点" class="headerlink" title="手机连接热点"></a>手机连接热点</h1><p>注意啊，为了抓包的准确性，手机最好关闭流量功能，关闭双WIFI加速功能<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025370_02bc840e99584d0c0af5625572ca3a4d.jpg"
                     
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025340_b240159072fd32b51aa3e00eef88e5a4.jpg"
                     
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025339_0f1cd96d29ce4a86e670fb1d9649e740.jpg"
                     
                ></p>
<h1 id="Wireshark监听开启热点的网卡"><a href="#Wireshark监听开启热点的网卡" class="headerlink" title="Wireshark监听开启热点的网卡"></a>Wireshark监听开启热点的网卡</h1><p>手机连接笔记本电脑热点后可以看到自己的<strong>网关地址</strong>，根据这个<strong>网关地址</strong>可以在Wireshark确定要抓包的网卡<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025371_ae928de3a4f0e7e4eef65a1df71cf3d7.jpg"
                     
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025371_656c503367bc257aa034fb74820481a1.jpg"
                     
                ><br>拿到网关地址后就可以去Wireshark筛选网卡了<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025376_7a40dcd49b3aa258c5b7312bd20b7b82.png"
                     
                ><br>确定网卡后就可以愉快的抓包了！</p>
<h1 id="Wireshark常用过滤规则"><a href="#Wireshark常用过滤规则" class="headerlink" title="Wireshark常用过滤规则"></a>Wireshark常用过滤规则</h1><p>我常用的规则就是：<br>ip.src &#x3D;&#x3D; xxx.xxx.xxx.xxx and ip.dst &#x3D;&#x3D; xxx.xxx.xxx.xxx and http<br>意思是指定发送包的IP地址、包目的地ip地址并且指定只抓http协议的包</p>
<h1 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h1><p>Wireshark抓包出现 [truncated] 怎么办？<br> [truncated] 表示信息不全，如果想要看到完整的信息需要右键出现 [truncated] 的那条信息，<br>然后如图操作，就可以看到完整的包信息了<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025376_b26cb4937d143b7df77c78f3291a9f21.png"
                     
                ></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>抓包</tag>
        <tag>Wireshark</tag>
      </tags>
  </entry>
  <entry>
    <title>搭建在线VSCode</title>
    <url>/2024/11/01/%E6%90%AD%E5%BB%BA%E5%9C%A8%E7%BA%BFVSCode/</url>
    <content><![CDATA[<p>最近在学习 C&#x2F;C++ ，在 Windows 下编译会很麻烦，所以就在我自己的 Ubuntu 服务器上搭建一个在线的 VSCode，这样就可以方便地利用 Ubuntu 的编译环境了。</p>
<span id="more"></span>

<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>如果想在 Ubuntu 上编译 C&#x2F;C++，但是代码依然在 Windows 的 VSCode 上编写，可以考虑在本地 VSCode 装一个叫 remote-ssh 的插件。不一定要用 code-server。</p>
<p>remote-ssh 的配置文件如下：</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="code"><pre><span class="line">Host sshHost</span><br><span class="line">  HostName sshHost</span><br><span class="line">  User sshUser</span><br><span class="line">  ForwardAgent yes</span><br><span class="line">  Compression yes</span><br><span class="line">  IdentityFile sshPrivateKey</span><br></pre></td></tr></table></figure></div>

<p>如果不配置 ForwardAgent、Compression、IdentityFile，每次 ssh 登录，都会提示输入密码。</p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>如果你的服务器上有宝塔面板，建议使用宝塔面板来安装 在线 VSCode（code-server）。</p>
<h2 id="宝塔安装（推荐）"><a href="#宝塔安装（推荐）" class="headerlink" title="宝塔安装（推荐）"></a>宝塔安装（推荐）</h2><p>在宝塔的应用商店里查找并安装非 Docker 版本的 code-server。<br><em>本意是为了好好的利用 Ubuntu 的编译环境，所以选择了非 Docker 版本，如果使用了 Docker 版本，很多东西还要自己去 Docker 容器里配置，很麻烦。</em></p>
<p><strong>已知问题</strong>：</p>
<ol>
<li>如果宝塔安装缓慢或失败，建议先更新宝塔面板，测试宝塔面板 9.20 安装成功。</li>
<li>安装完毕后，必须要配置一下，否则默认的配置是一个莫名其妙的 IP 地址，不能正常使用。（9.20 已知问题）。</li>
<li>code-server 不会跟随系统自启动，每次重启系统都要手动去启动服务（9.20 已知问题）。</li>
</ol>
<h2 id="官网安装"><a href="#官网安装" class="headerlink" title="官网安装"></a>官网安装</h2><p>跟随官网引导来安装 code-server。</p>
<p><em>官网文档推荐安装罪行的版本，反正安装完毕后跑不起来。</em></p>
<p><a class="link"   href="https://coder.com/" >在线 VSCode（Coder） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://github.com/coder/code-server" >code-server github <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://coder.com/docs/install" >在线 VSCode 安装导向 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://coder.com/docs/admin/setup" >配置 code-server <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">curl -L https://coder.com/install.sh | sh</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 启动，同时添加自启动。</span></span><br><span class="line"><span class="comment"># 如果启动失败，可能需要手动通过 apt 安装 terraform（测试即使安装了 terraform 也会启动不了）。</span></span><br><span class="line">systemctl <span class="built_in">enable</span> --now code-server</span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://blog.csdn.net/weixin_74313592/article/details/136147217" >浏览器编程，部署 code-server 指南 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>VSCode</tag>
        <tag>Ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title>搭建iSCSI服务</title>
    <url>/2025/05/21/%E6%90%AD%E5%BB%BAiSCSI%E6%9C%8D%E5%8A%A1/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>iSCSI（Internet Small Computer System Interface）是一种基于因特网及 SCSI-3 协议下的存储技术，<br>简单来说就是把网络上的硬盘通过网线挂载成电脑的本地硬盘，方便扩容。</p>
<p>我搭建 iSCSI 服务主要是给我的 Windows 系统存储扩容。<br>普通情况下，机械硬盘顺序读写速度通常为 150-190MB&#x2F;s，<br>我选择将其安装到另一台电脑（要有千兆网卡），通过 Ubuntu 系统部署为 iSCSI 服务，然后接入到千兆局域网，<br>Windows 系统的电脑通过网络使用该硬盘（和本地硬盘一样的使用方法），速度也可以达到千兆局域网的上限 125MB&#x2F;s</p>
<p>接下来就是简单的搭建过程</p>
<span id="more"></span>

<h1 id="硬件处理"><a href="#硬件处理" class="headerlink" title="硬件处理"></a>硬件处理</h1><p>将硬盘插入主板，然后开机，先查看一下硬盘信息</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo fdisk -l</span><br></pre></td></tr></table></figure></div>

<p>找到你的新硬盘，硬盘一般按顺序起名，例如从第一个硬盘开始起名：&#x2F;dev&#x2F;sda、&#x2F;dev&#x2F;sdb、&#x2F;dev&#x2F;sdc……<br>&#x2F;dev&#x2F;sda 一般是系统盘，我的新硬盘是第二个，所以是 <strong>&#x2F;dev&#x2F;sdb</strong></p>
<h2 id="格式化硬盘并分区"><a href="#格式化硬盘并分区" class="headerlink" title="格式化硬盘并分区"></a>格式化硬盘并分区</h2><p><strong>注意：如果你的硬盘只想通过 iSCSI 提供给 Windows 系统使用，请忽略此处内容，直接参考<a href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E7%A1%AC%E7%9B%98%E5%B9%B6%E5%88%86%E5%8C%BA-1">Windows-格式化硬盘并分区</a></strong><br><strong>注意：进行此处操作时，请关闭 iSCSI 服务</strong></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo parted /dev/sdb mklabel gpt  <span class="comment"># 初始化磁盘为GPT格式</span></span><br><span class="line">sudo parted /dev/sdb mkpart primary 1MiB 100%  <span class="comment"># 设置起始为1MiB（自动对齐4K物理扇区），创建完整空间的分区（如/dev/sdb1）</span></span><br></pre></td></tr></table></figure></div>

<p>刷新分区表，强制内核重新读取分区信息</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo partprobe /dev/sdb</span><br></pre></td></tr></table></figure></div>

<p>格式化分区为 exFAT</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装exFAT支持包（Ubuntu 22.04默认未集成exFAT驱动）</span></span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install exfat-fuse exfatprogs</span><br><span class="line"></span><br><span class="line"><span class="comment"># 格式化</span></span><br><span class="line">sudo mkfs.exfat /dev/sdb1</span><br></pre></td></tr></table></figure></div>

<p>验证文件系统格式化结果</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">lsblk -f /dev/sdb  <span class="comment"># 应显示文件系统类型为exfat</span></span><br></pre></td></tr></table></figure></div>

<p>临时挂载测试</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> /mnt/exfat_disk  <span class="comment"># 创建挂载点</span></span><br><span class="line">sudo mount /dev/sdb1 /mnt/exfat_disk</span><br><span class="line"></span><br><span class="line">sudo unmount /mnt/exfat_disk <span class="comment"># 卸载挂载点（通过文件路径）</span></span><br><span class="line">suso unmount /dev/sdb1 <span class="comment"># 卸载挂载点（通过硬盘盘名）</span></span><br></pre></td></tr></table></figure></div>

<p>持久化挂载</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 获取硬盘UUID</span></span><br><span class="line">sudo blkid /dev/sdb1 <span class="comment"># 输出示例：/dev/sdb1: UUID=&quot;ABCD-1234&quot; TYPE=&quot;exfat&quot;</span></span><br><span class="line"><span class="comment"># 获取用户uid和gid</span></span><br><span class="line"><span class="built_in">id</span> -u <span class="variable">$USER</span> <span class="comment"># 输出示例：1000</span></span><br><span class="line"><span class="built_in">id</span> -g <span class="variable">$USER</span> <span class="comment"># 输出示例：1000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改/etc/fstab文件</span></span><br><span class="line">sudo vim /etc/fstab</span><br><span class="line"><span class="comment"># 添加一行，后面两个0分别代表：备份表及：无需备份；检查顺序：无需检查</span></span><br><span class="line">UUID=ABCD-1234 /mnt/iscsi exfat defaults,uid=1000,gid=1000 0 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试挂载</span></span><br><span class="line">sudo mount -a <span class="comment"># 若无错误则配置正确</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 确认挂载状态</span></span><br><span class="line">lsblk -f /dev/sdb1</span><br></pre></td></tr></table></figure></div>

<h1 id="Ubuntu-安装-tgt"><a href="#Ubuntu-安装-tgt" class="headerlink" title="Ubuntu 安装 tgt"></a>Ubuntu 安装 tgt</h1><p><strong>注意，如果还要对硬盘进行格式化，请先停止 tgt 服务，否则会出现数据不一致&#x2F;丢失的情况</strong></p>
<p>Ubuntu 官方推荐使用 tgt 作为 iSCSI 目标服务</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install tgt</span><br></pre></td></tr></table></figure></div>

<p>然后创建配置文件</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/tgt/conf.d/iscsi.conf</span><br></pre></td></tr></table></figure></div>

<p>写入配置内容</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;target iqn.2025-05.yourdomain:storage.sdb&gt;</span><br><span class="line">    backing-store /dev/sdb  <span class="comment"># 指向新硬盘</span></span><br><span class="line">    <span class="comment"># backing-store /dev/sdb1 # 指向新硬盘分区</span></span><br><span class="line"></span><br><span class="line">    write-cache off  <span class="comment"># 关闭写入缓存，可以防止异常断电时数据丢失</span></span><br><span class="line">    <span class="comment"># write-cache on  # 启用写入缓存提升性能</span></span><br><span class="line"></span><br><span class="line">    allow-in-use <span class="built_in">yes</span>  <span class="comment"># 允许多客户端同时挂载（需注意数据一致性）</span></span><br><span class="line"></span><br><span class="line">    initiator-address ALL  <span class="comment"># 允许所有IP访问（生产环境建议限制IP段）</span></span><br><span class="line">    <span class="comment"># initiator-address 192.168.1.100 # 限制访问权限（示例仅允许指定IP）</span></span><br><span class="line">&lt;/target&gt;</span><br></pre></td></tr></table></figure></div>

<p>这里的 <em>iqn.2025-05.yourdomain:storage.sdb</em> 相当于该配置的 id，后续会使用到。<br>重启服务并验证配置，</p>
<p>如果想让不同的分区被不同的电脑挂载，就需要添加多个<target></target>标签，然后设置对应的允许访问 ip</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart tgt</span><br><span class="line">sudo tgtadm --mode target --op show  <span class="comment"># 查看目标状态</span></span><br></pre></td></tr></table></figure></div>

<p>开放 iSCSI 端口，iSCSI 默认使用 TCP <strong>3260</strong>端口，这里可以通过宝塔面板配置</p>
<h1 id="Windows-客户端挂载-​"><a href="#Windows-客户端挂载-​" class="headerlink" title="Windows 客户端挂载 ​"></a>Windows 客户端挂载 ​</h1><p>打开 <strong>iSCSI 发起程序</strong>，在 ​​ <strong>发现</strong> ​​ 标签页点击 <strong>发现门户</strong>，输入 Ubuntu 服务器 IP 和端口（默认 3260），<br>在 <strong>目标</strong> 标签页选择发现的 IQN（如 _iqn.2025-05.yourdomain:storage.sdb_），点击 <strong>连接</strong></p>
<h2 id="格式化硬盘并分区-1"><a href="#格式化硬盘并分区-1" class="headerlink" title="格式化硬盘并分区"></a>格式化硬盘并分区</h2><p>上一步完成后，如果你的新硬盘已经格式化并分区，就可以直接在 <strong>此电脑</strong> 中看到该硬盘，<br>如果看不到，说明硬盘的格式化工作或分区工作没做好，<br>可以在控制面板中搜索 <strong>创建并格式化硬盘分区</strong> 或者 <strong>磁盘管理</strong>，打开后查看该硬盘，<br>这里推荐 <a class="link"   href="https://www.disktool.cn/" >傲梅分区助手 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://pan.baidu.com/s/1CuBqxBVLFyEBY1n_hrv_kA?pwd=4z7q" >傲梅分区助手（百度网盘） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h1 id="已知问题"><a href="#已知问题" class="headerlink" title="已知问题"></a>已知问题</h1><h2 id="文件系统识别失败"><a href="#文件系统识别失败" class="headerlink" title="文件系统识别失败"></a>文件系统识别失败</h2><p>可能由于 Windows 和 Ubuntu 对于文件系统（exFAT、NTFS 等）的支持不统一，导致在 Windows 上格式化的文件系统无法在 Ubuntu 上挂载，而在 Ubuntu 上格式化的文件系统无法被 Windows 识别。</p>
<p>该问题可以通过关闭 tgt 服务后再格式化硬盘来解决</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">sync</span> &amp;&amp; sudo systemctl stop tgtd <span class="comment"># 同步硬盘后停止 tgt 服务</span></span><br></pre></td></tr></table></figure></div>

<p>在 Ubuntu 格式化为 exFAT 格式，Ubuntu 可以正常识别，但是在 Windows 上无法识别，可能会导致无法添加盘符和后续问题，通过以下方法解决。<br>在 windows 上运行 diskpart 命令。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">diskpart</span><br><span class="line">list disk <span class="comment"># 确认目标磁盘编号</span></span><br><span class="line">select disk X <span class="comment"># 选择目标磁盘（X 为编号）</span></span><br><span class="line">list partition <span class="comment"># 列出所有分区</span></span><br><span class="line">select partition Y <span class="comment"># 选择问题分区（Y 为编号）</span></span><br><span class="line">detail partition <span class="comment"># 查看当前分区类型标识</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> <span class="built_in">id</span>=EBD0A0A2-B9E5-4433-87C0-68B6B72699C7 <span class="comment"># GPT设置分区类型为 exFAT</span></span><br><span class="line"><span class="built_in">set</span> <span class="built_in">id</span>=07 override <span class="comment"># ​​MBR磁盘设置分区类型为 exFAT​​（override参数强制覆盖）</span></span><br><span class="line"></span><br><span class="line">assign letter=Z <span class="comment"># 设置盘符</span></span><br></pre></td></tr></table></figure></div>

<h2 id="数据丢失"><a href="#数据丢失" class="headerlink" title="数据丢失"></a>数据丢失</h2><p>服务器 rtcwake 时，可能导致硬盘休眠，导致数据丢失。</p>
<p>该问题可以通过关闭写入缓存来避免数据丢失，但会降低性能。<a class="link"   href="https://www.deepinghost.com/sem/win10/23774.html" >参考 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>。<br>如果你不想关闭写入缓存（写入缓存帮助还是挺大的），那么可以先同步缓存，再休眠。</p>
<p>创建一个刷盘服务，关键是要在 rtcwake 之前执行刷盘</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建刷盘服务文件 /etc/systemd/system/tgt-flush.service</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=Force TGT cache flush</span><br><span class="line">Before=rtcwake.service</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=oneshot</span><br><span class="line">ExecStart=/usr/bin/sudo /usr/sbin/tgt-admin --update ALL</span><br></pre></td></tr></table></figure></div>

<p>创建完成之后，执行下面的命令，就可以安全地使 iSCSI 进入休眠了</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl start tgt-flush <span class="comment"># 触发TGT缓存刷盘</span></span><br><span class="line"><span class="built_in">sync</span> <span class="comment"># 二次内核级同步</span></span><br><span class="line"><span class="built_in">echo</span> 3 &gt; /proc/sys/vm/drop_caches  <span class="comment"># 清除页面缓存</span></span><br><span class="line">rtcwake -m mem -s 1800 <span class="comment"># 执行挂起</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>命令行</tag>
        <tag>操作系统</tag>
        <tag>Linux</tag>
        <tag>文件系统</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>关于新建uniapp项目时的一些基本问题</title>
    <url>/2025/11/25/%E5%85%B3%E4%BA%8E%E6%96%B0%E5%BB%BAuniapp%E9%A1%B9%E7%9B%AE%E6%97%B6%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%9C%AC%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>主要都是写 Web 端，有时候会需要写 uniapp，但是老是会忘记一些基础概念，所以这里记录一下。</p>
<h1 id="使用-vscode-编写-uniapp-项目"><a href="#使用-vscode-编写-uniapp-项目" class="headerlink" title="使用 vscode 编写 uniapp 项目"></a>使用 vscode 编写 uniapp 项目</h1><p>我自己使用 vscode 写代码比 hbuilderx 顺手，并且 vscode 会有一些插件是 hubuilderx 没有的，所以需要使用 vscode 来替代 hbuilderx 编写和管理 uniapp 项目。</p>
<p><em>当然如果你还是喜欢用 hbuilderx 编写代码，这一章可以不看。</em></p>
<h2 id="vscode-插件"><a href="#vscode-插件" class="headerlink" title="vscode 插件"></a>vscode 插件</h2><ul>
<li>uni-helper<br>提供 uni-app API 的代码提示和语法高亮。例如“&#x2F;&#x2F; #ifdef APP-PLUS”这种语法</li>
<li>uni-create-view<br>右键快速创建页面、组件，并自动在 pages.json 中注册。</li>
<li>uniapp 小程序扩展<br>标签可用属性提示，鼠标悬停查看组件文档等功能。</li>
</ul>
<h2 id="从新建项目开始"><a href="#从新建项目开始" class="headerlink" title="从新建项目开始"></a>从新建项目开始</h2><p>基于 vue2 的 uniapp 项目创建命令如下：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装vue2命令行工具，如果你已经安装过，可以忽略，如果你不想全局安装，可以忽略 -g 参数</span></span><br><span class="line">npm install -g @vue/cli</span><br><span class="line"><span class="comment"># 创建vue2 for uniapp项目</span></span><br><span class="line">vue create -p dcloudio/uni-preset-vue my-vue2-for-uniapp</span><br><span class="line">npm install</span><br><span class="line"><span class="comment"># 运行/打包，这一步具体命令可以参考项目根目录下的package.json 文件</span></span><br><span class="line">npm run dev:h5</span><br></pre></td></tr></table></figure></div>

<p>基于 vue3 的 uniapp 项目创建命令如下：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装degit命令行工具，如果你不想全局安装，可以忽略 -g 参数</span></span><br><span class="line">npm install -g degit</span><br><span class="line"><span class="comment"># 创建vue3 for uniapp项目</span></span><br><span class="line">degit dcloudio/uni-preset-vue<span class="comment">#vite my-vue3-project</span></span><br><span class="line">npm install</span><br><span class="line"><span class="comment"># 运行/打包，这一步具体命令可以参考项目根目录下的package.json 文件</span></span><br><span class="line">npm run dev:h5</span><br></pre></td></tr></table></figure></div>

<p>基于 vue3 + ts 的 uniapp 项目创建命令如下：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装degit命令行工具，如果你不想全局安装，可以忽略 -g 参数</span></span><br><span class="line">npm install -g degit</span><br><span class="line"><span class="comment"># 创建vue3 for uniapp项目</span></span><br><span class="line">degit dcloudio/uni-preset-vue<span class="comment">#vite-ts my-vue3-ts-project</span></span><br><span class="line">npm install</span><br><span class="line"><span class="comment"># 运行/打包，这一步具体命令可以参考项目根目录下的package.json 文件</span></span><br><span class="line">npm run dev:h5</span><br></pre></td></tr></table></figure></div>

<p>注意：</p>
<ul>
<li>对于微信小程序的项目，命令执行后，用微信开发者工具导入项目下的 dist&#x2F;dev&#x2F;mp-weixin 目录即可预览和调试。</li>
<li>APP 平台限制：这是最重要的一点。如果你需要开发 APP，并且希望直接打包成 apk 或 ipa 文件，那么<strong>最终还是需要用到 HBuilderX 的云端打包功能</strong>。CLI 方式只能生成用于离线打包的 wgt 包</li>
</ul>
<h3 id="jsonc-处理"><a href="#jsonc-处理" class="headerlink" title="jsonc 处理"></a>jsonc 处理</h3><p>普通的 json 文件不允许使用注释，但是 jsonc(JSON with Comments) 文件允许使用注释。对于 uniapp 项目里的 manifest.json 文件和 pages.json 文件，建议改为 jsonc 文件格式。<br>改动方式为：打开文件，在 vscode 编辑器的右下角会显示当前文件类型，此时为 JSON，点击 JSON 图标，切换为 jsonc 文件格式。</p>
<h2 id="从已有项目开始"><a href="#从已有项目开始" class="headerlink" title="从已有项目开始"></a>从已有项目开始</h2><p>通常情况下，一个 uniapp 项目都是在 hbuilderx 里创建的，如果想要将一个一直使用 hbuilderx 管理的项目转为 vscode 可以管理的项目，就需要用到 vscode 的插件系统了，待续……</p>
<h1 id="第三方库问题"><a href="#第三方库问题" class="headerlink" title="第三方库问题"></a>第三方库问题</h1><p>uniapp 的第三方库管理，一般会使用<a class="link"   href="https://uniapp.dcloud.net.cn/plugin/uni_modules.html#uni-modules" >uni_modules <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，主要是为了满足多端开发的兼容性需求。</p>
<p>并不是说 uniapp 就不能使用 <a class="link"   href="https://uniapp.dcloud.net.cn/tutorial/page-script.html#npm%E6%94%AF%E6%8C%81" >node_modules <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 来管理第三方库了，如果你一定要使用 node_modules 来管理第三方库，那么你一定要注意兼容性问题，比如某些浏览器的特性 API，在小程序里是不能使用的。</p>
<h1 id="页面跳转问题"><a href="#页面跳转问题" class="headerlink" title="页面跳转问题"></a>页面跳转问题</h1><ul>
<li><a class="link"   href="https://uniapp.dcloud.net.cn/api/router.html#navigateto" >uni.navigateTo <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>保留当前页面，跳转到下一个页面，跳转时可以在 url 中传参。跳转后可以使用 <a class="link"   href="https://uniapp.dcloud.net.cn/api/router.html#navigateback" >uni.navigateBack <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 方法返回。</li>
<li><a class="link"   href="https://uniapp.dcloud.net.cn/api/router.html#redirectto" >uni.redirectTo <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>和 <a class="link"   href="https://uniapp.dcloud.net.cn/api/router.html#navigateto" >uni.navigateTo <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 类似，关闭当前页面，跳转到下一个页面，跳转后不能返回。</li>
<li><a class="link"   href="https://uniapp.dcloud.net.cn/api/router.html#relaunch" >uni.reLaunch <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>和 <a class="link"   href="https://uniapp.dcloud.net.cn/api/router.html#navigateto" >uni.navigateTo <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 类似，关闭所有页面，跳转到下一个页面，跳转后不能返回。</li>
<li><a class="link"   href="https://uniapp.dcloud.net.cn/api/router.html#switchtab" >uni.switchTab <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>关闭所有其他非 tabBar 页面，跳转到指定 tabBar 页面，url 需要在 pages.json 的 tabBar 中配置，且跳转时不能携带参数。</li>
</ul>
<h2 id="页面通信"><a href="#页面通信" class="headerlink" title="页面通信"></a>页面通信</h2><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">onLoad</span>(<span class="params">query</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// query 是页面跳转时携带的参数，例如“?id=1” 解析为 &#123; id: 1 &#125;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(query);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">onLunch</span>(<span class="params">options</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> query = options.<span class="property">query</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// query 是首次打开小程序携带的参数，例如“?id=1” 解析为 &#123; id: 1 &#125;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(query);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>如果想在页面之间传递大量数据，可以使用<a class="link"   href="https://uniapp.dcloud.net.cn/api/window/communication.html" >uni.$emit <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>以及<a class="link"   href="https://uniapp.dcloud.net.cn/api/window/communication.html" >uni.$on <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<br>示例如下：</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 发送方 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      uni.$emit(<span class="string">&quot;myEvent&quot;</span>, &#123; <span class="attr">msg</span>: <span class="string">&quot;页面更新&quot;</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 接受方 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      uni.$on(<span class="string">&quot;myEvent&quot;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data));</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="生命周期问题"><a href="#生命周期问题" class="headerlink" title="生命周期问题"></a>生命周期问题</h1><h2 id="应用生命周期"><a href="#应用生命周期" class="headerlink" title="应用生命周期"></a><a class="link"   href="https://uniapp.dcloud.net.cn/collocation/App.html#applifecycle" >应用生命周期 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h2><p>应用生命周期仅可以在 App.vue 中定义，不能在页面中定义。</p>
<h2 id="页面生命周期"><a href="#页面生命周期" class="headerlink" title="页面生命周期"></a><a class="link"   href="https://uniapp.dcloud.net.cn/tutorial/page.html#lifecycle" >页面生命周期 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h2><h2 id="vue-组件生命周期"><a href="#vue-组件生命周期" class="headerlink" title="vue 组件生命周期"></a><a class="link"   href="https://uniapp.dcloud.net.cn/tutorial/vue-api.html#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F" >vue 组件生命周期 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h2><h1 id="屏幕安全区域问题"><a href="#屏幕安全区域问题" class="headerlink" title="屏幕安全区域问题"></a>屏幕安全区域问题</h1><p>如果你的页面需要自定义顶部和底部的样式，比如：</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// pages.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/index/index&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;style&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;navigationStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;custom&quot;</span> <span class="comment">// 自定义导航栏</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>此时页面会开放屏幕上所有区域供你操作，像 APP 端和小程序端都是在手机上运行的，手机会有<strong>顶部状态栏</strong>、<strong>胶囊按钮（小程序特有）</strong>以及<strong>底部导航栏</strong>，这些区域一般是不能放置内容的，不然会出现界面错乱。</p>
<p>如果你使用了第三方组件库的顶部导航栏和底部菜单栏，那么组件库会帮你解决这些<strong>安全区域</strong>问题。</p>
<p>但如果你就是想自定义导航栏，那么就需要自己去获取<strong>安全区域</strong>，获取安全区域高度的方法如下：</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// mixin.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 安全区域距离顶部高度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">safeTop</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">safeAreaInsets</span>.<span class="property">top</span> || <span class="number">0</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 安全区域距离底部高度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">safeBottom</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">safeAreaInsets</span>.<span class="property">bottom</span> || <span class="number">0</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 小程序胶囊高度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">menuButtonHeight</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">menuButtonBoundingClientRect</span>.<span class="property">height</span> || <span class="number">0</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 小程序胶囊距离顶部高度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">menuButtonTop</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">menuButtonBoundingClientRect</span>.<span class="property">top</span> || <span class="number">0</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 安全区域（包括小程序胶囊）距离顶部高度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">safeTopWithMenuButton</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// #ifdef MP</span></span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">menuButtonHeight</span> + <span class="variable language_">this</span>.<span class="property">menuButtonTop</span>;</span><br><span class="line">      <span class="comment">// #endif</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">safeTop</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">initSafeArea</span>();</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化屏幕安全区域</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">initSafeArea</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">safeAreaInsets</span> = uni.<span class="title function_">getSystemInfoSync</span>().<span class="property">safeAreaInsets</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// #ifdef MP</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">menuButtonBoundingClientRect</span> = uni.<span class="title function_">getMenuButtonBoundingClientRect</span>();</span><br><span class="line">      <span class="comment">// #endif</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p>使用这些安全区域变量的方法如下：</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingTop: safeTopWithMenuButton + &#x27;px&#x27;, paddingBottom: safeBottom + &#x27;px&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;safe-area&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 引入mixin</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> mixin <span class="keyword">from</span> <span class="string">&quot;@/mixin.js&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">mixins</span>: [mixin],</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript">&lt;/&gt;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-javascript"><span class="selector-class">.container</span> &#123;</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-javascript">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-javascript">  <span class="attribute">background-color</span>: black;</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-javascript">  <span class="attribute">box-sizing</span>: border-box;</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-javascript">  <span class="selector-class">.safe-area</span> &#123;</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-javascript">    <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-javascript">    <span class="attribute">background-color</span>: gray;</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-javascript">  &#125;</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-javascript">&#125;</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span></span><br></pre></td></tr></table></figure></div>

<h1 id="图表（charts）开发"><a href="#图表（charts）开发" class="headerlink" title="图表（charts）开发"></a>图表（charts）开发</h1><p>推荐使用<a class="link"   href="https://www.ucharts.cn/v2/#/" >秋云 uCharts <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，简单使用可以在<a class="link"   href="https://www.ucharts.cn/v2/#/dwonload/index" >下载页面 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>下载<strong>组件版本</strong>如果想自定义一些样式，可以下载<strong>原生版本</strong>。<br>下载的第三方库需要导入进 uni_modules 文件夹。</p>
<p><a class="link"   href="https://www.ucharts.cn/v2/#/demo/index" >演示模板代码 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.ucharts.cn/v2/#/document/index" >详细文档 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h1 id="地图开发"><a href="#地图开发" class="headerlink" title="地图开发"></a>地图开发</h1><p>如果要展示地图，一般会使用 uniapp 自带的<a class="link"   href="https://uniapp.dcloud.net.cn/component/map.html" >map 内置组件 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，其实本质上还是调用第三方地图服务商的资源，所以需要到对应的地图服务商去申请 KEY，<br>然后将申请到的 KEY 添加到 manifest.json 文件中（一般是配置在“web 配置”或者“安卓&#x2F;ios 模块配置”）</p>
<p><strong>注意：如果你想更好地使用 map 组件，那么推荐使用<a class="link"   href="https://uniapp.dcloud.net.cn/tutorial/nvue-outline.html#nvue%E4%BB%8B%E7%BB%8D" >nvue 文件 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></strong><br><strong>原因有二：第一是 vue 文件中会存在 view 组件无法覆盖原生 map 组件的问题；第二是 nvue 比 vue 能使用的 map 组件的功能更多</strong></p>
<h2 id="获取地理位置城市名"><a href="#获取地理位置城市名" class="headerlink" title="获取地理位置城市名"></a>获取地理位置城市名</h2><p><em>注意：如果你已经在 manifest.json 文件中配置了第三方地图服务商，那么直接使用 uni.getLocation 方法即可，如果返回数据中没有地名，那么可以参考下面的方法</em></p>
<p>获取地理位置城市名，可以使用 <a class="link"   href="https://uniapp.dcloud.net.cn/api/location/location.html#getlocation" >uni.getLocation <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 方法，但是这个方法获取到的是经纬度，还需要使用 <a class="link"   href="https://uniapp.dcloud.net.cn/api/request/request.html#request" >uni.request <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 方法调用地图服务商获取地理位置信息。</p>
<p>使用 uni.getLocation 这类获取用户隐私信息的 API，都需要在 manifest.json 文件中配置权限。</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mp-weixin&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;appid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你的appid&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 添加权限</span></span><br><span class="line">    <span class="attr">&quot;permission&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;scope.userLocation&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;获取地址&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;requiredPrivateInfos&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;getLocation&quot;</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>使用第三方地图服务商提供的 API 时，需要在其开放平台上注册账号获取 KEY，并且为 KEY 配置逆地址解析权限。</p>
<p>对于小程序，需要将所有 uni.request 使用到的域名添加到白名单中。这个操作需要去<a class="link"   href="https://mp.weixin.qq.com/wxamp/index/index" >微信开放平台 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>中小程序-开发管理里面添加。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// mixin.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">getLocationInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> mapKey = <span class="string">&quot;你的地图服务商KEY&quot;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        uni.<span class="title function_">getLocation</span>(&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;gcj02&quot;</span>, <span class="comment">// 建议使用gcj02，和高德、腾讯地图是兼容的</span></span><br><span class="line">          <span class="attr">geocode</span>: <span class="literal">true</span>, <span class="comment">// 是否解析地址信息，仅App平台支持（安卓需指定 type 为 gcj02 并配置三方定位SDK）</span></span><br><span class="line">          <span class="attr">success</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> &#123; longitude, latitude, address &#125; = res;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果有地址信息，直接获取地址信息</span></span><br><span class="line">            <span class="keyword">if</span> (address) &#123;</span><br><span class="line">              <span class="title function_">resolve</span>(res);</span><br><span class="line">              <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 否则使用 request 调用地图服务商获取地址信息</span></span><br><span class="line">            uni.<span class="title function_">request</span>(&#123;</span><br><span class="line">              <span class="attr">url</span>: <span class="string">&quot;https://restapi.amap.com/v3/geocode/regeo&quot;</span>, <span class="comment">// 使用高德地图 API 获取地址信息，需要在其官网申请KEY，然后配置“逆地址解析”权限</span></span><br><span class="line">              <span class="attr">data</span>: &#123;</span><br><span class="line">                <span class="attr">key</span>: mapKey,</span><br><span class="line">                <span class="attr">location</span>: <span class="string">`<span class="subst">$&#123;longitude&#125;</span>,<span class="subst">$&#123;latitude&#125;</span>`</span>, <span class="comment">// 经度在前，纬度在后</span></span><br><span class="line">                <span class="attr">output</span>: <span class="string">&quot;JSON&quot;</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">success</span>: <span class="function">(<span class="params">apiRes</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (apiRes.<span class="property">statusCode</span> === <span class="number">200</span> &amp;&amp; apiRes.<span class="property">data</span>.<span class="property">status</span> === <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">                  <span class="keyword">const</span> addressComponent =</span><br><span class="line">                    apiRes.<span class="property">data</span>.<span class="property">regeocode</span>.<span class="property">addressComponent</span>;</span><br><span class="line">                  <span class="title function_">resolve</span>(&#123;</span><br><span class="line">                    ...res,</span><br><span class="line">                    <span class="attr">address</span>: addressComponent,</span><br><span class="line">                  &#125;);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  <span class="title function_">reject</span>(apiRes);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">fail</span>: reject,</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">fail</span>: reject,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p>使用方法如下：</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span>&gt;</span>&#123;&#123; cityName &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 引入mixin</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> mixin <span class="keyword">from</span> <span class="string">&quot;@/mixin.js&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">mixins</span>: [mixin],</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">cityName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> locationInfo = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getLocationInfo</span>();</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">cityName</span> = locationInfo.<span class="property">address</span>.<span class="property">city</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="nvue"><a href="#nvue" class="headerlink" title="nvue"></a>nvue</h1><p><a class="link"   href="https://uniapp.dcloud.net.cn/tutorial/nvue-outline.html#nvue%E4%BB%8B%E7%BB%8D" >nvue 介绍 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://uniapp.dcloud.net.cn/tutorial/nvue-outline.html#nvue%E5%BC%80%E5%8F%91%E4%B8%8Evue%E5%BC%80%E5%8F%91%E7%9A%84%E5%B8%B8%E8%A7%81%E5%8C%BA%E5%88%AB" >nvue 开发与 vue 开发的常见区别 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>简单介绍：</p>
<ul>
<li>nvue 能更好地使用<a class="link"   href="https://uniapp.dcloud.net.cn/component/map.html" >map 组件 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>、<a class="link"   href="https://uniapp.dcloud.net.cn/component/video.html" >video 组件 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>、<a class="link"   href="https://uniapp.dcloud.net.cn/component/live-pusher.html" >live-pusher 组件 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>nvue 在<a class="link"   href="https://uniapp.dcloud.net.cn/component/canvas.html" >canvas 组件 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>上性能不高（并不是不能用）</li>
<li>nvue<a class="link"   href="https://uniapp.dcloud.net.cn/tutorial/nvue-css.html#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" >不支持媒体查询 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>nvue 只能使用 flex 布局，不能使用其他布局</li>
</ul>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>uniapp</tag>
      </tags>
  </entry>
  <entry>
    <title>用CSS做一个椭圆轨道小球运动动画</title>
    <url>/2023/05/12/%E7%94%A8CSS%E5%81%9A%E4%B8%80%E4%B8%AA%E6%A4%AD%E5%9C%86%E8%BD%A8%E9%81%93%E5%B0%8F%E7%90%83%E8%BF%90%E5%8A%A8%E5%8A%A8%E7%94%BB/</url>
    <content><![CDATA[<p>个人CSS技能查漏补缺系列  </p>
<p>关键在于使用关键帧(keyframs)时让两个动画重叠，并让其中一个动画延迟  </p>
<p>直接上代码  </p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#wrapper</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attr">--ballCount</span>: <span class="number">2</span>; <span class="comment">/* 小球数量 */</span></span></span><br><span class="line"><span class="language-css">            <span class="attr">--ballAnimTime</span>: <span class="number">1s</span>; <span class="comment">/* 动画单轮总时间 */</span></span></span><br><span class="line"><span class="language-css">            <span class="attr">--ballAnimDeley</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--ballAnimTime) / <span class="number">4</span>); <span class="comment">/* 为了实现椭圆轨迹而计算的延迟时间，为单轮总时间除以4 */</span></span></span><br><span class="line"><span class="language-css">            <span class="attr">--ballUnitAnimTime</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--ballAnimTime) / <span class="built_in">var</span>(--ballCount)); <span class="comment">/* 小球延迟，为单轮总时间除以小球数量 */</span></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">60vw</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">30vw</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">resize</span>: auto;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#wrapper</span> &gt; <span class="selector-class">.ball</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">2vw</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">2vw</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: blue;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/* Y轴移动动画 */</span></span></span><br><span class="line"><span class="language-css">        <span class="keyword">@keyframes</span> moveY &#123;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">from</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">to</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">top</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="comment">/* X轴移动动画 */</span></span></span><br><span class="line"><span class="language-css">        <span class="keyword">@keyframes</span> moveX &#123;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">from</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">to</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">left</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#wrapper</span> &gt; <span class="selector-class">.ball1</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="comment">/* moveY需要比moveX延迟一段时间，才能显示出椭圆轨迹，这个时间为--ballAnimDeley*/</span></span></span><br><span class="line"><span class="language-css">            <span class="comment">/* animation: name duration timing-function delay iteration-count direction fill-mode; */</span></span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation</span>: </span></span><br><span class="line"><span class="language-css">            moveY <span class="built_in">calc</span>(<span class="built_in">var</span>(--ballAnimTime) / <span class="number">2</span>) <span class="built_in">cubic-bezier</span>(<span class="number">0.6</span>, <span class="number">0.3</span>, <span class="number">0.3</span>, <span class="number">0.6</span>) <span class="built_in">calc</span>(-<span class="number">1</span> * (<span class="built_in">var</span>(--ballAnimDeley) + <span class="number">0</span> * <span class="built_in">var</span>(--ballUnitAnimTime))) infinite alternate,</span></span><br><span class="line"><span class="language-css">            moveX <span class="built_in">calc</span>(<span class="built_in">var</span>(--ballAnimTime) / <span class="number">2</span>) <span class="built_in">cubic-bezier</span>(<span class="number">0.6</span>, <span class="number">0.3</span>, <span class="number">0.3</span>, <span class="number">0.6</span>) <span class="built_in">calc</span>(-<span class="number">1</span> * <span class="number">0</span> * <span class="built_in">var</span>(--ballUnitAnimTime)) infinite alternate;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#wrapper</span> &gt; <span class="selector-class">.ball2</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation</span>: </span></span><br><span class="line"><span class="language-css">            moveY <span class="built_in">calc</span>(<span class="built_in">var</span>(--ballAnimTime) / <span class="number">2</span>) <span class="built_in">cubic-bezier</span>(<span class="number">0.6</span>, <span class="number">0.3</span>, <span class="number">0.3</span>, <span class="number">0.6</span>) <span class="built_in">calc</span>(-<span class="number">1</span> * (<span class="built_in">var</span>(--ballAnimDeley) + <span class="number">1</span> * <span class="built_in">var</span>(--ballUnitAnimTime))) infinite alternate,</span></span><br><span class="line"><span class="language-css">            moveX <span class="built_in">calc</span>(<span class="built_in">var</span>(--ballAnimTime) / <span class="number">2</span>) <span class="built_in">cubic-bezier</span>(<span class="number">0.6</span>, <span class="number">0.3</span>, <span class="number">0.3</span>, <span class="number">0.6</span>) <span class="built_in">calc</span>(-<span class="number">1</span> * <span class="number">1</span> * <span class="built_in">var</span>(--ballUnitAnimTime)) infinite alternate;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>线框右下角可以拖拽改变大小<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ball ball1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ball ball2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- more --&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>参考<a class="link"   href="https://www.cnblogs.com/lin494910940/p/14051631.html" >https://www.cnblogs.com/lin494910940/p/14051631.html <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<hr>
<hr>
<h1 id="用Javascript实现"><a href="#用Javascript实现" class="headerlink" title="用Javascript实现"></a>用Javascript实现</h1><p>后来发现css实现的效果不好，小球运动到盒子四边时会有明显的碰撞感，所以这里用js实现一下</p>
<p>目录结构</p>
<ul>
<li>EllipsisGenerator.js</li>
<li>index.html</li>
</ul>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// EllipsisGenerator.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 椭圆轨道坐标生成器类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EllipsisGenerator</span> &#123;</span><br><span class="line">    x;</span><br><span class="line">    y;</span><br><span class="line">    a;</span><br><span class="line">    b;</span><br><span class="line">    angle;</span><br><span class="line">    angleStep;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造一个椭圆轨道</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; x 圆心x坐标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; y 圆心y坐标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; a x轴半径长度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; b y轴半径长度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; angle 起始角度 单位deg</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; angleStep 角度自增值 单位deg</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">x, y, a, b, angle = <span class="number">0</span>, angleStep = <span class="number">1</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">x</span> = x;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">y</span> = y;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">a</span> = a;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">b</span> = b;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">angle</span> = angle;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">angleStep</span> = angleStep;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * *generate方法返回一个迭代器，每次调用迭代器的next方法就会使角度(this.angle)自增(this.angleStep)，</span></span><br><span class="line"><span class="comment">     * 然后返回角度射线与椭圆轨道的交点坐标(x,y)，即椭圆轨道坐标</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    *<span class="title function_">generate</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> radians = <span class="variable language_">this</span>.<span class="property">angle</span> * <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">180</span></span><br><span class="line">                , tx = <span class="variable language_">this</span>.<span class="property">a</span> * <span class="title class_">Math</span>.<span class="title function_">cos</span>(radians)</span><br><span class="line">                , ty = <span class="variable language_">this</span>.<span class="property">b</span> * <span class="title class_">Math</span>.<span class="title function_">sin</span>(radians);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">yield</span> &#123;</span><br><span class="line">                <span class="attr">x</span>: <span class="variable language_">this</span>.<span class="property">x</span> + tx,</span><br><span class="line">                <span class="attr">y</span>: <span class="variable language_">this</span>.<span class="property">y</span> + ty</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">angle</span> &gt;= <span class="number">360</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">angle</span> = <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">angle</span> += <span class="variable language_">this</span>.<span class="property">angleStep</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border: 1px solid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./EllipsisGenerator.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> bubbleCount = <span class="number">100</span>; <span class="comment">// 球球数量</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> bubbleRadius = <span class="number">10</span>; <span class="comment">// 球球半径</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> frameRate = <span class="number">40</span>; <span class="comment">// 渲染帧数；每秒40帧</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> bubbleColor = <span class="string">&#x27;yellowgreen&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> bubbles = [];</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">class</span> <span class="title class_">Bubble</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                x;</span></span><br><span class="line"><span class="language-javascript">                y;</span></span><br><span class="line"><span class="language-javascript">                r;</span></span><br><span class="line"><span class="language-javascript">                alpha;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">constructor</span>(<span class="params">x = <span class="number">0</span>, y = <span class="number">0</span>, r = <span class="number">1</span>, alpha = <span class="number">1</span></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">x</span> = x;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">y</span> = y;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">r</span> = r;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">alpha</span> = alpha;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> $star = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;container&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> width = <span class="number">600</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> height = <span class="number">400</span>;</span></span><br><span class="line"><span class="language-javascript">            $star.<span class="property">width</span> = width;</span></span><br><span class="line"><span class="language-javascript">            $star.<span class="property">height</span> = height;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> elliptic = <span class="keyword">new</span> <span class="title class_">EllipsisGenerator</span>(</span></span><br><span class="line"><span class="language-javascript">                width / <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">                height / <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">                width / <span class="number">2</span> - bubbleRadius,</span></span><br><span class="line"><span class="language-javascript">                height / <span class="number">2</span> - bubbleRadius,</span></span><br><span class="line"><span class="language-javascript">                <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">                -<span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">            );</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> generate = elliptic.<span class="title function_">generate</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> ctx = $star.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> <span class="title function_">run</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">                ctx.<span class="title function_">clearRect</span>(<span class="number">0</span>, <span class="number">0</span>, width, height);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> &#123; x, y &#125; = generate.<span class="title function_">next</span>().<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (bubbles.<span class="property">length</span> &gt;= bubbleCount) &#123;</span></span><br><span class="line"><span class="language-javascript">                    bubbles.<span class="title function_">shift</span>();</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> bubble = <span class="keyword">new</span> <span class="title class_">Bubble</span>(x, y, <span class="number">2</span>);</span></span><br><span class="line"><span class="language-javascript">                bubbles.<span class="title function_">push</span>(bubble);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//渲染bubble数组</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; bubbles.<span class="property">length</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">let</span> bubble = bubbles[i];</span></span><br><span class="line"><span class="language-javascript">                    bubble.<span class="property">alpha</span> = (i + <span class="number">1</span>) * (<span class="number">1</span> / bubbleCount);</span></span><br><span class="line"><span class="language-javascript">                    bubble.<span class="property">r</span> = bubble.<span class="property">r</span> * (i + <span class="number">1</span>) * (<span class="number">1</span> / bubbleCount);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                    ctx.<span class="title function_">save</span>();</span></span><br><span class="line"><span class="language-javascript">                    ctx.<span class="title function_">beginPath</span>();</span></span><br><span class="line"><span class="language-javascript">                    ctx.<span class="property">globalAlpha</span> = bubble.<span class="property">alpha</span> * <span class="number">0.5</span>;</span></span><br><span class="line"><span class="language-javascript">                    ctx.<span class="property">fillStyle</span> = bubbleColor;</span></span><br><span class="line"><span class="language-javascript">                    ctx.<span class="title function_">arc</span>(</span></span><br><span class="line"><span class="language-javascript">                        bubble.<span class="property">x</span>,</span></span><br><span class="line"><span class="language-javascript">                        bubble.<span class="property">y</span>,</span></span><br><span class="line"><span class="language-javascript">                        bubble.<span class="property">r</span> * <span class="number">4</span>,</span></span><br><span class="line"><span class="language-javascript">                        <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">                        <span class="number">2</span> * <span class="title class_">Math</span>.<span class="property">PI</span>,</span></span><br><span class="line"><span class="language-javascript">                        <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">                    );</span></span><br><span class="line"><span class="language-javascript">                    ctx.<span class="title function_">fill</span>();</span></span><br><span class="line"><span class="language-javascript">                    ctx.<span class="title function_">restore</span>();</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">requestAnimationFrame</span>(run);</span></span><br><span class="line"><span class="language-javascript">                &#125;, <span class="number">1000</span> / frameRate);</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">run</span>();</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
        <tag>javascript</tag>
        <tag>特效</tag>
        <tag>canvas</tag>
      </tags>
  </entry>
  <entry>
    <title>用CSS画一个正方形</title>
    <url>/2023/05/12/%E7%94%A8CSS%E7%94%BB%E4%B8%80%E4%B8%AA%E6%AD%A3%E6%96%B9%E5%BD%A2/</url>
    <content><![CDATA[<p>个人 CSS 技能查漏补缺系列</p>
<p>关键在于 padding-top 和 padding-bottom 使用百分比(%)单位时是基于元素的 width 来计算的。</p>
<p>直接上代码</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="keyword">@keyframes</span> show &#123;</span></span><br><span class="line"><span class="language-css">                <span class="number">0%</span> &#123;</span></span><br><span class="line"><span class="language-css">                    <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                    <span class="attribute">height</span>: <span class="number">240px</span>;</span></span><br><span class="line"><span class="language-css">                &#125;</span></span><br><span class="line"><span class="language-css">                <span class="number">25%</span> &#123;</span></span><br><span class="line"><span class="language-css">                    <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">                    <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">                &#125;</span></span><br><span class="line"><span class="language-css">                <span class="number">50%</span> &#123;</span></span><br><span class="line"><span class="language-css">                    <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">                    <span class="attribute">height</span>: <span class="number">240px</span>;</span></span><br><span class="line"><span class="language-css">                &#125;</span></span><br><span class="line"><span class="language-css">                <span class="number">75%</span> &#123;</span></span><br><span class="line"><span class="language-css">                    <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                    <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">                &#125;</span></span><br><span class="line"><span class="language-css">                <span class="number">100%</span> &#123;</span></span><br><span class="line"><span class="language-css">                    <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                    <span class="attribute">height</span>: <span class="number">240px</span>;</span></span><br><span class="line"><span class="language-css">                &#125;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#wrapper</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">animation</span>: show <span class="number">5s</span> linear <span class="number">0s</span> infinite;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#wrapper</span> &gt; <span class="selector-id">#cube</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attr">--side</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="built_in">var</span>(--side);</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--side) / <span class="number">2</span>) <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: blue;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>不管线框容器宽高怎么变，蓝色区块的宽高始终相等<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;cube&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
      </tags>
  </entry>
  <entry>
    <title>用css3实现一个星球节点旋转效果图</title>
    <url>/2023/02/05/%E7%94%A8css3%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%98%9F%E7%90%83%E8%8A%82%E7%82%B9%E6%97%8B%E8%BD%AC%E6%95%88%E6%9E%9C%E5%9B%BE/</url>
    <content><![CDATA[<h3 id="点击查看效果图"><a href="#点击查看效果图" class="headerlink" title="点击查看效果图"></a><a href="/mypage/%E7%94%A8css3%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%98%9F%E7%90%83%E8%8A%82%E7%82%B9%E6%97%8B%E8%BD%AC%E6%95%88%E6%9E%9C%E5%9B%BE/index.html">点击查看效果图</a></h3><hr>
<p><strong>本来看到这个需求我还在想自己造轮子，第一个方案就是用css3的transform实现，后来因为自己实在太弱了，做不出来，没办法，还是去找大佬的轮子~</strong><br><strong>等后面有机会了再试试能不能自己写出来~</strong></p>
<hr>
<p>这个效果使用了<a class="link"   href="https://github.com/NiklasKnaack/jquery-svg3dtagcloud-plugin" >jquery-svg3dtagcloud-plugin <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>插件<br>源码直接放在下面了，如果需要可以直接复制修改</p>
<span id="more"></span>

<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>用css3实现一个星球节点旋转效果图<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;holder&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 这里可以配合jquery使用，也可以不用jquery独立使用 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;script src=&quot;../common/jquery-1.12.4.min.js&quot;&gt;&lt;/script&gt; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./jquery.svg3dtagcloud.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 设置要显示的条目</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> entries = [</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;中国&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;美国&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;加拿大&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;日本&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;墨西哥&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;英国&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;法国&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;德国&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;西班牙&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;古巴&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;利比亚&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;韩国&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                &#123; <span class="attr">label</span>: <span class="string">&#x27;俄罗斯&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/mypage/用css3实现一个星球节点旋转效果图&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">            ]</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 设置参数</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> settings = &#123;</span></span><br><span class="line"><span class="language-javascript">                entries,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">width</span>: <span class="number">480</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">height</span>: <span class="number">480</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">radius</span>: <span class="string">&#x27;65%&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">radiusMin</span>: <span class="number">75</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">bgDraw</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">bgColor</span>: <span class="string">&#x27;white&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">opacityOver</span>: <span class="number">1.00</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">opacityOut</span>: <span class="number">0.05</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">opacitySpeed</span>: <span class="number">6</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">fov</span>: <span class="number">800</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">speed</span>: <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">fontFamily</span>: <span class="string">&#x27;Oswald, Arial, sans-serif&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">fontSize</span>: <span class="string">&#x27;15&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">fontColor</span>: <span class="string">&#x27;#333&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">fontWeight</span>: <span class="string">&#x27;normal&#x27;</span>,<span class="comment">//bold</span></span></span><br><span class="line"><span class="language-javascript">                <span class="attr">fontStyle</span>: <span class="string">&#x27;normal&#x27;</span>,<span class="comment">//italic </span></span></span><br><span class="line"><span class="language-javascript">                <span class="attr">fontStretch</span>: <span class="string">&#x27;normal&#x27;</span>,<span class="comment">//wider, narrower, ultra-condensed, extra-condensed, condensed, semi-condensed, semi-expanded, expanded, extra-expanded, ultra-expanded</span></span></span><br><span class="line"><span class="language-javascript">                <span class="attr">fontToUpperCase</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">tooltipFontFamily</span>: <span class="string">&#x27;Oswald, Arial, sans-serif&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">tooltipFontSize</span>: <span class="string">&#x27;11&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">tooltipFontColor</span>: <span class="string">&#x27;#fff&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">tooltipFontWeight</span>: <span class="string">&#x27;normal&#x27;</span>,<span class="comment">//bold</span></span></span><br><span class="line"><span class="language-javascript">                <span class="attr">tooltipFontStyle</span>: <span class="string">&#x27;normal&#x27;</span>,<span class="comment">//italic </span></span></span><br><span class="line"><span class="language-javascript">                <span class="attr">tooltipFontStretch</span>: <span class="string">&#x27;normal&#x27;</span>,<span class="comment">//wider, narrower, ultra-condensed, extra-condensed, condensed, semi-condensed, semi-expanded, expanded, extra-expanded, ultra-expanded</span></span></span><br><span class="line"><span class="language-javascript">                <span class="attr">tooltipFontToUpperCase</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">tooltipTextAnchor</span>: <span class="string">&#x27;left&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">tooltipDiffX</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">tooltipDiffY</span>: <span class="number">10</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">animatingSpeed</span>: <span class="number">0.01</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">animatingRadiusLimit</span>: <span class="number">1.3</span></span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 这里可以配合jquery使用，也可以不用jquery独立使用</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// $( &#x27;#holder&#x27; ).svg3DTagCloud( settings );</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> svg3DTagCloud = <span class="keyword">new</span> <span class="title class_">SVG3DTagCloud</span>( <span class="variable language_">document</span>.<span class="title function_">getElementById</span>( <span class="string">&#x27;holder&#x27;</span>  ), settings );</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
        <tag>特效</tag>
        <tag>面试题</tag>
        <tag>SVG</tag>
      </tags>
  </entry>
  <entry>
    <title>电脑多网卡分流</title>
    <url>/2025/05/09/%E7%94%B5%E8%84%91%E5%A4%9A%E7%BD%91%E5%8D%A1%E5%88%86%E6%B5%81/</url>
    <content><![CDATA[<p>如果想让笔记本电脑的<strong>有线网卡</strong>和<strong>无线网卡</strong>同时起作用，例如大部分数据从有线网卡传输，少部分数据从无线网卡传输，就可以如下操作</p>
<span id="more"></span>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">:: 查询当前网卡状态</span><br><span class="line">:: 找到网卡的网关地址，例如有线网网关是 192.168.2.1 ；无线网网关是 192.168.0.1</span><br><span class="line">ipconfig</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:: 查询当前路由表</span><br><span class="line">:: 默认情况下IPv4和IPv6是没有永久路由的，注意在列出的信息中甄别</span><br><span class="line">route <span class="built_in">print</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:: 根据需要，可以删除永久路由</span><br><span class="line">:: 这里删除的永久路由是默认ip，即0.0.0.0代表所有ip地址</span><br><span class="line">route delete 0.0.0.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:: 添加永久路由（特列）</span><br><span class="line">:: 这里添加了一个特例路由，即访问 192.168.2.99 这个ip，只能走 192.168.2.1 这个网关（有线网卡）</span><br><span class="line">:: 子网掩码 255.255.255.255 表示仅匹配单个IP 192.168.2.99</span><br><span class="line">route -p add 192.168.2.99 mask 255.255.255.255 192.168.2.1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:: 添加永久路由（默认）</span><br><span class="line">:: 这里添加了一个默认路由，即访问其他所有ip，都会走 192.168.0.1 这个网关（无线网卡）</span><br><span class="line">:: 子网掩码 0.0.0.0 表示不限制ip</span><br><span class="line">route -p add 0.0.0.0 mask 0.0.0.0 192.168.0.1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:: 检查路由表是否配置成功（查看永久路由）</span><br><span class="line">route <span class="built_in">print</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:: 测试有线网卡（未接入internet，仅局域网）</span><br><span class="line">:: 测试是否连通</span><br><span class="line">ping 192.168.2.99</span><br><span class="line">:: 测试数据是否经过有线网卡</span><br><span class="line">tracert 192.168.2.99</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:: 测试无线网卡（已接入internet，可访问公网）</span><br><span class="line">:: 测试是否连通</span><br><span class="line">ping www.baidu.com</span><br><span class="line">:: 测试数据是否经过无线网卡</span><br><span class="line">tracert www.baidu.com</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>命令行</tag>
        <tag>操作系统</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>实现一个文字与背景反色的进度条</title>
    <url>/2024/05/24/%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%96%87%E5%AD%97%E4%B8%8E%E8%83%8C%E6%99%AF%E5%8F%8D%E8%89%B2%E7%9A%84%E8%BF%9B%E5%BA%A6%E6%9D%A1/</url>
    <content><![CDATA[<p>如图所示，代码放在下面了，可根据实际情况扩展功能</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716520108477_48dda8b77af14f55a65e135881118747.png"
                     
                ></p>
<span id="more"></span>

<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>文字与背景反色的进度条<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.wrapper</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#e4f3ff</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">125px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.font</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">left</span>: <span class="number">0%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">top</span>: <span class="number">0%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">z-index</span>: <span class="number">2</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(</span></span><br><span class="line"><span class="language-css">          to right,</span></span><br><span class="line"><span class="language-css">          <span class="number">#ffffff</span> <span class="number">0%</span>,</span></span><br><span class="line"><span class="language-css">          <span class="number">#ffffff</span> <span class="number">0%</span>,</span></span><br><span class="line"><span class="language-css">          <span class="number">#555555</span> <span class="number">0%</span>,</span></span><br><span class="line"><span class="language-css">          <span class="number">#555555</span> <span class="number">100%</span></span></span><br><span class="line"><span class="language-css">        );</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-clip</span>: text;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: transparent;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.bar</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">left</span>: <span class="number">0%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">top</span>: <span class="number">0%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">z-index</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">0%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#2c96e0</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">min</span>=<span class="string">&quot;0&quot;</span> <span class="attr">max</span>=<span class="string">&quot;100&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;font&quot;</span>&gt;</span>0%<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> $input = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;input&quot;</span>)[<span class="number">0</span>];</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> $font = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;font&quot;</span>)[<span class="number">0</span>];</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> $bar = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;bar&quot;</span>)[<span class="number">0</span>];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">setPercent</span>(<span class="params">percent</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        $font.<span class="property">style</span>.<span class="property">backgroundImage</span> = <span class="string">`linear-gradient(to right, #ffffff 0%, #ffffff <span class="subst">$&#123;percent&#125;</span>%, #555555 <span class="subst">$&#123;percent&#125;</span>%, #555555 100%)`</span>;</span></span><br><span class="line"><span class="language-javascript">        $font.<span class="property">innerText</span> = <span class="string">`<span class="subst">$&#123;percent&#125;</span>%`</span>;</span></span><br><span class="line"><span class="language-javascript">        $bar.<span class="property">style</span>.<span class="property">width</span> = <span class="string">`<span class="subst">$&#123;percent&#125;</span>%`</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      $input.<span class="property">onchange</span> = <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> percent = ev.<span class="property">target</span>.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (percent &lt; <span class="number">0</span>) percent = ev.<span class="property">target</span>.<span class="property">value</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (percent &gt; <span class="number">100</span>) percent = ev.<span class="property">target</span>.<span class="property">value</span> = <span class="number">100</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">setPercent</span>(percent);</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>百度地图动态设置ak</title>
    <url>/2023/12/26/%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AEak/</url>
    <content><![CDATA[<p>通常使用百度地图是这样的</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 调用百度地图API --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">&quot;https://api.map.baidu.com/api?v=3.0&amp;ak=您的密钥&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>但是遇到需要动态设置 ak 的情况，比如在线上环境和开发环境，需要使用不同的 ak，那么就需要使用动态加载的方式。<br>已知 document.write()方法可以同步动态加载 js 文件，那么我们可以将 ak 写在 js 文件中，然后在 html 中调用即可。</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 调用百度地图API --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> ak = <span class="string">&quot;您的密钥&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 动态修改ak</span></span><br><span class="line">  ak = <span class="string">&quot;我的密钥&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">`</span></span><br><span class="line"><span class="string">        &lt;script type=&quot;text/javascript&quot; src=&quot;https://api.map.baidu.com/api?v=3.0&amp;ak=<span class="subst">$&#123;ak&#125;</span>&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">    `</span>);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>百度地图</tag>
      </tags>
  </entry>
  <entry>
    <title>百度地图Polyline不显示的另类解决方案</title>
    <url>/2023/12/26/%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BEPolyline%E4%B8%8D%E6%98%BE%E7%A4%BA%E7%9A%84%E5%8F%A6%E7%B1%BB%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
    <content><![CDATA[<p>项目需要使用百度地图，但是项目是不连接互联网的，所以无法通过正常方式引用百度地图 API，只用通过代理使用百度地图 API，类似于下面的代码。</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 通过代理地址“192.168.1.1”调用百度地图API --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">&quot;http://192.168.1.1/api.map.baidu.com/api?v=3.0&amp;ak=您的密钥&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>此种代理方式会导致百度地图的折线<strong>Polyline</strong>无法正常使用（原因未知），所以需要另辟蹊径解决。<br>我的方法就是根据已知的<strong>经纬度点数组</strong>，通过<strong>SVG</strong>把折线画出来，然后覆盖到百度地图上，替代无法使用的<strong>Polyline</strong>。<br>代码如下：</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100vw</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#container</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#map</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#mySvg</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">pointer-events</span>: none;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 调用百度地图API --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">&quot;https://api.map.baidu.com/api?v=3.0&amp;ak=您的ak密钥&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">id</span>=<span class="string">&quot;mySvg&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 经纬度点数组</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> points = [</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">lng</span>: <span class="number">116.404</span>, <span class="attr">lat</span>: <span class="number">39.915</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">lng</span>: <span class="number">116.405</span>, <span class="attr">lat</span>: <span class="number">39.92</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">lng</span>: <span class="number">116.423493</span>, <span class="attr">lat</span>: <span class="number">39.907445</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      ];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 格式化百度地图经纬度</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">formatPoint</span> = (<span class="params">point</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (point <span class="keyword">instanceof</span> <span class="title class_">Array</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="built_in">parseFloat</span>(point[<span class="number">0</span>]), <span class="built_in">parseFloat</span>(point[<span class="number">1</span>]));</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (point <span class="keyword">instanceof</span> <span class="title class_">Object</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="built_in">parseFloat</span>(point.<span class="property">lng</span>), <span class="built_in">parseFloat</span>(point.<span class="property">lat</span>));</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> $map = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;map&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> $mySvg = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;mySvg&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 实例化地图</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>($map);</span></span><br><span class="line"><span class="language-javascript">      map.<span class="title function_">enableScrollWheelZoom</span>();</span></span><br><span class="line"><span class="language-javascript">      map.<span class="title function_">disableDoubleClickZoom</span>();</span></span><br><span class="line"><span class="language-javascript">      map.<span class="title function_">centerAndZoom</span>(<span class="title function_">formatPoint</span>(points[<span class="number">0</span>]), <span class="number">15</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 绘制自定义折线</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">addCusPolyline</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 核心代码，转化经纬度点为DOM的偏移位置</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> pixels = points.<span class="title function_">map</span>(<span class="function">(<span class="params">point</span>) =&gt;</span></span></span><br><span class="line"><span class="language-javascript">          map.<span class="title function_">pointToPixel</span>(<span class="title function_">formatPoint</span>(point))</span></span><br><span class="line"><span class="language-javascript">        );</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> d = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; pixels.<span class="property">length</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> pixel = pixels[i];</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (i === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            d += <span class="string">`M <span class="subst">$&#123;pixel.x&#125;</span>, <span class="subst">$&#123;pixel.y&#125;</span> `</span>;</span></span><br><span class="line"><span class="language-javascript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            d += <span class="string">`L <span class="subst">$&#123;pixel.x&#125;</span>, <span class="subst">$&#123;pixel.y&#125;</span> `</span>;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> pathStr = <span class="string">`&lt;path d=&quot;<span class="subst">$&#123;d&#125;</span>&quot; style=&quot;fill-opacity: 0; stroke: red; stroke-width: 2;&quot;&gt;&lt;/path&gt; `</span>;</span></span><br><span class="line"><span class="language-javascript">        $mySvg.<span class="title function_">setAttribute</span>(</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;viewBox&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="string">`0 0 <span class="subst">$&#123;$mySvg.clientWidth&#125;</span> <span class="subst">$&#123;$mySvg.clientHeight&#125;</span>`</span></span></span><br><span class="line"><span class="language-javascript">        );</span></span><br><span class="line"><span class="language-javascript">        $mySvg.<span class="property">innerHTML</span> = pathStr;</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">addCusPolyline</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 清空自定义折线</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">removePolyline</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        $mySvg.<span class="property">innerHTML</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 地图事件处理，为了更好的展示自定义折线图</span></span></span><br><span class="line"><span class="language-javascript">      map.<span class="title function_">removeEventListener</span>(<span class="string">&quot;zoomstart&quot;</span>, removePolyline);</span></span><br><span class="line"><span class="language-javascript">      map.<span class="title function_">removeEventListener</span>(<span class="string">&quot;dragstart&quot;</span>, removePolyline);</span></span><br><span class="line"><span class="language-javascript">      map.<span class="title function_">removeEventListener</span>(<span class="string">&quot;tilesloaded&quot;</span>, addCusPolyline);</span></span><br><span class="line"><span class="language-javascript">      map.<span class="title function_">addEventListener</span>(<span class="string">&quot;zoomstart&quot;</span>, removePolyline);</span></span><br><span class="line"><span class="language-javascript">      map.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragstart&quot;</span>, removePolyline);</span></span><br><span class="line"><span class="language-javascript">      map.<span class="title function_">addEventListener</span>(<span class="string">&quot;tilesloaded&quot;</span>, addCusPolyline);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>SVG</tag>
        <tag>百度地图</tag>
      </tags>
  </entry>
  <entry>
    <title>第一篇文章哦</title>
    <url>/2023/03/16/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%93%A6/</url>
    <content><![CDATA[<h2 id="别催"><a href="#别催" class="headerlink" title="别催!!"></a>别催!!</h2><h3 id="作者正在长脑子"><a href="#作者正在长脑子" class="headerlink" title="作者正在长脑子~"></a>作者正在长脑子~</h3><h4 id="别急。快了！快有内容了！"><a href="#别急。快了！快有内容了！" class="headerlink" title="别急。快了！快有内容了！"></a>别急。快了！快有内容了！</h4><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;打点代码证明脑子快就长好了！&#x27;</span>);</span><br></pre></td></tr></table></figure></div>]]></content>
  </entry>
  <entry>
    <title>看看你的工作性价比</title>
    <url>/2024/05/21/%E7%9C%8B%E7%9C%8B%E4%BD%A0%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%80%A7%E4%BB%B7%E6%AF%94/</url>
    <content><![CDATA[<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716260175540_a69a8d36eefe2e115b6357ca286d24d9.png"
                     
                ></p>
<span id="more"></span>

<p><a class="link"   href="https://t.xx-xx.top/costPerformanceForJob.html" >预览地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>玩具</tag>
      </tags>
  </entry>
  <entry>
    <title>简单记录一下Java的基础开发过程</title>
    <url>/2023/06/08/%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8BJava%E7%9A%84%E5%9F%BA%E7%A1%80%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B/</url>
    <content><![CDATA[<h1 id="开发环境安装"><a href="#开发环境安装" class="headerlink" title="开发环境安装"></a>开发环境安装</h1><h2 id="JDK-安装和管理"><a href="#JDK-安装和管理" class="headerlink" title="JDK 安装和管理"></a>JDK 安装和管理</h2><p>这里推荐使用 <a class="link"   href="https://github.com/shyiko/jabba" >JDK 版本管理器 jabba <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>注意：</strong></p>
<ul>
<li><strong>需要使用 <em>PowerShell</em> 来安装和更新 jabba，</strong></li>
<li><strong><del>如果后续需要使用 <em>CMD</em> 来管理 JDK 版本，需要先将 jabba 的可执行文件添加到环境变量</del>，要正常使用 jabba 的 JDK 版本切换功能，必须在 <em>PowerShell</em> 环境下</strong></li>
<li><strong>切换 JDK 版本只有在本次 <em>PowerShell</em> 打开时有效，关闭后重新打开需要再次设置 JDK 版本</strong></li>
</ul>
<div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 为windows10安装jabba</span></span><br><span class="line"><span class="comment"># (use the same command to upgrade)</span></span><br><span class="line">[<span class="type">Net.ServicePointManager</span>]::SecurityProtocol = [<span class="type">Net.SecurityProtocolType</span>]::Tls12</span><br><span class="line"><span class="built_in">Invoke-Expression</span> (</span><br><span class="line">  <span class="built_in">Invoke-WebRequest</span> https://github.com/shyiko/jabba/raw/master/install.ps1 <span class="literal">-UseBasicParsing</span></span><br><span class="line">).Content</span><br><span class="line"></span><br><span class="line"><span class="comment">## 卸载jabba</span></span><br><span class="line"><span class="comment">#jsyk: jabba keeps everything under ~/.jabba (on Linux/Mac OS X) / %USERPROFILE%/.jabba (on Windows). If at any point of time you decide to uninstall jabba - just remove this directory.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 使用jabba</span></span><br><span class="line"><span class="comment"># list available JDK&#x27;s</span></span><br><span class="line">jabba <span class="built_in">ls</span><span class="literal">-remote</span></span><br><span class="line"><span class="comment"># you can use any valid semver range to narrow down the list</span></span><br><span class="line">jabba <span class="built_in">ls</span><span class="literal">-remote</span> zulu<span class="selector-tag">@</span>~<span class="number">1.8</span>.<span class="number">60</span></span><br><span class="line">jabba <span class="built_in">ls</span><span class="literal">-remote</span> <span class="string">&quot;*@&gt;=1.6.45 &lt;1.9&quot;</span> <span class="literal">--latest</span>=minor</span><br><span class="line"></span><br><span class="line"><span class="comment"># install Oracle JDK</span></span><br><span class="line">jabba install <span class="number">1.15</span>.<span class="number">0</span></span><br><span class="line"><span class="comment"># install Oracle Server JRE</span></span><br><span class="line">jabba install sjre@<span class="number">1.8</span></span><br><span class="line"><span class="comment"># install Adopt OpenJDK (Hotspot)</span></span><br><span class="line">jabba install adopt@<span class="number">1.8</span><span class="literal">-0</span></span><br><span class="line"><span class="comment"># install Adopt OpenJDK (Eclipse OpenJ9)</span></span><br><span class="line">jabba install adopt<span class="literal">-openj9</span>@<span class="number">1.9</span><span class="literal">-0</span></span><br><span class="line"><span class="comment"># install Zulu OpenJDK</span></span><br><span class="line">jabba install zulu@<span class="number">1.8</span></span><br><span class="line">jabba install zulu<span class="selector-tag">@</span>~<span class="number">1.8</span>.<span class="number">144</span> <span class="comment"># same as &quot;zulu@&gt;=1.8.144 &lt;1.9&quot;</span></span><br><span class="line"><span class="comment"># install IBM SDK, Java Technology Edition</span></span><br><span class="line">jabba install ibm@<span class="number">1.8</span></span><br><span class="line"><span class="comment"># install GraalVM CE</span></span><br><span class="line">jabba install graalvm@<span class="number">1.0</span><span class="literal">-0</span></span><br><span class="line"><span class="comment"># install OpenJDK</span></span><br><span class="line">jabba install openjdk@<span class="number">1.10</span><span class="literal">-0</span></span><br><span class="line"><span class="comment"># install OpenJDK with Shenandoah GC</span></span><br><span class="line">jabba install openjdk<span class="literal">-shenandoah</span>@<span class="number">1.10</span><span class="literal">-0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># install from custom URL</span></span><br><span class="line"><span class="comment"># (supported qualifiers: zip (since 0.3.0), tgz, tgx (since 0.10.0), dmg, bin, exe)</span></span><br><span class="line">jabba install <span class="number">1.8</span>.<span class="number">0</span><span class="literal">-custom</span>=tgz+http://example.com/distribution.tar.gz</span><br><span class="line">jabba install <span class="number">1.8</span>.<span class="number">0</span><span class="literal">-custom</span>=tgx+http://example.com/distribution.tar.xz</span><br><span class="line">jabba install <span class="number">1.8</span>.<span class="number">0</span><span class="literal">-custom</span>=zip+file:///opt/distribution.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># uninstall JDK</span></span><br><span class="line">jabba uninstall zulu@<span class="number">1.6</span>.<span class="number">77</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># link system JDK</span></span><br><span class="line">jabba link system@<span class="number">1.8</span>.<span class="number">72</span> /Library/Java/JavaVirtualMachines/jdk1.<span class="number">8.0</span>_72.jdk</span><br><span class="line"></span><br><span class="line"><span class="comment"># list all installed JDK&#x27;s</span></span><br><span class="line">jabba <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># switch to a different version of JDK (it must be already `install`ed)</span></span><br><span class="line">jabba use adopt@<span class="number">1.8</span></span><br><span class="line">jabba use zulu<span class="selector-tag">@</span>~<span class="number">1.6</span>.<span class="number">97</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1.8&quot;</span> &gt; .jabbarc</span><br><span class="line"><span class="comment"># switch to the JDK specified in .jabbarc (since 0.5.0)</span></span><br><span class="line">jabba use</span><br><span class="line"></span><br><span class="line"><span class="comment"># set default java version on shell (since 0.2.0)</span></span><br><span class="line"><span class="comment"># this version will automatically be &quot;jabba use&quot;d every time you open up a new terminal</span></span><br><span class="line">jabba alias default <span class="number">1.8</span></span><br></pre></td></tr></table></figure></div>

<p>或者如果你想自己安装 JDK 自己管理版本，可以使用以下地址<br><a class="link"   href="https://openjdk.org/projects/jdk-updates/" >OpenJDK 下载地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><em>Oracle JDK 8 能使用版本为 jdk1.8.0_192，高版本的 JDK 将涉及商业问题，需要使用 Open JDK，但是 jre 不存在商业问题</em></p>
<p><a class="link"   href="https://repo.huaweicloud.com/java/jdk/" >OracleJDK 下载地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><em>当前 JDK 版本 1.8.0_181</em></p>
<h3 id="切换-Java-脚本"><a href="#切换-Java-脚本" class="headerlink" title="切换 Java 脚本"></a>切换 Java 脚本</h3><p>因为切换 JDK 版本只在本次<em>PowerShell</em> 打开时有效，关闭后重新打开需要再次设置 JDK 版本，<br>所以可以使用<em>PowerShell</em>脚本来快速配置 JDK 版本,<br>例如：创建一个 switch.ps1 文件，在里面配置好切换 JDK 版本的命令，然后使用快捷键或者脚本来执行这个文件，就可以快速切换 JDK 版本了</p>
<div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用jabba切换到指定的Java版本</span></span><br><span class="line">jabba <span class="built_in">ls</span></span><br><span class="line">jabba use system@<span class="number">1.8</span>.<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以在这里添加更多的命令，比如验证Java版本</span></span><br><span class="line">java <span class="literal">-version</span></span><br></pre></td></tr></table></figure></div>

<h2 id="VSCode-插件"><a href="#VSCode-插件" class="headerlink" title="VSCode 插件"></a>VSCode 插件</h2><p>vscode 需要在插件菜单搜索并安装 <a class="link"   href="https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-pack" >Extension Pack for Java <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 插件</p>
<h3 id="插件环境配置"><a href="#插件环境配置" class="headerlink" title="插件环境配置"></a>插件环境配置</h3><p>当使用插件来管理 Java 项目时，需要使用插件自己的配置来指定项目的运行环境和编译环境，步骤如下：</p>
<ol>
<li>在 VSCode 中随便点击一个 java 源码文件，左侧栏下方会出现一个 JAVA PROJECTS，里面就是当前项目</li>
<li>右键点击当前项目的名称，然后选择“ClassPath”打开配置页面</li>
<li>在配置页面中，看到 Classpath -&gt; JDK Runtime 就是配置 Java 项目运行环境的地方</li>
<li>在配置页面中，看到 Compiler 就是配置 Java 项目编译环境的地方</li>
</ol>
<p>如下图所示：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1723184856021_63d4a08051c0977da127d5ee1edb5a6e.png"
                     
                ></p>
<h1 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h1><p>一个简单的小项目，这个项目解决了 Java 环境搭建问题、包（package）命名问题、UI 界面问题、jar 打包问题</p>
<h2 id="目录结构及代码"><a href="#目录结构及代码" class="headerlink" title="目录结构及代码"></a>目录结构及代码</h2><ul>
<li>testJava<ul>
<li>demo<ul>
<li>Index.java</li>
<li>Demo.java</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Index.java</span></span><br><span class="line"><span class="keyword">package</span> demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Index</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Demo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Demo.java</span></span><br><span class="line"><span class="keyword">package</span> demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> <span class="keyword">extends</span> <span class="title class_">JFrame</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Demo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">lookAndFeel</span> <span class="operator">=</span> UIManager.getCrossPlatformLookAndFeelClassName();</span><br><span class="line">            UIManager.setLookAndFeel(lookAndFeel);</span><br><span class="line">        &#125; <span class="keyword">catch</span>(Exception exc) &#123;&#125;</span><br><span class="line">        setPreferredSize(<span class="keyword">new</span> <span class="title class_">Dimension</span>(<span class="number">600</span>, <span class="number">400</span>));</span><br><span class="line">        pack();</span><br><span class="line">        setDefaultCloseOperation(EXIT_ON_CLOSE);</span><br><span class="line">        setTitle(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">        setVisible(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="打包及运行"><a href="#打包及运行" class="headerlink" title="打包及运行"></a>打包及运行</h2><p>使用插件打包，可以使用左侧下方的 JAVA PROJECTS 功能，点击当前项目名右侧的一个“→”符号即可将项目打包为 jar，如下图所示：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1723187323234_5460f2b7d37dfccf928b7391241629c8.png"
                     
                ></p>
<p>然后使用以下命令运行 jar</p>
<div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line">java <span class="literal">-jar</span> xxxxx.jar</span><br></pre></td></tr></table></figure></div>

<h2 id="已知问题"><a href="#已知问题" class="headerlink" title="已知问题"></a>已知问题</h2><p><strong>如果出现 package 报错，可能是未将项目添加到 classpath 中，可以尝试以下解决方案。</strong></p>
<h3 id="插件配置-VSCode"><a href="#插件配置-VSCode" class="headerlink" title="插件配置 VSCode"></a>插件配置 VSCode</h3><p>参考<a href="/2023/06/08/%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8BJava%E7%9A%84%E5%9F%BA%E7%A1%80%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B/#%E6%8F%92%E4%BB%B6%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">插件环境配置</a>,<br>并配置 Classpath -&gt; Sources 页面即可。</p>
<h3 id="手动配置-VSCode"><a href="#手动配置-VSCode" class="headerlink" title="手动配置 VSCode"></a>手动配置 VSCode</h3><p>vscode 当前项目目录配置项，需要在根目录建立.vscode&#x2F;settings.json 文件后写入下面的配置项。<br>主要是为了解决包路径和项目路径不匹配问题</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;java.project.sourcePaths&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;yourJavaProjectPath&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025379_8589081e28d9f2e6e127324815e78d14.png"
                     
                ></p>
<h1 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h1><p>Maven 是 Java 的包管理器或者项目管理器，<br>通常情况下，一个项目不会使用刚才的<a href="#Hello-World">Hello World 章节</a>来创建和编写，而是都会使用 Maven 来管理，Maven 帮我们简化了各种繁琐的工作，比如引入依赖文件，创建项目目录等。</p>
<h2 id="下载-Maven"><a href="#下载-Maven" class="headerlink" title="下载 Maven"></a>下载 Maven</h2><p><a class="link"   href="https://maven.apache.org/download.cgi" >下载 maven <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025379_b9e0cc80bf2dbe610c3c3f6d9173ef9b.png"
                     
                ></p>
<h2 id="配置-Maven"><a href="#配置-Maven" class="headerlink" title="配置 Maven"></a>配置 Maven</h2><h3 id="添加-Maven-到系统环境"><a href="#添加-Maven-到系统环境" class="headerlink" title="添加 Maven 到系统环境"></a>添加 Maven 到系统环境</h3><p>将下载好的压缩包直接解压到事先准备好的空文件夹（注意路径不要有中文、特殊字符等），然后将该路径下的 bin 目录添加到系统变量即可。</p>
<h3 id="配置-settings-xml"><a href="#配置-settings-xml" class="headerlink" title="配置 settings.xml"></a>配置 settings.xml</h3><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 本地仓库路径 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- localRepository</span></span><br><span class="line"><span class="comment">   | The path to the local repository maven will use to store artifacts.</span></span><br><span class="line"><span class="comment">   |</span></span><br><span class="line"><span class="comment">   | Default: $&#123;user.home&#125;/.m2/repository</span></span><br><span class="line"><span class="comment">  &lt;localRepository&gt;/path/to/local/repo&lt;/localRepository&gt;</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>D:/yourRepository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 镜像网址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- mirror</span></span><br><span class="line"><span class="comment">     | Specifies a repository mirror site to use instead of a given repository. The repository that</span></span><br><span class="line"><span class="comment">     | this mirror serves has an ID that matches the mirrorOf element of this mirror. IDs are used</span></span><br><span class="line"><span class="comment">     | for inheritance and direct lookup purposes, and must be unique across the set of mirrors.</span></span><br><span class="line"><span class="comment">     |</span></span><br><span class="line"><span class="comment">    &lt;mirror&gt;</span></span><br><span class="line"><span class="comment">      &lt;id&gt;mirrorId&lt;/id&gt;</span></span><br><span class="line"><span class="comment">      &lt;mirrorOf&gt;repositoryId&lt;/mirrorOf&gt;</span></span><br><span class="line"><span class="comment">      &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;</span></span><br><span class="line"><span class="comment">      &lt;url&gt;http://my.repository.com/repo/path&lt;/url&gt;</span></span><br><span class="line"><span class="comment">    &lt;/mirror&gt;</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/central<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven2<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>uk<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Human Readable Name for this Mirror.<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://uk.maven.org/maven2/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>CN<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>OSChina Central<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.oschina.net/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>internal nexus repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;url&gt;http://192.168.1.100:8081/nexus/content/groups/public/&lt;/url&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://repo.maven.apache.org/maven2<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="配置-vscode"><a href="#配置-vscode" class="headerlink" title="配置 vscode"></a>配置 vscode</h3><p>vscode 全局配置项</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;java.configuration.maven.globalSettings&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\yourMavenGlobalSettings\\settings.xml&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;java.configuration.maven.userSettings&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\yourMavenGlobalSettings\\settings.xml&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;maven.executable.path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\yourMavenBin\\mvn&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="使用-Maven"><a href="#使用-Maven" class="headerlink" title="使用 Maven"></a>使用 Maven</h2><h3 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h3><p>pom.xml 是 Maven 项目特有的核心配置文件。它是 Maven Project Object Model (POM) 的 XML 表示，用于定义项目的构建、依赖、插件等信息。<br>下面是一个基础的 pom.xml 配置文件</p>
<div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Maven项目的根元素，包含了POM的所有配置信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 指定POM模型的版本，对于Maven 2和Maven 3来说，它总是4.0.0 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的groupId，通常用于唯一标识项目的所属组织 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的artifactId，通常用于唯一标识项目的名称 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的版本号，用于标识项目的特定版本 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的打包方式，如jar、war等 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的名称，通常用于显示或引用项目时使用 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>My Project<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的描述，用于说明项目的用途、功能等 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>My Project<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 项目的一些属性配置，如Java版本等 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>11<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 需要添加该插件，来保证jar中写入了主清单（主类）属性 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-jar-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">archive</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">manifest</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">addClasspath</span>&gt;</span>true<span class="tag">&lt;/<span class="name">addClasspath</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>com.example.demo.你的主类名<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">archive</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="mvn-命令"><a href="#mvn-命令" class="headerlink" title="mvn 命令"></a>mvn 命令</h3><p>mvn 是 Maven 的命令行工具</p>
<div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 打包项目，这个命令会打包你的项目，生成一个JAR文件（如果你的pom.xml中的packaging设置是jar），这个JAR文件会放在target目录下。</span></span><br><span class="line">mvn package</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译项目，这个命令会编译你的项目源代码，并将编译后的文件放在target/classes目录下。</span></span><br><span class="line">mvn compile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清理项目，这个命令会删除target目录（如果存在的话），这个目录通常包含了构建过程中生成的文件，如编译后的类文件、测试报告等。</span></span><br><span class="line">mvn clean</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试项目，这个命令会编译你的测试代码，并执行测试。测试报告和结果会放在target/surefire-reports目录下。</span></span><br><span class="line">mvn test</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装项目，这个命令会执行package命令，并将生成的JAR文件安装到你的本地Maven仓库中，以便其他项目可以引用它。</span></span><br><span class="line">mvn install</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>打包也可以使用 GUI 提供的工具，如下图所示</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025383_3fb3aea6df32eda6c03786711abdf0b3.png"
                     
                ></p>
<h3 id="手动创建-Maven-新项目"><a href="#手动创建-Maven-新项目" class="headerlink" title="手动创建 Maven 新项目"></a>手动创建 Maven 新项目</h3><ol>
<li>需要创建一个新的目录作为新项目的根目录，然后创建一个 pom.xml，其内容可以参考<a href="#pom-xml">pom.xml</a>。</li>
<li>创建子目录，如下，仅 <strong>Java 源代码目录</strong>是必须的，其他目录根据需要选择<br>|– pom.xml<br>|– src<br>| |– main<br>| | |– <strong>java # Java 源代码目录</strong><br>| | |– resources # 项目主资源文件目录（如配置文件）<br>| | |– scripts # 脚本文件目录（可选）<br>| | |– webapp # Web 应用的目录（Web 项目特有，包含 JSP、HTML 等）<br>| | |– … # 其他主目录（可选）<br>| |– test<br>| |– java # Java 测试源代码目录<br>| |– resources # 测试资源文件目录（如测试配置文件）<br>| |– … # 其他测试目录（可选）<br>|– target # Maven 构建生成的目录（包含编译后的类文件、jar 包等）<br>|– LICENSE.txt # 项目许可证文件（可选）<br>|– NOTICE.txt # 项目通知文件（可选）<br>|– README.txt # 项目说明文件（可选）<br>|– .mvn # Maven wrapper 的目录（可选，用于确保跨环境 Maven 版本一致性）<br>| |– wrapper # Maven wrapper 的 jar 和脚本<br>| |– maven-wrapper.jar<br>| |– maven-wrapper.properties<br>|– .gitignore # Git 忽略文件（可选）</li>
<li>编写代码</li>
<li>打包，参考<a href="#mvn-%E5%91%BD%E4%BB%A4">mvn 命令</a></li>
<li>运行，使用 <em>java -jar JARPATH</em> 来执行 jar 文件</li>
</ol>
<h3 id="基于-Maven-原型创建新项目"><a href="#基于-Maven-原型创建新项目" class="headerlink" title="基于 Maven 原型创建新项目"></a>基于 Maven 原型创建新项目</h3><p>使用 <strong><em>Ctrl+Shift+P</em></strong> 打开 VSCode 的命令，或者使用 GUI 中的 <strong><em>从 Maven 原型创建新项目</em></strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025380_0d8c22890e27ce26494b29946c6c3c37.png"
                     
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025380_ef0dce28a5bb5c17727b0a31c00cfd85.png"
                     
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025380_e8e5a97f268aab7feae9f335a894209d.png"
                     
                ></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://blog.csdn.net/zz00008888/article/details/135476334" >Java 的 JDK 多版本管理与常用命令（JEnv、SDKMAN、Jabba） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>VSCode</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>给Hexo的redefine主题添加自己的脚本</title>
    <url>/2024/02/28/%E7%BB%99Hexo%E7%9A%84redefine%E4%B8%BB%E9%A2%98%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E8%84%9A%E6%9C%AC/</url>
    <content><![CDATA[<p><a class="link"   href="https://hexo.io/zh-cn/api/" >Hexo API 参考 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>要注意，当使用了主题后，需要到主题的目录中去添加脚本，而不是在根目录中添加脚本</p>
<span id="more"></span>

<p>这里只记录 redefine 主题这个特例，其他主题可能不同，需要自己去寻找，本文章仅作参考。<br>修改主题文件前建议先备份，避免出错后无法恢复。</p>
<h2 id="第一步-创建脚本文件"><a href="#第一步-创建脚本文件" class="headerlink" title="第一步 创建脚本文件"></a>第一步 创建脚本文件</h2><p>在 <strong>themes&#x2F;redefine&#x2F;source&#x2F;js</strong> 目录下创建自己的脚本文件，例如<code>helloWorld.js</code></p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// helloWorld.js</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&#x27;Hello World!&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<h2 id="第二步-引入脚本文件"><a href="#第二步-引入脚本文件" class="headerlink" title="第二步 引入脚本文件"></a>第二步 引入脚本文件</h2><p>找到文件 <strong>themes&#x2F;redefine&#x2F;layout&#x2F;_partials&#x2F;scripts.ejs</strong><br>在该文件最后添加如下内容，即引入自己的脚本文件</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;%- renderJS(&#x27;js/helloWorld.js&#x27;) %&gt;</span><br></pre></td></tr></table></figure></div>

<p>然后就可以在浏览器中查看效果了</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>编译C++的ICU库</title>
    <url>/2024/11/05/%E7%BC%96%E8%AF%91C-%E7%9A%84ICU%E5%BA%93/</url>
    <content><![CDATA[<p>作为一个前端开发，平时很少接触 C&#x2F;C++，这是我第一次成功编译 C++ 的第三方库 ICU，特地记录一下。</p>
<p><strong>该篇文章仅适用于 Ubuntu 系统</strong>，如果要在 Windows 系统下编译，可以参考<a href="/2024/12/11/c-%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8conan%E7%9A%84%E4%BD%BF%E7%94%A8/">c++包管理器 conan 的使用</a></p>
<span id="more"></span>

<h1 id="前置条件"><a href="#前置条件" class="headerlink" title="前置条件"></a>前置条件</h1><p>合适的编译环境，如 Ubuntu ，之前一直都在 Windows 系统下开发和编译 C&#x2F;C++，吃了很多编译环境的亏。</p>
<h1 id="下载-ICU-源码"><a href="#下载-ICU-源码" class="headerlink" title="下载 ICU 源码"></a>下载 ICU 源码</h1><p><a class="link"   href="https://github.com/unicode-org/icu" >ICU github <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://github.com/unicode-org/icu/releases" >ICU release <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>可以直接在 github 上 clone 源码，也可以直接下载 release 源码压缩包。<br><em>此处使用的是 ICU 76.1 版本，如果需要指定版本，请使用 release 下载源码压缩包。</em></p>
<h1 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h1><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装Mingw64</span></span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install mingw-w64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入源码目录</span></span><br><span class="line"><span class="built_in">cd</span> /icu4c/source</span><br><span class="line"></span><br><span class="line"><span class="comment"># /icu4c/source 目录下有一个 runConfigureICU 脚本，用来指定编译环境</span></span><br><span class="line"><span class="comment"># CC=gcc 表示使用 gcc 编译器来编译C源码</span></span><br><span class="line"><span class="comment"># CXX=g++ 表示使用 g++ 编译器来编译C++源码</span></span><br><span class="line"><span class="comment"># CFLAGS=-I/mingw64/include 表示指定头文件路径</span></span><br><span class="line"><span class="comment"># CXXFLAGS=-I/mingw64/include 表示指定头文件路径</span></span><br><span class="line"><span class="comment"># LDFLAGS=-L/mingw64/lib</span></span><br><span class="line"><span class="comment"># --enable-debug 表示启用调试模式</span></span><br><span class="line"><span class="comment"># MinGW 表示编译目标为 Windows</span></span><br><span class="line"><span class="comment"># --prefix=/icu4c/build 表示指定编译输出路径，make install 目录</span></span><br><span class="line">CC=gcc CXX=g++ CFLAGS=-I/mingw64/include  CXXFLAGS=-I/mingw64/include LDFLAGS=-L/mingw64/lib ./runConfigureICU --enable-debug MinGW --prefix=/icu4c/build</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译</span></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line"><span class="comment"># 会安装到 --prefix 标记的目录下</span></span><br><span class="line">make install</span><br></pre></td></tr></table></figure></div>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://blog.csdn.net/m0_75022297/article/details/143260356" >Windows 10 + MSYS2 + Mingw64 编译 ICU(International Components for Unicode)库 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a href="/2024/12/11/c-%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8conan%E7%9A%84%E4%BD%BF%E7%94%A8/">c++包管理器 conan 的使用</a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>Ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title>网页爬虫检测办法</title>
    <url>/2025/09/24/%E7%BD%91%E9%A1%B5%E7%88%AC%E8%99%AB%E6%A3%80%E6%B5%8B%E5%8A%9E%E6%B3%95/</url>
    <content><![CDATA[<p>核心逻辑如下：</p>
<blockquote>
<p>在服务器返回的页面中插入一段只有浏览器才能执行的代码，如果是正常浏览器请求，那么这段代码就会被执行，如果是爬虫获取到的该页面，那么这个爬虫大概率不会执行这段代码</p>
</blockquote>
<p>有了这个思路，然后再结合后端数据库的存储，就可以实现一个爬虫检测的逻辑了</p>
<h1 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h1><p>首先得有一个记录访问的表，暂且叫 visit 表，表里面应该有两个字段</p>
<ul>
<li>executed：表示该页面是否被执行过爬虫检查代码，1 表示被执行过，0（默认）表示没有被执行过</li>
<li>normal：表示请求是否正常，1 表示正常，0（默认）表示爬虫</li>
</ul>
<h1 id="前端判断逻辑"><a href="#前端判断逻辑" class="headerlink" title="前端判断逻辑"></a>前端判断逻辑</h1><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 隐藏的陷阱元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;position: absolute; left: -9999px; top: -9999px;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/&quot;</span> <span class="attr">id</span>=<span class="string">&quot;t-l&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color: transparent; font-size: 0;&quot;</span>&gt;</span>t-l<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;t-f&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;trap&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">class</span> <span class="title class_">BrowserValidator</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 存储检测结果</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">results</span> = &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">basicEnv</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">advancedAPIs</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">behaviorPattern</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">fingerprintConsistency</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">trapAvoidance</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 设置陷阱</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">setupTraps</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 基础环境检测</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">checkBasicEnvironment</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> requiredObjects = [</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;window&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;document&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;navigator&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;screen&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;history&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;location&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        ];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> exists = requiredObjects.<span class="title function_">every</span>(<span class="function">(<span class="params">obj</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> <span class="built_in">eval</span>(<span class="string">`typeof <span class="subst">$&#123;obj&#125;</span> !== &#x27;undefined&#x27;`</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125; <span class="keyword">catch</span> (e) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">results</span>.<span class="property">basicEnv</span> = exists;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> exists;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 高级API检测</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">checkAdvancedAPIs</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> apis = [</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;WebGLRenderingContext&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;AudioContext&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;BatteryManager&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;RTCPeerConnection&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;PushManager&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        ];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> detectedCount = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检测WebGL</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> canvas = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;canvas&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> gl =</span></span><br><span class="line"><span class="language-javascript">            canvas.<span class="title function_">getContext</span>(<span class="string">&quot;webgl&quot;</span>) ||</span></span><br><span class="line"><span class="language-javascript">            canvas.<span class="title function_">getContext</span>(<span class="string">&quot;experimental-webgl&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (gl) detectedCount++;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检测AudioContext</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">AudioContext</span> || <span class="variable language_">window</span>.<span class="property">webkitAudioContext</span>) detectedCount++;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检测Battery API</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="string">&quot;getBattery&quot;</span> <span class="keyword">in</span> navigator) detectedCount++;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检测WebRTC</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">RTCPeerConnection</span>) detectedCount++;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检测Push API</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="string">&quot;PushManager&quot;</span> <span class="keyword">in</span> <span class="variable language_">window</span>) detectedCount++;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">results</span>.<span class="property">advancedAPIs</span> = detectedCount &gt;= <span class="number">3</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> detectedCount &gt;= <span class="number">3</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 行为模式检测</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">checkBehaviorPattern</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> mouseMoveDetected = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> clickDetected = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> <span class="title function_">onMouseMove</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">            mouseMoveDetected = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, onMouseMove);</span></span><br><span class="line"><span class="language-javascript">          &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> <span class="title function_">onClick</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">            clickDetected = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;click&quot;</span>, onClick);</span></span><br><span class="line"><span class="language-javascript">          &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, onMouseMove);</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, onClick);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 等待用户交互</span></span></span><br><span class="line"><span class="language-javascript">          <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">results</span>.<span class="property">behaviorPattern</span> = mouseMoveDetected || clickDetected;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">resolve</span>(<span class="variable language_">this</span>.<span class="property">results</span>.<span class="property">behaviorPattern</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;, <span class="number">2000</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 指纹一致性检测</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">checkFingerprintConsistency</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// Canvas指纹检测</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> canvas = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;canvas&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          canvas.<span class="property">width</span> = <span class="number">200</span>;</span></span><br><span class="line"><span class="language-javascript">          canvas.<span class="property">height</span> = <span class="number">40</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> ctx = canvas.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 绘制文本</span></span></span><br><span class="line"><span class="language-javascript">          ctx.<span class="property">textBaseline</span> = <span class="string">&quot;top&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">          ctx.<span class="property">font</span> = <span class="string">&quot;14px Arial&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">          ctx.<span class="property">fillStyle</span> = <span class="string">&quot;#f60&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">          ctx.<span class="title function_">fillRect</span>(<span class="number">0</span>, <span class="number">0</span>, canvas.<span class="property">width</span>, canvas.<span class="property">height</span>);</span></span><br><span class="line"><span class="language-javascript">          ctx.<span class="property">fillStyle</span> = <span class="string">&quot;#069&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">          ctx.<span class="title function_">fillText</span>(<span class="string">&quot;Browser Validator&quot;</span>, <span class="number">5</span>, <span class="number">5</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 获取图像数据</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> dataUrl = canvas.<span class="title function_">toDataURL</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 简单验证数据是否正常（真实浏览器会产生唯一指纹）</span></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">results</span>.<span class="property">fingerprintConsistency</span> = dataUrl.<span class="property">length</span> &gt; <span class="number">1000</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">results</span>.<span class="property">fingerprintConsistency</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">catch</span> (e) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">results</span>.<span class="property">fingerprintConsistency</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 设置陷阱</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">setupTraps</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 标记陷阱是否被触发</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">trapTriggered</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 监听隐藏链接的点击</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;t-l&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">trapTriggered</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 监听表单提交</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;t-f&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;submit&quot;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">trapTriggered</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 陷阱检测</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">checkTrapAvoidance</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">results</span>.<span class="property">trapAvoidance</span> = !<span class="variable language_">this</span>.<span class="property">trapTriggered</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">results</span>.<span class="property">trapAvoidance</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 综合检测</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">async</span> <span class="title function_">validate</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 执行同步检测</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">checkBasicEnvironment</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">checkAdvancedAPIs</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">checkFingerprintConsistency</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">checkTrapAvoidance</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 执行异步检测</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">checkBehaviorPattern</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 计算综合结果</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> passedTests = <span class="title class_">Object</span>.<span class="title function_">values</span>(<span class="variable language_">this</span>.<span class="property">results</span>).<span class="title function_">filter</span>(<span class="title class_">Boolean</span>).<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> totalTests = <span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="variable language_">this</span>.<span class="property">results</span>).<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">isBrowser</span>: passedTests &gt;= <span class="number">4</span>, <span class="comment">// 通过4项及以上测试</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">score</span>: <span class="string">`<span class="subst">$&#123;passedTests&#125;</span>/<span class="subst">$&#123;totalTests&#125;</span>`</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">details</span>: <span class="variable language_">this</span>.<span class="property">results</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 页面加载完成后执行检测</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> validator = <span class="keyword">new</span> <span class="title class_">BrowserValidator</span>();</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> result = <span class="keyword">await</span> validator.<span class="title function_">validate</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 这里将爬虫判断结果通过verifySpider函数返回给后端，关键是将isBrowser的赋给visit表的normal字段</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (verifySpider <span class="keyword">instanceof</span> <span class="title class_">Function</span>) <span class="title function_">verifySpider</span>(result);</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;)();</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>如果为了避免被爬虫发现这段脚本，可以压缩丑化掉这段代码，具体压缩工具可以自行选择，这里推荐使用 <a class="link"   href="https://t.xx-xx.top/htmlCompress.html" >HTML&#x2F;JS 兼容性转换与压缩工具 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>记录一个Three.js项目</title>
    <url>/2023/06/06/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AAThree-js%E9%A1%B9%E7%9B%AE/</url>
    <content><![CDATA[<p>记录一下公司的 Three.js 项目，感觉很经典</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025382_53bd1b45d4fa8b3292cdcaf4bb3c7961.gif"
                     
                >  </p>
<span id="more"></span>
<p><a class="link"   href="https://github.com/GJYyyyy/ThreeDemo" >完整项目地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://gjyyyyy.github.io/ThreeDemo/" >预览地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>  </p>
<h1 id="目录概览"><a href="#目录概览" class="headerlink" title="目录概览"></a>目录概览</h1><p>以下加粗字体为核心文件</p>
<ul>
<li>public<ul>
<li><strong>index.html</strong></li>
<li>city.gltf</li>
<li>video_point.png</li>
</ul>
</li>
<li>src<ul>
<li><strong>index.js</strong></li>
</ul>
</li>
<li>package.json</li>
<li>webpack.config.js</li>
<li>webpack.dev.config.js</li>
<li>webpack.pro.config.js</li>
</ul>
<h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><p>简单介绍一下项目依赖和脚本</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;threejsapp&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack-dev-server --config ./webpack.dev.config.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack --config ./webpack.pro.config.js&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;babel-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^9.1.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;clean-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;copy-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^11.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;html-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.5.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;webpack&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.85.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;webpack-cli&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.1.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;webpack-dev-server&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.15.0&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;three&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^0.153.0&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">CleanWebpackPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;clean-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CopyWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;copy-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="comment">// target: &#x27;node&#x27;, // 如果需要打包后运行在nodejs环境下，需要设置此值</span></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">CleanWebpackPlugin</span>(), <span class="comment">// 先删除打包目标目录再打包,</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&#x27;./public/index.html&#x27;</span> <span class="comment">// 配置模板index.html文件</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">CopyWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">patterns</span>: [</span><br><span class="line">                &#123; <span class="attr">from</span>: <span class="string">&#x27;./public/city.gltf&#x27;</span> &#125;, <span class="comment">// 把文件（CNAME等）移动到打包目录</span></span><br><span class="line">                &#123; <span class="attr">from</span>: <span class="string">&#x27;./public/video_point.png&#x27;</span> &#125; <span class="comment">// 把文件（CNAME等）移动到打包目录</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<h2 id="webpack-dev-config-js"><a href="#webpack-dev-config-js" class="headerlink" title="webpack.dev.config.js"></a>webpack.dev.config.js</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.dev.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.config&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(baseConfig, &#123;</span><br><span class="line">    <span class="comment">// 开发模式配置</span></span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">    <span class="attr">devtool</span>: <span class="string">&#x27;source-map&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span>,</span><br><span class="line">        <span class="attr">publicPath</span>: <span class="string">&#x27;/&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">devServer</span>: &#123;</span><br><span class="line">        <span class="attr">static</span>: &#123;</span><br><span class="line">            <span class="attr">directory</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;dist&#x27;</span>) <span class="comment">// 开发服务器根目录</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">compress</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">port</span>: <span class="number">8888</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h2 id="webpack-pro-config-js"><a href="#webpack-pro-config-js" class="headerlink" title="webpack.pro.config.js"></a>webpack.pro.config.js</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.pro.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.config&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(baseConfig, &#123;</span><br><span class="line">    <span class="comment">// 生产模式配置</span></span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;docs&#x27;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;scripts/bundle.js&#x27;</span>,</span><br><span class="line">        <span class="attr">publicPath</span>: <span class="string">&#x27;./&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h2 id="x2F-public-x2F-index-html"><a href="#x2F-public-x2F-index-html" class="headerlink" title="&#x2F;public&#x2F;index.html"></a>&#x2F;public&#x2F;index.html</h2><p>源码</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>记录一个Three.js项目<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100vw</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#container</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">60%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">60%</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="x2F-src-x2F-index-js"><a href="#x2F-src-x2F-index-js" class="headerlink" title="&#x2F;src&#x2F;index.js"></a>&#x2F;src&#x2F;index.js</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">Three</span> <span class="keyword">from</span> <span class="string">&#x27;three&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">GLTFLoader</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;three/examples/jsm/loaders/GLTFLoader&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ColladaLoader</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;three/examples/jsm/loaders/ColladaLoader&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">OrbitControls</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;three/examples/jsm/controls/OrbitControls&#x27;</span>;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> threeContainer;</span><br><span class="line">    <span class="keyword">let</span> scene;</span><br><span class="line">    <span class="keyword">let</span> camera;</span><br><span class="line">    <span class="keyword">let</span> renderer;</span><br><span class="line">    <span class="keyword">let</span> controls;</span><br><span class="line">    <span class="keyword">let</span> raycaster;</span><br><span class="line">    <span class="keyword">let</span> pointer;</span><br><span class="line">    <span class="keyword">let</span> model; <span class="comment">// 要展示的模型</span></span><br><span class="line">    <span class="keyword">let</span> modelUnits = [];</span><br><span class="line">    <span class="keyword">let</span> selectedModel;</span><br><span class="line">    <span class="keyword">let</span> spriteGroup; <span class="comment">// 监控点位,</span></span><br><span class="line">    <span class="keyword">let</span> isMouseOnCanvas = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">init</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 总初始化</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">        threeContainer = <span class="title function_">initContainer</span>();</span><br><span class="line">        scene = <span class="title function_">initScene</span>();</span><br><span class="line">        camera = <span class="title function_">initCamera</span>();</span><br><span class="line">        raycaster = <span class="title function_">initRaycaster</span>();</span><br><span class="line">        renderer = <span class="title function_">initRenderer</span>(<span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">        controls = <span class="title function_">initControls</span>();</span><br><span class="line">        model = <span class="keyword">await</span> <span class="title function_">initModel</span>(<span class="string">&#x27;./city.gltf&#x27;</span>); </span><br><span class="line">        scene.<span class="title function_">add</span>(model);</span><br><span class="line">        spriteGroup = <span class="title function_">initMonitor</span>(<span class="string">&#x27;./video_point.png&#x27;</span>); </span><br><span class="line">        <span class="title function_">initEvent</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化画布容器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns</span> &#123;<span class="type">HTMLElement</span>&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initContainer</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;container&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化threejs场景</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns</span> &#123;<span class="type">Three.Scene</span>&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initScene</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> scene = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">Scene</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置光源</span></span><br><span class="line">        <span class="keyword">const</span> directionalLight = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">DirectionalLight</span>(<span class="number">0xffffff</span>, <span class="number">1</span>);</span><br><span class="line">        directionalLight.<span class="property">position</span>.<span class="title function_">set</span>(<span class="number">3000</span>, <span class="number">5000</span>, -<span class="number">3000</span>);</span><br><span class="line">        <span class="comment">// 设置阴影</span></span><br><span class="line">        directionalLight.<span class="property">castShadow</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// 设置光源阴影相机</span></span><br><span class="line">        <span class="keyword">const</span> distance = <span class="number">900</span>;</span><br><span class="line">        directionalLight.<span class="property">shadow</span>.<span class="property">camera</span>.<span class="property">left</span> = -distance;</span><br><span class="line">        directionalLight.<span class="property">shadow</span>.<span class="property">camera</span>.<span class="property">right</span> = distance;</span><br><span class="line">        directionalLight.<span class="property">shadow</span>.<span class="property">camera</span>.<span class="property">top</span> = distance;</span><br><span class="line">        directionalLight.<span class="property">shadow</span>.<span class="property">camera</span>.<span class="property">bottom</span> = -distance;</span><br><span class="line">        directionalLight.<span class="property">shadow</span>.<span class="property">camera</span>.<span class="property">far</span> = <span class="number">20000</span>;</span><br><span class="line">        directionalLight.<span class="property">shadow</span>.<span class="property">camera</span>.<span class="property">near</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        directionalLight.<span class="property">target</span>.<span class="property">position</span>.<span class="title function_">set</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        scene.<span class="title function_">add</span>(directionalLight.<span class="property">target</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 光源辅助线</span></span><br><span class="line">        <span class="comment">// const helper = new Three.DirectionalLightHelper(directionalLight);</span></span><br><span class="line">        <span class="comment">// scene.add(helper);</span></span><br><span class="line"></span><br><span class="line">        scene.<span class="title function_">add</span>(directionalLight);</span><br><span class="line">        <span class="keyword">const</span> ambient = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">AmbientLight</span>(<span class="number">0xffffff</span>, <span class="number">0.7</span>);</span><br><span class="line">        scene.<span class="title function_">add</span>(ambient);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> scene;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化threejs相机</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns</span> &#123;<span class="type">Three.Camera</span>&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initCamera</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> camera = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">PerspectiveCamera</span>(<span class="number">20</span>, threeContainer.<span class="property">clientWidth</span> / threeContainer.<span class="property">clientHeight</span>, <span class="number">1</span>, <span class="number">20000</span>);</span><br><span class="line">        camera.<span class="property">position</span>.<span class="title function_">set</span>(<span class="number">0</span>, <span class="number">1700</span>, <span class="number">2000</span>);</span><br><span class="line">        camera.<span class="title function_">lookAt</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> camera;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化threejs的事件射线检测器，</span></span><br><span class="line"><span class="comment">     * threejs的各种事件实现的基本前提</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns</span> &#123;<span class="type">Three.Raycaster</span>&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initRaycaster</span>(<span class="params"></span>) &#123;</span><br><span class="line">        pointer = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">Vector2</span>();</span><br><span class="line">        <span class="keyword">let</span> raycaster = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">Raycaster</span>();</span><br><span class="line">        <span class="keyword">return</span> raycaster;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化threejs渲染器，</span></span><br><span class="line"><span class="comment">     * 这里需要递归调用requestAnimationFrame来递归渲染3D模型,</span></span><br><span class="line"><span class="comment">     * 模型能不能动主要是在这个函数里面实现</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Boolean</span>&#125; openEvent 是否开启事件功能</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Boolean</span>&#125; openRotate 是否开启模型自旋转</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns</span> &#123;<span class="type">Three.Renderer</span>&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initRenderer</span>(<span class="params">openEvent = <span class="literal">false</span>, openRotate = <span class="literal">false</span></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> renderer = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">WebGLRenderer</span>(&#123; <span class="attr">alpha</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">        renderer.<span class="title function_">setSize</span>(threeContainer.<span class="property">clientWidth</span>, threeContainer.<span class="property">clientHeight</span>);</span><br><span class="line">        renderer.<span class="title function_">setClearColor</span>(<span class="number">0xffffff</span>, <span class="number">0</span>);</span><br><span class="line">        renderer.<span class="property">outputColorSpace</span> = <span class="title class_">Three</span>.<span class="property">SRGBColorSpace</span>;</span><br><span class="line">        <span class="comment">//阴影</span></span><br><span class="line">        renderer.<span class="property">shadowMap</span>.<span class="property">enabled</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// renderer.shadowMap.type = Three.PCFSoftShadowMap;</span></span><br><span class="line"></span><br><span class="line">        threeContainer.<span class="title function_">appendChild</span>(renderer.<span class="property">domElement</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">render</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (openEvent) &#123;</span><br><span class="line">                <span class="comment">// 事件射线位置更新</span></span><br><span class="line">                raycaster.<span class="title function_">setFromCamera</span>(pointer, camera);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (openRotate) &#123;</span><br><span class="line">                <span class="comment">// 模型旋转角度更新</span></span><br><span class="line">                <span class="keyword">if</span> (</span><br><span class="line">                    model</span><br><span class="line">                    &amp;&amp; spriteGroup</span><br><span class="line">                    &amp;&amp; !isMouseOnCanvas</span><br><span class="line">                ) &#123;</span><br><span class="line">                    <span class="keyword">let</span> unit = <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">3000</span>;</span><br><span class="line">                    model.<span class="property">rotation</span>.<span class="property">y</span> -= unit;</span><br><span class="line">                    spriteGroup.<span class="property">rotation</span>.<span class="property">y</span> -= unit;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(model.<span class="property">rotation</span>.<span class="property">y</span>) &gt;= <span class="number">2</span> * <span class="title class_">Math</span>.<span class="property">PI</span>) &#123;<span class="comment">// 如果旋转角度绝对值大于等于两个Math.PI(即旋转360度)，将y归零，防止内存溢出</span></span><br><span class="line">                        model.<span class="property">rotation</span>.<span class="property">y</span> = <span class="number">0</span>;</span><br><span class="line">                        spriteGroup.<span class="property">rotation</span>.<span class="property">y</span> = <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            renderer.<span class="title function_">render</span>(scene, camera);</span><br><span class="line">            <span class="title function_">requestAnimationFrame</span>(render);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">render</span>();</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">onresize</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            renderer.<span class="title function_">setSize</span>(threeContainer.<span class="property">clientWidth</span>, threeContainer.<span class="property">clientHeight</span>);</span><br><span class="line">            camera.<span class="property">aspect</span> = threeContainer.<span class="property">clientWidth</span> / threeContainer.<span class="property">clientHeight</span>;</span><br><span class="line">            camera.<span class="title function_">updateProjectionMatrix</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> renderer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化threejs控制器，</span></span><br><span class="line"><span class="comment">     * 该控制器主要限制相机的运动轨迹，</span></span><br><span class="line"><span class="comment">     * 非threejs的核心类</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns</span> &#123;<span class="type">OrbitControls</span>&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initControls</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> controls = <span class="keyword">new</span> <span class="title class_">OrbitControls</span>(camera, renderer.<span class="property">domElement</span>);</span><br><span class="line">        <span class="keyword">return</span> controls;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化threejs模型文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; modelPath 模型文件地址</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns</span> &#123;<span class="type">Promise&lt;Three.Scene&gt;</span>&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initModel</span>(<span class="params">modelPath</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> loader;</span><br><span class="line">        <span class="keyword">if</span> (<span class="regexp">/\.(glb|gltf)$/</span>.<span class="title function_">test</span>(modelPath)) &#123;</span><br><span class="line">            loader = <span class="keyword">new</span> <span class="title class_">GLTFLoader</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/\.dae$/</span>.<span class="title function_">test</span>(modelPath)) &#123;</span><br><span class="line">            loader = <span class="keyword">new</span> <span class="title class_">ColladaLoader</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            loader.<span class="title function_">load</span>(modelPath, <span class="function"><span class="params">obj</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> material = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">MeshStandardMaterial</span>(&#123; <span class="attr">color</span>: <span class="number">0xffffff</span> &#125;);</span><br><span class="line">                <span class="keyword">const</span> material2 = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">MeshStandardMaterial</span>(&#123; <span class="attr">color</span>: <span class="number">0x999999</span> &#125;);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">const</span> ground = [</span><br><span class="line">                    <span class="string">&#x27;地面&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;地面1&#x27;</span>,</span><br><span class="line">                ]</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 遍历模型</span></span><br><span class="line">                <span class="title function_">traversalModelTree</span>(obj.<span class="property">scene</span>.<span class="property">children</span>, <span class="function"><span class="params">modelUnit</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//设置阴影</span></span><br><span class="line">                    modelUnit.<span class="property">castShadow</span> = <span class="literal">true</span>;</span><br><span class="line">                    modelUnit.<span class="property">receiveShadow</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 设置材质</span></span><br><span class="line">                    <span class="keyword">if</span> (ground.<span class="title function_">find</span>(<span class="function"><span class="params">item</span> =&gt;</span> item === modelUnit.<span class="property">name</span>)) &#123;</span><br><span class="line">                        modelUnit.<span class="property">material</span> = material2;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        modelUnit.<span class="property">material</span> = material;</span><br><span class="line">                        <span class="keyword">if</span> (</span><br><span class="line">                            modelUnit.<span class="property">name</span> === <span class="string">&#x27;平面&#x27;</span></span><br><span class="line">                            || modelUnit.<span class="property">name</span> === <span class="string">&#x27;车库&#x27;</span></span><br><span class="line">                        ) &#123;</span><br><span class="line">                            <span class="comment">// 这里把模型提高3个单位，否者和地面重叠会出现闪烁问题</span></span><br><span class="line">                            modelUnit.<span class="property">position</span>.<span class="property">y</span> = <span class="number">3</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                <span class="title function_">resolve</span>(obj.<span class="property">scene</span>);</span><br><span class="line">            &#125;, <span class="literal">undefined</span>, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">reject</span>(err);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递归遍历模型树中每一个最小单位模型，并为其使用回调函数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Three.Group</span>&#125; models 模型树</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; cb 回调函数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">traversalModelTree</span>(<span class="params">models, cb</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> model <span class="keyword">of</span> models) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cb &amp;&amp; cb <span class="keyword">instanceof</span> <span class="title class_">Function</span>) <span class="title function_">cb</span>(model);</span><br><span class="line">            modelUnits.<span class="title function_">push</span>(model);</span><br><span class="line">            <span class="keyword">if</span> (model.<span class="property">children</span> &amp;&amp; model.<span class="property">children</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="title function_">traversalModelTree</span>(model.<span class="property">children</span>, cb);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化threejs事件</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initEvent</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> modelUnits = [</span><br><span class="line">            <span class="comment">// ...model.children,</span></span><br><span class="line">            ...spriteGroup.<span class="property">children</span></span><br><span class="line">        ]</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">handlerLeave</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">            isMouseOnCanvas = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">handlerMove</span> = ev =&gt; &#123;</span><br><span class="line">            isMouseOnCanvas = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (selectedModel) &#123;</span><br><span class="line">                selectedModel.<span class="property">object</span>.<span class="property">material</span>.<span class="property">opacity</span> = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> style = ev.<span class="property">target</span>.<span class="property">style</span>;</span><br><span class="line">            style.<span class="property">cursor</span> = <span class="string">&#x27;default&#x27;</span>;</span><br><span class="line"></span><br><span class="line">            pointer.<span class="property">x</span> = (ev.<span class="property">offsetX</span> / threeContainer.<span class="property">scrollWidth</span>) * <span class="number">2</span> - <span class="number">1</span>;</span><br><span class="line">            pointer.<span class="property">y</span> = <span class="number">1</span> - (ev.<span class="property">offsetY</span> / threeContainer.<span class="property">scrollHeight</span>) * <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> intersects = raycaster.<span class="title function_">intersectObjects</span>(modelUnits, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">if</span> (intersects[<span class="number">0</span>]) &#123;</span><br><span class="line">                style.<span class="property">cursor</span> = <span class="string">&#x27;pointer&#x27;</span>;</span><br><span class="line">                selectedModel = intersects[<span class="number">0</span>];</span><br><span class="line">                selectedModel.<span class="property">object</span>.<span class="property">material</span>.<span class="property">opacity</span> = <span class="number">.5</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">handlerDown</span> = ev =&gt; &#123;</span><br><span class="line"></span><br><span class="line">            pointer.<span class="property">x</span> = (ev.<span class="property">offsetX</span> / threeContainer.<span class="property">scrollWidth</span>) * <span class="number">2</span> - <span class="number">1</span>;</span><br><span class="line">            pointer.<span class="property">y</span> = <span class="number">1</span> - (ev.<span class="property">offsetY</span> / threeContainer.<span class="property">scrollHeight</span>) * <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> intersects = raycaster.<span class="title function_">intersectObjects</span>(modelUnits, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">if</span> (intersects[<span class="number">0</span>]) &#123;</span><br><span class="line">                selectedModel = intersects[<span class="number">0</span>];</span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&#x27;监控点被点击了！&#x27;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        threeContainer.<span class="property">onpointerleave</span> = handlerLeave;</span><br><span class="line">        threeContainer.<span class="property">onpointermove</span> = handlerMove;</span><br><span class="line">        threeContainer.<span class="property">onpointerdown</span> = handlerDown;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化threejs监控点空间坐标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns</span> &#123;<span class="type">Three.Group</span>&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initMonitor</span>(<span class="params">monitorPath</span>) &#123;</span><br><span class="line">        <span class="comment">// 当前模型医院四个角的坐标，这里的位置是相对于你正对医院大门时候的位置，参考</span></span><br><span class="line">        <span class="comment">// &#123; x: 415, y: 30, z: 675 &#125;, // 右下</span></span><br><span class="line">        <span class="comment">// &#123; x: 415, y: 30, z: -670 &#125;, // 右上</span></span><br><span class="line">        <span class="comment">// &#123; x: -355, y: 30, z: 675 &#125;, // 左下</span></span><br><span class="line">        <span class="comment">// &#123; x: -355, y: 30, z: -670 &#125;, // 左上</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 当前医院大门坐标，参考</span></span><br><span class="line">        <span class="comment">// &#123; x: -15, y: 30, z: 675 &#125;,</span></span><br><span class="line">        <span class="comment">// &#123; x: -205, y: 30, z: 675 &#125;,</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> monitorInterval = <span class="number">80.8</span> <span class="comment">// 摄像机间隔</span></span><br><span class="line">            , adjustLongSide = -<span class="number">2</span> <span class="comment">// 长边间隔调整</span></span><br><span class="line">            , adjustShortSide = <span class="number">4.6</span>; <span class="comment">// 短边间隔调整</span></span><br><span class="line">        <span class="keyword">let</span> monitorHeight = <span class="number">30</span>; <span class="comment">// 摄像机高度</span></span><br><span class="line">        <span class="keyword">let</span> monitorScale = <span class="number">30</span>; <span class="comment">// 摄像机图片缩放倍数</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> monitorPositionRight = []; <span class="comment">// 右围栏监控点坐标</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">17</span>; i++) &#123;</span><br><span class="line">            monitorPositionRight.<span class="title function_">push</span>(&#123; <span class="attr">x</span>: <span class="number">415</span>, <span class="attr">y</span>: monitorHeight, <span class="attr">z</span>: <span class="number">675</span> - i * (monitorInterval + adjustLongSide) &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> monitorPositionLeft = []; <span class="comment">// 左围栏监控点坐标</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">17</span>; i++) &#123;</span><br><span class="line">            monitorPositionLeft.<span class="title function_">push</span>(&#123; <span class="attr">x</span>: -<span class="number">355</span>, <span class="attr">y</span>: monitorHeight, <span class="attr">z</span>: -<span class="number">670</span> + i * (monitorInterval + adjustLongSide) &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> monitorPositionTop = []; <span class="comment">// 上围栏监控点坐标</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">            monitorPositionTop.<span class="title function_">push</span>(&#123; <span class="attr">x</span>: <span class="number">415</span> - i * (monitorInterval + adjustShortSide), <span class="attr">y</span>: monitorHeight, <span class="attr">z</span>: -<span class="number">670</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> monitorPositionBottom = []; <span class="comment">// 下围栏监控点坐标</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">let</span> x = -<span class="number">355</span> + i * (monitorInterval + adjustShortSide);</span><br><span class="line">            <span class="comment">// 摄像机点位不能在大门上方</span></span><br><span class="line">            <span class="keyword">if</span> (x &lt; -<span class="number">205</span> || x &gt; -<span class="number">15</span>) monitorPositionBottom.<span class="title function_">push</span>(&#123; x, <span class="attr">y</span>: monitorHeight, <span class="attr">z</span>: <span class="number">675</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> monitorPosition = [</span><br><span class="line">            ...monitorPositionLeft,</span><br><span class="line">            ...monitorPositionRight,</span><br><span class="line">            ...monitorPositionTop,</span><br><span class="line">            ...monitorPositionBottom</span><br><span class="line">        ];</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">addMonitorPoint</span>(monitorPath, monitorPosition, monitorScale);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">&#123;x:Number,y:Number,z:Number</span>&#125;[]&#125; pointPositions 监控点空间坐标数组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; scale 摄像机图片缩放倍数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns</span> &#123;<span class="type">Three.Group</span>&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">addMonitorPoint</span>(<span class="params">monitorPath, pointPositions, scale = <span class="number">1</span></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> spriteGroup = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">Group</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> pointPosition <span class="keyword">of</span> pointPositions) &#123;</span><br><span class="line">            <span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">TextureLoader</span>().<span class="title function_">load</span>(monitorPath);</span><br><span class="line">            <span class="keyword">let</span> material = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">SpriteMaterial</span>(&#123; map &#125;);</span><br><span class="line">            <span class="keyword">let</span> sprite = <span class="keyword">new</span> <span class="title class_">Three</span>.<span class="title class_">Sprite</span>(material);</span><br><span class="line">            sprite.<span class="property">position</span>.<span class="title function_">set</span>(pointPosition.<span class="property">x</span>, pointPosition.<span class="property">y</span>, pointPosition.<span class="property">z</span>,);</span><br><span class="line">            sprite.<span class="property">scale</span>.<span class="title function_">set</span>(scale, scale, scale);</span><br><span class="line">            spriteGroup.<span class="title function_">add</span>(sprite);</span><br><span class="line">            scene.<span class="title function_">add</span>(spriteGroup)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> spriteGroup;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>Three.js</tag>
      </tags>
  </entry>
  <entry>
    <title>记录一个公司项目（uniapp原生实现异形范围选择器slider）</title>
    <url>/2024/05/21/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AA%E5%85%AC%E5%8F%B8%E9%A1%B9%E7%9B%AE%EF%BC%88uniapp%E5%8E%9F%E7%94%9F%E5%AE%9E%E7%8E%B0%E5%BC%82%E5%BD%A2%E8%8C%83%E5%9B%B4%E9%80%89%E6%8B%A9%E5%99%A8slider%EF%BC%89/</url>
    <content><![CDATA[<p>公司要求根据 UI 的设计实现一个如下所示的异形范围选择滑动条。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025382_e545b406af3ccadf6980a092e1b09aa5.png"
                     
                ></p>
<span id="more"></span>

<p>但是目前没有合适的第三方库可用，且对于拖拽事件有些手生了，所以只能亲手这个组件了，在此记录一下，顺便复习一下拖拽事件的原理。</p>
<p>直接上 uniapp 代码，最后实现效果就如上图所示：</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;zh-slider&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 异形图mask --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;bar-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 范围mask --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;bar-cover&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:style</span>=<span class="string">&quot;`mask-image: linear-gradient(90deg, transparent 0%, transparent $&#123;currentMinPercent&#125;%, white $&#123;currentMinPercent&#125;%, white $&#123;currentMaxPercent&#125;%, transparent $&#123;currentMaxPercent&#125;%, transparent 100%);`&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;bar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;num-val&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 最大值和最小值 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;static&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;min-val&quot;</span>&gt;</span>&#123;&#123;minVal&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;max-val&quot;</span>&gt;</span>&#123;&#123;maxVal&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 滑动栏 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;handle-bar&quot;</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">touchmove</span>=<span class="string">&quot;drag&quot;</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">touchend</span>=<span class="string">&quot;dragEnd&quot;</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">mousemove</span>=<span class="string">&quot;drag&quot;</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">mouseup</span>=<span class="string">&quot;dragEnd&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span></span></span><br><span class="line"><span class="tag">          <span class="attr">data-class</span>=<span class="string">&quot;current-min-val&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;current-min-val&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:style</span>=<span class="string">&quot;`left: $&#123;percent1&#125;%;`&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">touchstart</span>=<span class="string">&quot;dragStart&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">mousedown</span>=<span class="string">&quot;dragStart&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>&#123;&#123;currentMinVal&#125;&#125;&lt;/text</span><br><span class="line">        &gt;</span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span></span></span><br><span class="line"><span class="tag">          <span class="attr">data-class</span>=<span class="string">&quot;current-max-val&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;current-max-val&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:style</span>=<span class="string">&quot;`left: $&#123;percent2&#125;%;`&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">touchstart</span>=<span class="string">&quot;dragStart&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">mousedown</span>=<span class="string">&quot;dragStart&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>&#123;&#123;currentMaxVal&#125;&#125;&lt;/text</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&quot;zh-slider&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">minVal</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="number">60</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">maxVal</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="number">90</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 单位rpx，滑动栏距离左右屏幕的距离，如果在组件外修改了这个值，则需要在此同步更改该值</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">sideGapWidth</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">percent1</span>: <span class="number">30</span>, <span class="comment">// 百分比1</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">percent2</span>: <span class="number">60</span>, <span class="comment">// 百分比2</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">barActive1</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">barActive2</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">deviceWidth</span>: <span class="number">0</span>, <span class="comment">// 单位px，屏幕宽度</span></span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">currentMinPercent</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="variable language_">this</span>.<span class="property">percent1</span>, <span class="variable language_">this</span>.<span class="property">percent2</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">currentMaxPercent</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="variable language_">this</span>.<span class="property">percent1</span>, <span class="variable language_">this</span>.<span class="property">percent2</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">currentMinVal</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> (</span></span><br><span class="line"><span class="language-javascript">          (<span class="variable language_">this</span>.<span class="property">percent1</span> / <span class="number">100</span>) * (<span class="variable language_">this</span>.<span class="property">maxVal</span> - <span class="variable language_">this</span>.<span class="property">minVal</span>) +</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">minVal</span></span></span><br><span class="line"><span class="language-javascript">        ).<span class="title function_">toFixed</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">currentMaxVal</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> (</span></span><br><span class="line"><span class="language-javascript">          (<span class="variable language_">this</span>.<span class="property">percent2</span> / <span class="number">100</span>) * (<span class="variable language_">this</span>.<span class="property">maxVal</span> - <span class="variable language_">this</span>.<span class="property">minVal</span>) +</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">minVal</span></span></span><br><span class="line"><span class="language-javascript">        ).<span class="title function_">toFixed</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 滑动栏宽度，单位px</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">handleBarContainerWidth</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">rpx2px</span>(<span class="number">750</span> - <span class="number">2</span> * <span class="variable language_">this</span>.<span class="property">sideGapWidth</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">getDeviceWidth</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       * 获取屏幕宽度</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       */</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">async</span> <span class="title function_">getDeviceWidth</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> res = <span class="keyword">await</span> uni.<span class="title function_">getSystemInfo</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">deviceWidth</span> = res[<span class="number">1</span>].<span class="property">windowWidth</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">dragStart</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (e.<span class="property">target</span>.<span class="property">dataset</span>.<span class="property">class</span> === <span class="string">&quot;current-min-val&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">barActive1</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.<span class="property">target</span>.<span class="property">dataset</span>.<span class="property">class</span> === <span class="string">&quot;current-max-val&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">barActive2</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">dragEnd</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">barActive1</span> = <span class="variable language_">this</span>.<span class="property">barActive2</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> min = <span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="variable language_">this</span>.<span class="property">currentMinVal</span>, <span class="variable language_">this</span>.<span class="property">currentMaxVal</span>),</span></span><br><span class="line"><span class="language-javascript">          max = <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="variable language_">this</span>.<span class="property">currentMinVal</span>, <span class="variable language_">this</span>.<span class="property">currentMaxVal</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$emit(<span class="string">&quot;change&quot;</span>, [min, max]);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">drag</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">barActive1</span> || <span class="variable language_">this</span>.<span class="property">barActive2</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> clientX = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (e.<span class="property">type</span> === <span class="string">&quot;touchmove&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            clientX = e.<span class="property">touches</span>[<span class="number">0</span>].<span class="property">clientX</span> - <span class="variable language_">this</span>.<span class="title function_">rpx2px</span>(<span class="variable language_">this</span>.<span class="property">sideGapWidth</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            clientX = e.<span class="property">clientX</span> - <span class="variable language_">this</span>.<span class="title function_">rpx2px</span>(<span class="variable language_">this</span>.<span class="property">sideGapWidth</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">barActive1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (clientX &lt;= <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="property">percent1</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (clientX &gt;= <span class="variable language_">this</span>.<span class="property">handleBarContainerWidth</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="property">percent1</span> = <span class="number">100</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="property">percent1</span> = (clientX / <span class="variable language_">this</span>.<span class="property">handleBarContainerWidth</span>) * <span class="number">100</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">barActive2</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (clientX &lt;= <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="property">percent2</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (clientX &gt;= <span class="variable language_">this</span>.<span class="property">handleBarContainerWidth</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="property">percent2</span> = <span class="number">100</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="property">percent2</span> = (clientX / <span class="variable language_">this</span>.<span class="property">handleBarContainerWidth</span>) * <span class="number">100</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       * rpx转px</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; <span class="variable">rpx</span></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       */</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">rpx2px</span>(<span class="params">rpx</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> (rpx / <span class="number">750</span>) * <span class="variable language_">this</span>.<span class="property">deviceWidth</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       * px转rpx</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; <span class="variable">px</span></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">       */</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">px2rpx</span>(<span class="params">px</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        (px / <span class="variable language_">this</span>.<span class="property">deviceWidth</span>) * <span class="number">750</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span></span><br><span class="line">  .zh-slider &#123;</span><br><span class="line">    width: 700rpx;</span><br><span class="line">    height: 150rpx;</span><br><span class="line"></span><br><span class="line">    $barHeight: 55%;</span><br><span class="line"></span><br><span class="line">    &gt; .bar-container &#123;</span><br><span class="line">      position: relative;</span><br><span class="line">      height: $barHeight;</span><br><span class="line">      background-color: #eff1f1;</span><br><span class="line"></span><br><span class="line">      // CSS 属性 mask 允许使用者通过遮罩或者裁切特定区域的图片的方式来隐藏一个元素的部分或者全部可见区域。</span><br><span class="line">      // 这里本来是引用了另一个图片文件，但是为了写博客方便，就改成了base64数据</span><br><span class="line">      mask: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUkAAAAzCAYAAAAaRPq7AAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAdoSURBVHhe7Z3LchtFFIanR87F1sWSiS1LspFsK5LKd8cUCxY8A1UssoAHSGXPEih4AopNXoAVxQpeAVixIFQeIFyq2FmSJdnG1kzzn9E4jkGJrEgjzeVX1dSMR6Pu01+P/zpn+nSPMvghARIggYgQ0FrHW63Wnm3bu1qpTUPr9wylDnH+D6XUU+x/zszPf4Xjs0skKiJs2EwSIIGIETg+Pq7YSu1q295G0x9AELchiGsDMWj9PGaaH6dSqZ/kWorkQGK8gARIwM8E4P0lG+32gWHbexBC8RBFFPchbndHsjsWO8gkEr9SJEeiyB+TAAlMkgC8wxpC5T14hDu2YRxAFHcQGq96YoPWv2XS6T2KpCd0WSgJkMAoBOAdpuAdPoB3uAshFFHc1YaxPbJ3OKRRSuuHFMkhofFyEiCB8RIQ79DCIAoE6R2I4w62fXiHK+Ot5Y1L+54i+cbs+EMSIIFhCED8EvVWS0LkPQhizzvEYAoEcW6YciZ5Lez7iyI5SeKsiwQiQgDeYdUyjBoE8RBNlpB5H6JYDGLzKZJB7DXaTAI+IAAvK4acwzLEUPINt/DMUELmLYhhFebd8YGJYzGBIjkWjCyEBMJLoI8YbkEMN8Mmhq/qQYpkeO9ttowEhiLQbrez57ZdMQ2jgjSbKp4VVuAdViASGyjo9lCFhehiimSIOpNNIYFBBOAVzjZOTmrq4qKCpOsKrpfQuILzFYji/KDfR/F7imQUe51tDjUBCJ7ZbDZLEL0qEq7FG6wiPK46e6UKoW68B42jSHoAlUWSwCQIHGk9P9NqbWLgpCeACJXhHVbxT10O08DJJFi+rg6K5LR7gPWTwGsIvDRoIuJXxWINNVcIJUy+R3jeE6BIes+YNZDAQAKuV7jteIW9QRPxDmv4B13Hj28NLIAXeEaAIukZWhZMAlcE4BGq09PTwj+WtYGcwg0ZMbbdvfyNdJoMefmTAEXSn/1CqwJKQOYhQxDXMGByH03YgDco6TMiirWANinyZlMkI38LEMAwBCSFpt7p3MdocRnbBvIJy24eYRneoCzZhTRDfsJEgCIZpt5kW8ZCoH56WjK63SKW6ZK5xrKVxSN0R42zY6mEhQSGAEUyMF1FQ8dBAJ7gbcw3XoMHWDRMs4jngUUIoCOG+K7o5hHGxlEXywgHAYpkOPqRrXAJQOjuYnrdOkSwhJHikoggwuASbvSS6xXSE+TdMhQBiuRQuHjxtAkgFC7GLi4KEMEC8gULEMWcGwY7Ygj73pq2jaw/XAQokuHqz8C2pq51eqbdXrEsK69NcwUeoCOCGBwpyDEEUKbTLQW2gTQ8sAQokoHtumAYLvmBCH8XLQiftqwVJEoXTDnW+lIInT2eBSaC0SJaGTUCFMmo9fgY2ysC2Ol0st1ud8X1/lYd8cP7SXBjrUL85Fg8wMguszVG3CxqSgQoklMC7/dqJQ3GPD/P4uXuWSycsIzQV0LdZQifHGcRBq8GdTl+v7Onff4iQJH0V394ag28vvwFhE51u8sQv2WEvlmEuTkRPud5n1J5eIJyLuWpISycBAJEgCIZoM7qZypEbQ5T4fJ4JWfOtO0cvDzZluHp5ZH/J55fDqInIrgY8KbSfBKYCgGK5FSwv7pSCJ6ksDhbF0thoYOcY+wXkPay6P59D15fzkl/4YCHz3qQ5oSNAEVyQj0KQUtipkfBNs0CRnklvy/vzO5w01vcv8Xjm5mQSayGBEjgBgQokjeAdHmJvFwdy+IvQdyW8ExvCfCWxLvD9xlMcUtB8ORZXgrnXxzD45NzTHAegjMvJQE/EYicSIpHh3X90me2ncECBvLiozTE7eV977j3UqTeBq8P+0WI46yfOo+2kAAJeE8gkCIJoUs1zs4WkJqyAAHLYMWWBfHmsIafs5cNDXP27iail8axfM8PCZAACdyYgOciKcvS3zk5iWO6WcKOxRK2ZcVjWseRfBxHCkoco7Bzcgyxm4P4xR1vTY6VmnO+wx6tkU0GMUTkODXtxt3LC0mABEYl0FcksajoAd7L+66kk7yqAll81H3eJiFpCoKWdMPTJM4nJKxleDpq9/D3JEAC0yZwTSSPms3HMOgxTm5N2zDWTwIkQAJ+IPBCJOuNxnfwAD/0g1G0gQRIgAT8QsARSXiQT3DwyC9G0Q4SIAES8AsB1Wg0DvHs8Re/GEQ7SIAESMBPBFS92fwGBn3kJ6NoCwmQAAn4hYBCqP03Qm2ZDscPCZAACZDAfwiIJ4nFYvghARIgARLoR0AdNRpt5DPGiYcESIAESOA6AeR7tyTcfsa8SN4aJEACJNCHgNZPJdz+El99SkAkQAIkQAL/I/C5pADJwhB/MuTm7UECJEACVwQQandMvNDOSSaHUD5CruQTAiIBEiABEnAI2NDEDxZSqR+upiU2m1/gi88IiARIgASiTgAL9jxMp9PfCodrC1zU2+09rM34NeZwvx91SGw/CZBAtAggvG5D+368ZZqfJJPJZ5et77tUGsLvdR2LvR0tRGwtCZBARAloY2bmeWZ29vd+7f8XokpqetSrGC8AAAAASUVORK5CYII=)</span><br><span class="line">        no-repeat center/100% 100%;</span><br><span class="line"></span><br><span class="line">      &gt; .bar-cover &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;</span><br><span class="line"></span><br><span class="line">        &gt; .bar &#123;</span><br><span class="line">          width: 100%;</span><br><span class="line">          height: 100%;</span><br><span class="line">          background-image: linear-gradient(90deg, #43ad93 0%, #5beeb9 100%);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &gt; .num-val &#123;</span><br><span class="line">      position: relative;</span><br><span class="line">      width: 100%;</span><br><span class="line">      height: calc(100% - #&#123;$barHeight&#125;);</span><br><span class="line"></span><br><span class="line">      &gt; .static &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        justify-content: space-between;</span><br><span class="line">        align-items: center;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;</span><br><span class="line"></span><br><span class="line">        &gt; text &#123;</span><br><span class="line">          color: #9e9e9e;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &gt; .handle-bar &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        left: 0%;</span><br><span class="line">        top: 0%;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;</span><br><span class="line">        padding: 6rpx 0;</span><br><span class="line">        box-sizing: border-box;</span><br><span class="line"></span><br><span class="line">        &gt; text &#123;</span><br><span class="line">          position: absolute;</span><br><span class="line">          display: flex;</span><br><span class="line">          justify-content: center;</span><br><span class="line">          align-items: center;</span><br><span class="line">          width: 100rpx;</span><br><span class="line">          height: 60rpx;</span><br><span class="line">          background-image: linear-gradient(90deg, #30ac8f 0%, #4ddebc 100%);</span><br><span class="line">          border-radius: 12rpx;</span><br><span class="line">          color: white;</span><br><span class="line">          transform: translateX(calc(0rpx - 50%));</span><br><span class="line"></span><br><span class="line">          &amp;.current- &#123;</span><br><span class="line">            &amp;min-val &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            &amp;max-val &#123;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
        <tag>javascript</tag>
        <tag>uniapp</tag>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>赤脚医生手册</title>
    <url>/2023/11/21/%E8%B5%A4%E8%84%9A%E5%8C%BB%E7%94%9F%E6%89%8B%E5%86%8C/</url>
    <content><![CDATA[<p>免责声明：本材料不作为商业目的，仅交流使用，如有侵权，联系删除即可。</p>
<p><a href="/mydoc/%E8%B5%A4%E8%84%9A%E5%8C%BB%E7%94%9F%E6%89%8B%E5%86%8C.pdf">赤脚医生手册</a></p>
]]></content>
      <categories>
        <category>生活</category>
      </categories>
      <tags>
        <tag>图书</tag>
      </tags>
  </entry>
  <entry>
    <title>跟随鼠标的眼球css特效</title>
    <url>/2023/06/07/%E8%B7%9F%E9%9A%8F%E9%BC%A0%E6%A0%87%E7%9A%84%E7%9C%BC%E7%90%83css%E7%89%B9%E6%95%88/</url>
    <content><![CDATA[<p>闲来无事逛稀土掘金，发现一个<a class="link"   href="https://juejin.cn/post/7132409301380890660" >不错的创意 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>反正我摸鱼也无聊，所以也去造个轮子打发时间<br>我先不看这位爷怎么实现的，我自己试试能不能搞出来</p>
<h1 id="预览"><a href="#预览" class="headerlink" title="预览"></a>预览</h1><p>点击 <a href="/mypage/%E8%B7%9F%E9%9A%8F%E9%BC%A0%E6%A0%87%E7%9A%84%E7%9C%BC%E7%90%83css%E7%89%B9%E6%95%88">简易大眼睛</a> 预览<br>点击 <a href="/mypage/%E8%B7%9F%E9%9A%8F%E9%BC%A0%E6%A0%87%E7%9A%84%E7%9C%BC%E7%90%83css%E7%89%B9%E6%95%88/index2.html">卢恩符文大眼睛</a> 预览  </p>
<p>省去了原博客里面的很多特效，我做完了一看他的实现过程，居然用到了ECharts，果然我对Echarts还是不熟悉</p>
<span id="more"></span>

<h1 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h1><h2 id="简易大眼睛"><a href="#简易大眼睛" class="headerlink" title="简易大眼睛"></a>简易大眼睛</h2><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-pseudo">:root</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attr">--color-1</span>: <span class="number">#01fd9cee</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        * &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: black;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">perspective</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="keyword">@keyframes</span> wrapperBreathe &#123;</span></span><br><span class="line"><span class="language-css">            <span class="number">0%</span> &#123;</span></span><br><span class="line"><span class="language-css">                scale: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="number">50%</span> &#123;</span></span><br><span class="line"><span class="language-css">                scale: <span class="number">1.04</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="number">100%</span> &#123;</span></span><br><span class="line"><span class="language-css">                scale: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#wrapper</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            translate: -<span class="number">50%</span> -<span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">8px</span> solid <span class="built_in">var</span>(--color-<span class="number">1</span>);</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">perspective</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation</span>: wrapperBreathe <span class="number">2s</span> ease-out <span class="number">0s</span> infinite;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">18px</span> <span class="number">0</span> <span class="built_in">var</span>(--color-<span class="number">1</span>) inset;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="keyword">@keyframes</span> innerRotate &#123;</span></span><br><span class="line"><span class="language-css">            <span class="number">0%</span> &#123;</span></span><br><span class="line"><span class="language-css">                rotate: <span class="number">0deg</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="number">100%</span> &#123;</span></span><br><span class="line"><span class="language-css">                rotate: <span class="number">360deg</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#inner</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            translate: -<span class="number">50%</span> -<span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">20%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">20%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">4px</span> solid <span class="built_in">var</span>(--color-<span class="number">1</span>);</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-style</span>: dashed;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(<span class="number">50px</span>);</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation</span>: innerRotate <span class="number">5s</span> linear <span class="number">0s</span> infinite;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#inner</span>&gt;<span class="selector-class">.aperture</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            translate: -<span class="number">50%</span> -<span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="built_in">var</span>(--color-<span class="number">1</span>);</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">18px</span> <span class="number">2px</span> <span class="built_in">var</span>(--color-<span class="number">1</span>);</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;inner&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;aperture&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> $body = <span class="variable language_">document</span>.<span class="property">body</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> $wrapper = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;wrapper&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> $inner = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;inner&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> &#123; clientWidth, clientHeight &#125; = $body;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> centerPoint = &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">x</span>: clientWidth / <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">y</span>: clientHeight / <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> maxDeg = <span class="number">45</span>; <span class="comment">// unit deg</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> maxScale = <span class="number">.5</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        $body.<span class="property">onmousemove</span> = <span class="function"><span class="params">ev</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> &#123; clientX, clientY &#125; = ev;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> percent = &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">x</span>: (clientX - centerPoint.<span class="property">x</span>) / centerPoint.<span class="property">x</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">y</span>: (clientY - centerPoint.<span class="property">y</span>) / centerPoint.<span class="property">y</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            $wrapper.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">`rotateX(<span class="subst">$&#123;-maxDeg * percent.y&#125;</span>deg) rotateY(<span class="subst">$&#123;maxDeg * percent.x&#125;</span>deg)`</span>;</span></span><br><span class="line"><span class="language-javascript">            $inner.<span class="property">style</span>.<span class="property">scale</span> = (<span class="number">2</span> - <span class="title class_">Math</span>.<span class="title function_">abs</span>(percent.<span class="property">y</span>) - <span class="title class_">Math</span>.<span class="title function_">abs</span>(percent.<span class="property">x</span>)) * maxScale + <span class="number">1</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="卢恩符文大眼睛"><a href="#卢恩符文大眼睛" class="headerlink" title="卢恩符文大眼睛"></a>卢恩符文大眼睛</h2><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-pseudo">:root</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attr">--color-1</span>: <span class="number">#01fd9c</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        * &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: black;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">perspective</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="keyword">@keyframes</span> wrapperBreathe &#123;</span></span><br><span class="line"><span class="language-css">            <span class="number">0%</span> &#123;</span></span><br><span class="line"><span class="language-css">                scale: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="number">50%</span> &#123;</span></span><br><span class="line"><span class="language-css">                scale: <span class="number">1.04</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="number">100%</span> &#123;</span></span><br><span class="line"><span class="language-css">                scale: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#wrapper</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            translate: -<span class="number">50%</span> -<span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">8px</span> solid <span class="built_in">var</span>(--color-<span class="number">1</span>);</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">perspective</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation</span>: wrapperBreathe <span class="number">2s</span> ease-out <span class="number">0s</span> infinite;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">18px</span> <span class="number">0</span> <span class="built_in">var</span>(--color-<span class="number">1</span>) inset;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="keyword">@keyframes</span> innerRotate &#123;</span></span><br><span class="line"><span class="language-css">            <span class="number">0%</span> &#123;</span></span><br><span class="line"><span class="language-css">                rotate: <span class="number">0deg</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="number">100%</span> &#123;</span></span><br><span class="line"><span class="language-css">                rotate: <span class="number">360deg</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#inner</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            translate: -<span class="number">50%</span> -<span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">27%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">27%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(<span class="number">50px</span>);</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation</span>: innerRotate <span class="number">8s</span> linear <span class="number">0s</span> infinite;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#inner</span>&gt;<span class="selector-class">.aperture</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            translate: -<span class="number">50%</span> -<span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="built_in">var</span>(--color-<span class="number">1</span>);</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">18px</span> <span class="number">2px</span> <span class="built_in">var</span>(--color-<span class="number">1</span>);</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#inner</span>&gt;<span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">transform-origin</span>: center bottom;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="built_in">var</span>(--color-<span class="number">1</span>);</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;inner&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;aperture&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> $body = <span class="variable language_">document</span>.<span class="property">body</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> $wrapper = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;wrapper&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> $inner = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;inner&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> &#123; clientWidth, clientHeight &#125; = $body;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> centerPoint = &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">x</span>: clientWidth / <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">y</span>: clientHeight / <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> maxDeg = <span class="number">45</span>; <span class="comment">// unit deg</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> maxScale = <span class="number">.5</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 眼球跟随鼠标事件</span></span></span><br><span class="line"><span class="language-javascript">        $body.<span class="property">onmousemove</span> = <span class="function"><span class="params">ev</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> &#123; clientX, clientY &#125; = ev;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> percent = &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">x</span>: (clientX - centerPoint.<span class="property">x</span>) / centerPoint.<span class="property">x</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">y</span>: (clientY - centerPoint.<span class="property">y</span>) / centerPoint.<span class="property">y</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            $wrapper.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">`rotateX(<span class="subst">$&#123;-maxDeg * percent.y&#125;</span>deg) rotateY(<span class="subst">$&#123;maxDeg * percent.x&#125;</span>deg)`</span>;</span></span><br><span class="line"><span class="language-javascript">            $inner.<span class="property">style</span>.<span class="property">scale</span> = (<span class="number">2</span> - <span class="title class_">Math</span>.<span class="title function_">abs</span>(percent.<span class="property">y</span>) - <span class="title class_">Math</span>.<span class="title function_">abs</span>(percent.<span class="property">x</span>)) * maxScale + <span class="number">1</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 卢恩文字与其动画</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> _letters = <span class="string">&#x27;ᚠᚡᚢᚣᚤᚥᚦᚧᚨᚩᚪᚫᚬᚭᚮᚯᚰᚱᚳᚴᚵᚶᚸᚹᚺᚻᚼᚽᚾᚿᛀᛂᛃᛄᛅᛆᛇᛈᛉᛊᛋᛍᛎᛏᛐᛑᛒᛓᛔᛗᛘᛙᛚᛛᛜᛝᛞᛟᛠᛡᛢᛣᛤᛥᛦᛧᛨᛩᛪ᛫ᛮᛯᛰ&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> letters = _letters.<span class="title function_">substr</span>(<span class="number">0</span>, <span class="number">30</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> letterUnitDeg = <span class="number">360</span> / letters.<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> $fragment = <span class="variable language_">document</span>.<span class="title function_">createDocumentFragment</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> letters) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> letter = letters[i];</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> $span = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;span&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            $span.<span class="property">innerText</span> = letter;</span></span><br><span class="line"><span class="language-javascript">            $span.<span class="property">style</span>.<span class="property">rotate</span> = <span class="string">`<span class="subst">$&#123;i * letterUnitDeg&#125;</span>deg`</span>;</span></span><br><span class="line"><span class="language-javascript">            $span.<span class="property">style</span>.<span class="property">height</span> = <span class="string">`<span class="subst">$&#123;$inner.clientHeight / <span class="number">2</span>&#125;</span>px`</span>;</span></span><br><span class="line"><span class="language-javascript">            $span.<span class="property">style</span>.<span class="property">translate</span> = <span class="string">`calc(<span class="subst">$&#123;$inner.clientWidth / <span class="number">2</span>&#125;</span>px - 50%)`</span>;</span></span><br><span class="line"><span class="language-javascript">            $fragment.<span class="title function_">append</span>($span);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        $inner.<span class="title function_">append</span>($fragment);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> $letterArr = <span class="title class_">Array</span>.<span class="title function_">from</span>($inner.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;span&#x27;</span>));</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> <span class="title function_">flicker</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> index = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * letters.<span class="property">length</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> $span = $letterArr[index];</span></span><br><span class="line"><span class="language-javascript">            $span.<span class="property">innerText</span> = _letters[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * _letters.<span class="property">length</span>)];</span></span><br><span class="line"><span class="language-javascript">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">requestAnimationFrame</span>(flicker);</span></span><br><span class="line"><span class="language-javascript">            &#125;, <span class="number">50</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">flicker</span>();</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
        <tag>javascript</tag>
        <tag>特效</tag>
      </tags>
  </entry>
  <entry>
    <title>通过WebRTC实现局域网p2p文件传输功能</title>
    <url>/2023/05/16/%E9%80%9A%E8%BF%87WebRTC%E5%AE%9E%E7%8E%B0%E5%B1%80%E5%9F%9F%E7%BD%91p2p%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E5%8A%9F%E8%83%BD/</url>
    <content><![CDATA[<p>预览</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/user/1716258025382_4060f9c63fe1fc8a49799c1f9eb10878.gif"
                     
                ></p>
<span id="more"></span>

<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>起初我是想实现一个不论在内网还是公网环境下都能建立 p2p 连接传输文件的功能，后来经过学习发现，内网环境实现起来很简单，但是公网就很麻烦了，要用到 STUN 和 TURN，并且不符合我“只能通过 p2p 传输文件，不能经过中转服务器”的理念，所以这个项目只实现了<strong>局域网</strong>这部分的功能</p>
<h1 id="已知问题"><a href="#已知问题" class="headerlink" title="已知问题"></a>已知问题</h1><ul>
<li>因为信令服务器没有部署 ssl 证书，所以当前端页面部署到 https 协议的服务器里时，无法访问信令服务器</li>
</ul>
<h1 id="关键概念"><a href="#关键概念" class="headerlink" title="关键概念"></a>关键概念</h1><ul>
<li>p2p：对等连接。</li>
<li>信令服务器：帮助 p2p 双方交换进行 WebRTC 连接所必须的信息，一般用 WebSocket 实现。</li>
<li>STUN：帮助 p2p 双方获取到对方的 IP 地址和端口号，_（仅公网和多重内网环境需要）_。</li>
<li>TURN：数据中转服务，当 p2p 连接失败时，会使用 TURN 服务中转数据，_（仅公网和多重内网环境需要）_。</li>
</ul>
<h1 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h1><h2 id="信令服务器目录结构"><a href="#信令服务器目录结构" class="headerlink" title="信令服务器目录结构"></a>信令服务器目录结构</h2><ul>
<li>src<ul>
<li>server.js 主文件</li>
<li>Users.js 用户类</li>
</ul>
</li>
</ul>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// server.js</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> https = <span class="built_in">require</span>(<span class="string">&quot;https&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> ws = <span class="built_in">require</span>(<span class="string">&quot;ws&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Users</span> = <span class="built_in">require</span>(<span class="string">&quot;./Users&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">9999</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">middleware</span> = (<span class="params">req, res</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 允许跨域连接</span></span><br><span class="line">  res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;</span><br><span class="line">    <span class="comment">// &#x27;Content-Type&#x27;: &#x27;text/plain&#x27;,</span></span><br><span class="line">    <span class="string">&quot;Access-Control-Allow-Origin&quot;</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Access-Control-Allow-Headers&quot;</span>: <span class="string">&quot;Content-Type&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Access-Control-Allow-Methods&quot;</span>: <span class="string">&quot;GET, POST, PUT, DELETE, OPTIONS&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> server;</span><br><span class="line"><span class="keyword">if</span> (fs.<span class="title function_">existsSync</span>(<span class="string">&quot;./ssl/server.crt&quot;</span>)) &#123;</span><br><span class="line">  <span class="comment">// 如果根目录有ssl证书则使用https</span></span><br><span class="line">  server = https.<span class="title function_">createServer</span>(</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">key</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&quot;./ssl/server.key&quot;</span>),</span><br><span class="line">      <span class="attr">cert</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&quot;./ssl/server.crt&quot;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    middleware</span><br><span class="line">  );</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  server = http.<span class="title function_">createServer</span>(middleware);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wsServer = <span class="keyword">new</span> ws.<span class="title class_">Server</span>(&#123;</span><br><span class="line">  server,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> users = <span class="keyword">new</span> <span class="title class_">Users</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onMsghandler</span> = (<span class="params">socket</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;socket创建成功&quot;</span>);</span><br><span class="line">  socket.<span class="title function_">on</span>(<span class="string">&quot;message&quot;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> obj;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(msg.<span class="title function_">toString</span>());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;&#125;</span><br><span class="line">    <span class="keyword">let</span> &#123; type, data &#125; = obj;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;login&quot;</span>:</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">let</span> flag = users.<span class="title function_">addUser</span>(socket);</span><br><span class="line">          socket.<span class="title function_">send</span>(</span><br><span class="line">            <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">              <span class="attr">type</span>: <span class="string">&quot;login_success&quot;</span>,</span><br><span class="line">              <span class="attr">data</span>: flag,</span><br><span class="line">            &#125;)</span><br><span class="line">          );</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;当前用户列表&quot;</span>, users.<span class="title function_">getUserFlags</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;send_offer&quot;</span>:</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">let</span> userRemote = users.<span class="title function_">getUserByFlag</span>(data.<span class="property">flagRemote</span>);</span><br><span class="line">          <span class="keyword">if</span> (userRemote === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            socket.<span class="title function_">send</span>(</span><br><span class="line">              <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;remote_disconnected&quot;</span>,</span><br><span class="line">              &#125;)</span><br><span class="line">            );</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            userRemote.<span class="property">socket</span>.<span class="title function_">send</span>(</span><br><span class="line">              <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;receive_offer&quot;</span>,</span><br><span class="line">                data,</span><br><span class="line">              &#125;)</span><br><span class="line">            );</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;send_answer&quot;</span>:</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">let</span> userRemote = users.<span class="title function_">getUserByFlag</span>(data.<span class="property">flagRemote</span>);</span><br><span class="line">          <span class="keyword">if</span> (userRemote === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            socket.<span class="title function_">send</span>(</span><br><span class="line">              <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;remote_disconnected&quot;</span>,</span><br><span class="line">              &#125;)</span><br><span class="line">            );</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            userRemote.<span class="property">socket</span>.<span class="title function_">send</span>(</span><br><span class="line">              <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;receive_answer&quot;</span>,</span><br><span class="line">                data,</span><br><span class="line">              &#125;)</span><br><span class="line">            );</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;send_ice&quot;</span>:</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">let</span> userRemote = users.<span class="title function_">getUserByFlag</span>(data.<span class="property">flagRemote</span>);</span><br><span class="line">          <span class="keyword">if</span> (userRemote === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            socket.<span class="title function_">send</span>(</span><br><span class="line">              <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;remote_disconnected&quot;</span>,</span><br><span class="line">              &#125;)</span><br><span class="line">            );</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            userRemote.<span class="property">socket</span>.<span class="title function_">send</span>(</span><br><span class="line">              <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;receive_ice&quot;</span>,</span><br><span class="line">                data,</span><br><span class="line">              &#125;)</span><br><span class="line">            );</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="attr">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 客户端与服务端建立连接</span></span><br><span class="line">wsServer.<span class="title function_">on</span>(<span class="string">&quot;connection&quot;</span>, onMsghandler);</span><br><span class="line">server.<span class="title function_">listen</span>(port);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`---listen on <span class="subst">$&#123;port&#125;</span>---`</span>);</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Users.js</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Users</span> &#123;</span><br><span class="line">  #list;</span><br><span class="line">  #timeoutLimit; <span class="comment">// 自动断开连接时间</span></span><br><span class="line">  #userLimit; <span class="comment">// 最大人数</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#list = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">    <span class="variable language_">this</span>.#timeoutLimit = <span class="number">3</span> * <span class="number">60</span> * <span class="number">1000</span>; <span class="comment">// 保证足够时间交换进行WebRTC需要的数据</span></span><br><span class="line">    <span class="variable language_">this</span>.#userLimit = <span class="number">5</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getUserFlags</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">this</span>.#list.<span class="title function_">keys</span>());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getUserByFlag</span>(<span class="params">flag</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#list.<span class="title function_">get</span>(flag);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">addUser</span>(<span class="params">socket</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果用户超过限制，则删除第一个用户</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.#list.<span class="property">size</span> &gt;= <span class="variable language_">this</span>.#userLimit) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">deleteUser</span>(<span class="variable language_">this</span>.#list.<span class="title function_">keys</span>().<span class="title function_">next</span>().<span class="property">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建用户id</span></span><br><span class="line">    <span class="keyword">let</span> flag = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>().<span class="title function_">toString</span>().<span class="title function_">substring</span>(<span class="number">8</span>).<span class="title function_">split</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    flag.<span class="title function_">splice</span>(<span class="number">2</span>, <span class="number">0</span>, <span class="string">&quot;-&quot;</span>);</span><br><span class="line">    flag = flag.<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定时删除用户</span></span><br><span class="line">    <span class="keyword">let</span> timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">deleteUser</span>(flag);</span><br><span class="line">    &#125;, <span class="variable language_">this</span>.#timeoutLimit);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.#list.<span class="title function_">set</span>(flag, &#123;</span><br><span class="line">      timer,</span><br><span class="line">      socket,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">deleteUser</span>(<span class="params">flag</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> user = <span class="variable language_">this</span>.#list.<span class="title function_">get</span>(flag);</span><br><span class="line">    <span class="comment">// 通知用户登录超时</span></span><br><span class="line">    user.<span class="property">socket</span>.<span class="title function_">send</span>(</span><br><span class="line">      <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;login_timeout&quot;</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">// 断开当前用户socket连接</span></span><br><span class="line">    user.<span class="property">socket</span>.<span class="title function_">close</span>();</span><br><span class="line">    <span class="comment">// 请除定时器</span></span><br><span class="line">    <span class="built_in">clearTimeout</span>(user.<span class="property">timer</span>);</span><br><span class="line">    <span class="comment">// 删除用户</span></span><br><span class="line">    <span class="variable language_">this</span>.#list.<span class="title function_">delete</span>(flag);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">Users</span>;</span><br></pre></td></tr></table></figure></div>

<h2 id="前端页面目录结构"><a href="#前端页面目录结构" class="headerlink" title="前端页面目录结构"></a>前端页面目录结构</h2><ul>
<li>public<ul>
<li>index.html</li>
</ul>
</li>
<li>src<ul>
<li>index.js 主文件</li>
<li>FileTransfer.js 文件传输类（核心类）</li>
<li>utils.js 工具</li>
</ul>
</li>
</ul>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>文件传输<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            * &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#flag</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#state</span> &gt; <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#state</span> &gt; <span class="selector-class">.wsdisconnected</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: gray;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#state</span> &gt; <span class="selector-class">.wsconnecting</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: blue;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#state</span> &gt; <span class="selector-class">.wsconnected</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: green;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#state</span> &gt; <span class="selector-class">.pcconnecting</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: blue;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#state</span> &gt; <span class="selector-class">.pcconnected</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: green;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#log</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">max-height</span>: <span class="number">10vh</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">overflow-y</span>: auto;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#userArea</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#fileArea</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#fileAreaInner</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#fileAreaInner</span> &gt; <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">90px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#fileAreaInner</span> &gt; <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="built_in">calc</span>((<span class="number">100%</span> - <span class="number">90px</span> - <span class="number">20px</span>) / <span class="number">2</span>);</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">overflow-x</span>: hidden;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">overflow-y</span>: auto;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#fileAreaInner</span> &gt; <span class="selector-class">.sendArea</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border-right</span>: <span class="number">1px</span> solid black;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#fileAreaInner</span> &gt; <span class="selector-class">.receiveArea</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border-left</span>: <span class="number">1px</span> solid black;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.fileList</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">list-style-type</span>: decimal;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.fileList</span> &gt; <span class="selector-class">.percent</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">22px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.fileList</span> &gt; <span class="selector-class">.percent</span> &gt; <span class="selector-class">.bar</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">z-index</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">0%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: gray;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-size</span>: inherit;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.fileList</span> &gt; <span class="selector-class">.percent</span> &gt; <span class="selector-class">.text</span> &#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">z-index</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">max-width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">white-space</span>: nowrap;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">text-overflow</span>: ellipsis;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">pointer-events</span>: none;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-size</span>: inherit;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>状态<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;state&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;wsdisconnected&quot;</span>&gt;</span>WebSocket未连接<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;wsconnecting&quot;</span>&gt;</span>WebSocket连接中...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;wsconnected&quot;</span>&gt;</span>WebSocket连接成功<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;pcconnecting&quot;</span>&gt;</span>WebRTC连接中...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;pcconnected&quot;</span>&gt;</span>WebRTC连接成功<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- log --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>日志<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;log&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;userArea&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>当前页面ID：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;flag&quot;</span> <span class="attr">readonly</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>输入对方页面ID：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;flagRemote&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;xx-xxx&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;flagRemoteBtn&quot;</span>&gt;</span></span><br><span class="line">                    确认</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;fileArea&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;fileAreaInner&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;sendArea&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;uploadFile&quot;</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">h4</span>&gt;</span>发送列表：<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;sendList&quot;</span> <span class="attr">class</span>=<span class="string">&quot;fileList&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;abort&quot;</span>&gt;</span>终止传输<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;receiveArea&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">h4</span>&gt;</span>接收列表：<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;receiveList&quot;</span> <span class="attr">class</span>=<span class="string">&quot;fileList&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;core-js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  haveWebSocket,</span><br><span class="line">  haveWebRTC,</span><br><span class="line">  $,</span><br><span class="line">  gen,</span><br><span class="line">  initDom,</span><br><span class="line">  changeState,</span><br><span class="line">  log,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;./utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">FileTransfer</span> <span class="keyword">from</span> <span class="string">&quot;./FileTransfer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> $state = $(<span class="string">&quot;state&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> $userArea = $(<span class="string">&quot;userArea&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> $flag = $(<span class="string">&quot;flag&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> $flagRemote = $(<span class="string">&quot;flagRemote&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> $flagRemoteBtn = $(<span class="string">&quot;flagRemoteBtn&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> $logDom = $(<span class="string">&quot;log&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> $fileArea = $(<span class="string">&quot;fileArea&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> $uploadFile = $(<span class="string">&quot;uploadFile&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> $sendList = $(<span class="string">&quot;sendList&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> $receiveList = $(<span class="string">&quot;receiveList&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> $abort = $(<span class="string">&quot;abort&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> wsServerUrl;</span><br><span class="line"><span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&quot;development&quot;</span>) &#123;</span><br><span class="line">  <span class="comment">// 测试环境信令服务器地址</span></span><br><span class="line">  wsServerUrl = <span class="string">&quot;ws://localhost:9999&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&quot;production&quot;</span>) &#123;</span><br><span class="line">  <span class="comment">// 正式环境信令服务器地址</span></span><br><span class="line">  wsServerUrl = <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> $sendLi, $receiveLi;</span><br><span class="line"></span><br><span class="line"><span class="title function_">initDom</span>();</span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="title function_">haveWebSocket</span>()) &#123;</span><br><span class="line">    <span class="title function_">myAlert</span>(<span class="string">&quot;当前浏览器不支持WebSocket&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="title function_">haveWebRTC</span>()) &#123;</span><br><span class="line">    <span class="title function_">myAlert</span>(<span class="string">&quot;当前浏览器不支持WebRTC&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> ft = <span class="keyword">new</span> <span class="title class_">FileTransfer</span>(wsServerUrl);</span><br><span class="line">  ft.<span class="title function_">setLogDom</span>($logDom);</span><br><span class="line">  ft.<span class="title function_">addEventListener</span>(<span class="string">&quot;statechange&quot;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> state = ev.<span class="property">target</span>.<span class="title function_">getState</span>();</span><br><span class="line">    <span class="title function_">changeState</span>(state, $state);</span><br><span class="line">    <span class="title function_">log</span>(state, $logDom);</span><br><span class="line">    <span class="keyword">switch</span> (state) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;wsdisconnected&quot;</span>:</span><br><span class="line">        <span class="keyword">let</span> err = ft.<span class="title function_">getError</span>();</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="title function_">log</span>(err.<span class="property">message</span>, $logDom);</span><br><span class="line">        &#125;</span><br><span class="line">      <span class="attr">default</span>:</span><br><span class="line">        $flag.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        $flagRemote.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        $userArea.<span class="title function_">hide</span>();</span><br><span class="line">        $fileArea.<span class="title function_">hide</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;wsconnected&quot;</span>:</span><br><span class="line">        <span class="keyword">let</span> flag = ft.<span class="title function_">getFlag</span>();</span><br><span class="line">        $flag.<span class="property">value</span> = flag;</span><br><span class="line">        $userArea.<span class="title function_">show</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;pcconnecting&quot;</span>:</span><br><span class="line">        $userArea.<span class="title function_">show</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;pcconnected&quot;</span>:</span><br><span class="line">        $userArea.<span class="title function_">show</span>();</span><br><span class="line">        $fileArea.<span class="title function_">show</span>();</span><br><span class="line">        <span class="title function_">onRTCConnected</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  $abort.<span class="property">onclick</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="title function_">confirm</span>(<span class="string">&quot;确认终止传输，该操作不可逆&quot;</span>)) &#123;</span><br><span class="line">      ft.<span class="property">abort</span>.<span class="title function_">call</span>(ft);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  $flagRemoteBtn.<span class="property">onclick</span> = onFlagRemoteBtnClick;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">onFlagRemoteBtnClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> flagRemote = $flagRemote.<span class="property">value</span>;</span><br><span class="line">    <span class="keyword">if</span> (flagRemote === <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&quot;对方id不能为空&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (flagRemote === ft.<span class="title function_">getFlag</span>()) &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&quot;不能输入自己的id&quot;</span>);</span><br><span class="line">      $flagRemote.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="regexp">/^\d&#123;2&#125;\-\d&#123;3&#125;$/</span>.<span class="title function_">test</span>(flagRemote)) &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&quot;对方id格式不正确，请输入 xx-xxx 格式&quot;</span>);</span><br><span class="line">      $flagRemote.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      ft.<span class="title function_">setFlagRemote</span>(flagRemote);</span><br><span class="line">      ft.<span class="title function_">connect</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">onRTCConnected</span>(<span class="params"></span>) &#123;</span><br><span class="line">    $uploadFile.<span class="property">onchange</span> = <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> file = ev.<span class="property">target</span>.<span class="property">files</span>[<span class="number">0</span>];</span><br><span class="line">      <span class="comment">// 开始发送文件</span></span><br><span class="line">      ft.<span class="title function_">addEventListener</span>(<span class="string">&quot;sendfileinfo&quot;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">        $uploadFile.<span class="property">disabled</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// 文件基本信息</span></span><br><span class="line">        <span class="keyword">let</span> fileInfo = ev.<span class="property">target</span>.<span class="title function_">getFileInfo</span>();</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&quot;开始发送文件&quot;</span>, $logDom);</span><br><span class="line">        <span class="title function_">log</span>(fileInfo, $logDom);</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          !<span class="title class_">Array</span>.<span class="title function_">from</span>($sendList.<span class="property">children</span>).<span class="title function_">find</span>(<span class="function">(<span class="params">$a</span>) =&gt;</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">RegExp</span>(fileInfo.<span class="property">name</span>).<span class="title function_">test</span>($a.<span class="property">innerText</span>)</span><br><span class="line">          )</span><br><span class="line">        ) &#123;</span><br><span class="line">          $sendLi = <span class="title function_">gen</span>(<span class="string">&quot;li&quot;</span>);</span><br><span class="line">          $sendLi.<span class="property">innerText</span> = <span class="string">`<span class="subst">$&#123;fileInfo.name&#125;</span>(0%)`</span>;</span><br><span class="line">          $sendList.<span class="title function_">appendChild</span>($sendLi);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 正在发送文件</span></span><br><span class="line">      ft.<span class="title function_">addEventListener</span>(<span class="string">&quot;sending&quot;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> sendPercent = ev.<span class="property">target</span>.<span class="title function_">getSendPercent</span>();</span><br><span class="line">        $sendLi.<span class="property">innerText</span> = $sendLi.<span class="property">innerText</span>.<span class="title function_">replace</span>(</span><br><span class="line">          <span class="regexp">/\(\d&#123;1,3&#125;(\.\d&#123;1,2&#125;)?\%\)$/</span>,</span><br><span class="line">          <span class="string">`(<span class="subst">$&#123;sendPercent&#125;</span>%)`</span></span><br><span class="line">        );</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 发送文件完毕</span></span><br><span class="line">      ft.<span class="title function_">addEventListener</span>(<span class="string">&quot;sended&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&quot;发送文件完毕&quot;</span>);</span><br><span class="line">        $uploadFile.<span class="property">disabled</span> = <span class="literal">false</span>;</span><br><span class="line">        $uploadFile.<span class="property">value</span> = <span class="literal">null</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">      ft.<span class="title function_">sendFile</span>(file);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 开始接收文件</span></span><br><span class="line">    ft.<span class="title function_">addEventListener</span>(<span class="string">&quot;receivefileinfo&quot;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">      $uploadFile.<span class="property">disabled</span> = <span class="literal">true</span>;</span><br><span class="line">      <span class="comment">// 文件基本信息</span></span><br><span class="line">      <span class="keyword">let</span> fileInfo = ev.<span class="property">target</span>.<span class="title function_">getFileInfo</span>();</span><br><span class="line">      <span class="title function_">log</span>(<span class="string">&quot;开始接收文件&quot;</span>, $logDom);</span><br><span class="line">      <span class="title function_">log</span>(fileInfo, $logDom);</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        !<span class="title class_">Array</span>.<span class="title function_">from</span>($receiveList.<span class="property">children</span>).<span class="title function_">find</span>(<span class="function">(<span class="params">$a</span>) =&gt;</span></span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">RegExp</span>(fileInfo.<span class="property">name</span>).<span class="title function_">test</span>($a.<span class="property">innerText</span>)</span><br><span class="line">        )</span><br><span class="line">      ) &#123;</span><br><span class="line">        $receiveLi = <span class="title function_">gen</span>(<span class="string">&quot;li&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> $a = <span class="title function_">gen</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        $a.<span class="property">innerText</span> = <span class="string">`<span class="subst">$&#123;fileInfo.name&#125;</span>(0%)`</span>;</span><br><span class="line">        $receiveLi.<span class="title function_">appendChild</span>($a);</span><br><span class="line">        $receiveList.<span class="title function_">appendChild</span>($receiveLi);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 正在接收文件</span></span><br><span class="line">    ft.<span class="title function_">addEventListener</span>(<span class="string">&quot;receiving&quot;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> receivePercent = ev.<span class="property">target</span>.<span class="title function_">getReceivePercent</span>();</span><br><span class="line">      <span class="keyword">let</span> $a = $receiveLi.<span class="property">children</span>[<span class="number">0</span>];</span><br><span class="line">      $a.<span class="property">innerText</span> = $a.<span class="property">innerText</span>.<span class="title function_">replace</span>(</span><br><span class="line">        <span class="regexp">/\(\d&#123;1,3&#125;(\.\d&#123;1,2&#125;)?\%\)$/</span>,</span><br><span class="line">        <span class="string">`(<span class="subst">$&#123;receivePercent&#125;</span>%)`</span></span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 接收文件完毕</span></span><br><span class="line">    ft.<span class="title function_">addEventListener</span>(<span class="string">&quot;received&quot;</span>, <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">      $uploadFile.<span class="property">disabled</span> = <span class="literal">false</span>;</span><br><span class="line">      $uploadFile.<span class="property">value</span> = <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">let</span> file = ev.<span class="property">target</span>.<span class="title function_">getFile</span>();</span><br><span class="line">      <span class="title function_">log</span>(<span class="string">&quot;接收文件完毕&quot;</span>, $logDom);</span><br><span class="line">      <span class="keyword">let</span> $a = $receiveLi.<span class="property">children</span>[<span class="number">0</span>];</span><br><span class="line">      $a.<span class="property">href</span> = <span class="variable constant_">URL</span>.<span class="title function_">createObjectURL</span>(file);</span><br><span class="line">      $a.<span class="property">download</span> = $a.<span class="property">innerText</span>.<span class="title function_">replace</span>(<span class="regexp">/\(\d&#123;1,3&#125;(\.\d&#123;1,2&#125;)?\%\)$/</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// FileTransfer.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; log &#125; <span class="keyword">from</span> <span class="string">&quot;./utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FileTransfer</span> <span class="keyword">extends</span> <span class="title class_ inherited__">EventTarget</span> &#123;</span><br><span class="line">  <span class="comment">// 连接</span></span><br><span class="line">  #wsServerUrl;</span><br><span class="line">  #ws;</span><br><span class="line">  #pc;</span><br><span class="line">  #dc;</span><br><span class="line">  #dcRemote;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 中止标记</span></span><br><span class="line">  #abortFlag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 状态</span></span><br><span class="line">  #state;</span><br><span class="line">  #rtcSuccess = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 日志</span></span><br><span class="line">  #logDom;</span><br><span class="line">  #err;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对象页面标记</span></span><br><span class="line">  #flag;</span><br><span class="line">  #flagRemote;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 发送文件</span></span><br><span class="line">  #sendFileInterval = <span class="number">0</span>; <span class="comment">// 发送chunk之间的间隔时间，这里单位是毫秒。貌似只要异步就能避免send queue full，但还是给了他一个间隔时间</span></span><br><span class="line">  #sendFileChunkSize = <span class="number">4</span> * <span class="number">1024</span>; <span class="comment">// 每次发送的chunk大小，单位为BYTE</span></span><br><span class="line">  #sendFileOffset;</span><br><span class="line">  #sendPercent = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 文件</span></span><br><span class="line">  #fileInfo;</span><br><span class="line">  #file;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 接收文件</span></span><br><span class="line">  #receiveBuffer;</span><br><span class="line">  #receiveFileSize;</span><br><span class="line">  #receiveFileTotalSize;</span><br><span class="line">  #receivePercent = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 这个类封装了建立WebRTC连接的详细过程</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; wsServerUrl WebSockets服务器地址</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">wsServerUrl</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.#wsServerUrl = wsServerUrl;</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">setState</span>(<span class="string">&quot;wsdisconnected&quot;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">initFileInfo</span>();</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">initWebSocket</span>();</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">initWebRTC</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  #<span class="title function_">initWebSocket</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#ws = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="variable language_">this</span>.#wsServerUrl);</span><br><span class="line">    <span class="variable language_">this</span>.#ws.<span class="property">onopen</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">log</span>(<span class="string">&quot;建立WebSocket连接成功&quot;</span>, <span class="variable language_">this</span>.#logDom);</span><br><span class="line">      <span class="variable language_">this</span>.#<span class="title function_">setState</span>(<span class="string">&quot;wsconnecting&quot;</span>);</span><br><span class="line">      <span class="comment">// 登录</span></span><br><span class="line">      <span class="variable language_">this</span>.#ws.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">type</span>: <span class="string">&quot;login&quot;</span> &#125;));</span><br><span class="line">      <span class="variable language_">this</span>.#ws.<span class="property">onmessage</span> = <span class="function">(<span class="params">msg</span>) =&gt;</span> <span class="variable language_">this</span>.#wsMsgHandler.<span class="title function_">call</span>(<span class="variable language_">this</span>, msg);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">this</span>.#ws.<span class="property">onerror</span> = <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.#<span class="title function_">setState</span>(<span class="string">&quot;wsdisconnected&quot;</span>);</span><br><span class="line">      <span class="title function_">log</span>(<span class="string">&quot;建立WebSocket连接失败&quot;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(err), <span class="variable language_">this</span>.#logDom, <span class="number">2</span>);</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&quot;建立WebSocket连接失败&quot;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(err));</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Socket msg事件处理</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">msg</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">wsMsgHandler</span>(<span class="params">msg</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> obj;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(msg.<span class="property">data</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;&#125;</span><br><span class="line">    <span class="keyword">let</span> &#123; type, data &#125; = obj;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&quot;type：&quot;</span> + type, <span class="variable language_">this</span>.#logDom);</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;login_success&quot;</span>:</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&quot;登录成功&quot;</span>, <span class="variable language_">this</span>.#logDom);</span><br><span class="line">        <span class="variable language_">this</span>.#flag = data;</span><br><span class="line">        <span class="variable language_">this</span>.#<span class="title function_">setState</span>(<span class="string">&quot;wsconnected&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;login_timeout&quot;</span>:</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.#rtcSuccess) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.#flag = <span class="string">&quot;&quot;</span>;</span><br><span class="line">          <span class="variable language_">this</span>.#<span class="title function_">setState</span>(<span class="string">&quot;wsdisconnected&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;remote_disconnected&quot;</span>:</span><br><span class="line">        <span class="variable language_">this</span>.#flagRemote = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.#<span class="title function_">setState</span>(<span class="string">&quot;wsdisconnected&quot;</span>);</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;对方已掉线，请对方刷新网页&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;receive_offer&quot;</span>:</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&quot;接收Offer&quot;</span>, <span class="variable language_">this</span>.#logDom);</span><br><span class="line">        <span class="variable language_">this</span>.#flagRemote = data.<span class="property">flag</span>;</span><br><span class="line">        <span class="variable language_">this</span>.#<span class="title function_">createAnswer</span>(data);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;receive_answer&quot;</span>:</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&quot;接收Answer&quot;</span>, <span class="variable language_">this</span>.#logDom);</span><br><span class="line">        <span class="variable language_">this</span>.#<span class="title function_">receiveAnswer</span>(data);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;receive_ice&quot;</span>:</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&quot;接收Ice&quot;</span>, <span class="variable language_">this</span>.#logDom);</span><br><span class="line">        <span class="variable language_">this</span>.#<span class="title function_">receiveIce</span>(data);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="attr">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 创建Offer并发送</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> #<span class="title function_">createOffer</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">setState</span>(<span class="string">&quot;pcconnecting&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> offer = <span class="keyword">await</span> <span class="variable language_">this</span>.#pc.<span class="title function_">createOffer</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.#pc.<span class="title function_">setLocalDescription</span>(offer);</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">createIce</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&quot;发送Offer&quot;</span>, <span class="variable language_">this</span>.#logDom);</span><br><span class="line">    <span class="variable language_">this</span>.#ws.<span class="title function_">send</span>(</span><br><span class="line">      <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;send_offer&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: &#123;</span><br><span class="line">          <span class="attr">flag</span>: <span class="variable language_">this</span>.#flag,</span><br><span class="line">          <span class="attr">flagRemote</span>: <span class="variable language_">this</span>.#flagRemote,</span><br><span class="line">          <span class="attr">sdp</span>: offer,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 创建Answer并发送</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">data</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> #<span class="title function_">createAnswer</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> offer = data.<span class="property">sdp</span>;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.#pc.<span class="title function_">setRemoteDescription</span>(offer);</span><br><span class="line">    <span class="keyword">let</span> answer = <span class="keyword">await</span> <span class="variable language_">this</span>.#pc.<span class="title function_">createAnswer</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.#pc.<span class="title function_">setLocalDescription</span>(answer);</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">createIce</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&quot;发送Answer&quot;</span>, <span class="variable language_">this</span>.#logDom);</span><br><span class="line">    <span class="variable language_">this</span>.#ws.<span class="title function_">send</span>(</span><br><span class="line">      <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;send_answer&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: &#123;</span><br><span class="line">          <span class="attr">flag</span>: <span class="variable language_">this</span>.#flag,</span><br><span class="line">          <span class="attr">flagRemote</span>: <span class="variable language_">this</span>.#flagRemote,</span><br><span class="line">          <span class="attr">sdp</span>: answer,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 完成Offer/Answer交换</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">data</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> #<span class="title function_">receiveAnswer</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> answer = data.<span class="property">sdp</span>;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.#pc.<span class="title function_">setRemoteDescription</span>(answer);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 创建icecandidate并发送</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">createIce</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#pc.<span class="property">onicecandidate</span> = <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (ev.<span class="property">candidate</span>) &#123;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&quot;发送Ice&quot;</span>, <span class="variable language_">this</span>.#logDom);</span><br><span class="line">        <span class="variable language_">this</span>.#ws.<span class="title function_">send</span>(</span><br><span class="line">          <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;send_ice&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: &#123;</span><br><span class="line">              <span class="attr">flag</span>: <span class="variable language_">this</span>.#flag,</span><br><span class="line">              <span class="attr">flagRemote</span>: <span class="variable language_">this</span>.#flagRemote,</span><br><span class="line">              <span class="attr">ice</span>: ev.<span class="property">candidate</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;)</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 接收icecandidate并保存</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">data</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">receiveIce</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; ice &#125; = data;</span><br><span class="line">    <span class="variable language_">this</span>.#pc.<span class="title function_">addIceCandidate</span>(ice);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  #<span class="title function_">initWebRTC</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#pc = <span class="keyword">new</span> <span class="title class_">RTCPeerConnection</span>(&#123;</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">            虽然只在内网环境实现p2p连接，但是可能出现多重内网的情况，所以还是添加一些STUN服务，</span></span><br><span class="line"><span class="comment">            由于这些STUN服务是第三方提供的，所以可能会出现不可用的情况，需要酌情更换</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">      <span class="attr">iceServers</span>: [</span><br><span class="line">        &#123; <span class="attr">url</span>: <span class="string">&quot;stun:stun.l.google.com:19302&quot;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">url</span>: <span class="string">&quot;stun:stun.services.mozilla.com&quot;</span> &#125;,</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">sdpSemantics</span>: <span class="string">&quot;plan-b&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">initDataChannel</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  #<span class="title function_">initDataChannel</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 本地数据通道</span></span><br><span class="line">    <span class="variable language_">this</span>.#dc = <span class="variable language_">this</span>.#pc.<span class="title function_">createDataChannel</span>(<span class="string">&quot;fileTransfer&quot;</span>, &#123; <span class="attr">ordered</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">dcConntHandler</span>(<span class="variable language_">this</span>.#dc);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 远端数据通道</span></span><br><span class="line">    <span class="variable language_">this</span>.#pc.<span class="property">ondatachannel</span> = <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.#dcRemote = ev.<span class="property">channel</span>;</span><br><span class="line">      <span class="variable language_">this</span>.#<span class="title function_">dcConntHandler</span>(<span class="variable language_">this</span>.#dcRemote);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 数据通道连接事件处理</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">RTCDataChannel</span>&#125; <span class="variable">dc</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">dcConntHandler</span>(<span class="params">dc</span>) &#123;</span><br><span class="line">    dc.<span class="property">onopen</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">log</span>(<span class="string">&quot;建立WebRTC连接成功&quot;</span>, <span class="variable language_">this</span>.#logDom);</span><br><span class="line">      <span class="variable language_">this</span>.#rtcSuccess = <span class="literal">true</span>;</span><br><span class="line">      <span class="variable language_">this</span>.#<span class="title function_">setState</span>(<span class="string">&quot;pcconnected&quot;</span>);</span><br><span class="line">      dc.<span class="property">onmessage</span> = <span class="function">(<span class="params">msg</span>) =&gt;</span> <span class="variable language_">this</span>.#dcMsgHandler.<span class="title function_">call</span>(<span class="variable language_">this</span>, msg);</span><br><span class="line">    &#125;;</span><br><span class="line">    dc.<span class="property">onerror</span> = <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.#<span class="title function_">setState</span>(<span class="string">&quot;pcdisconnected&quot;</span>);</span><br><span class="line">      <span class="title function_">log</span>(<span class="string">&quot;建立WebRTC连接失败&quot;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(err), <span class="variable language_">this</span>.#logDom, <span class="number">2</span>);</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&quot;建立WebRTC连接失败&quot;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(err));</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 数据通道msg事件处理</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">msg</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">dcMsgHandler</span>(<span class="params">msg</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.#abortFlag) &#123;</span><br><span class="line">      <span class="keyword">let</span> &#123; data &#125; = msg;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> data === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&quot;收到文件基本信息&quot;</span> + data, <span class="variable language_">this</span>.#logDom);</span><br><span class="line">        <span class="keyword">let</span> dataObj;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          dataObj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(data);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;&#125;</span><br><span class="line">        <span class="variable language_">this</span>.#fileInfo = dataObj;</span><br><span class="line">        <span class="variable language_">this</span>.#receiveFileTotalSize = dataObj.<span class="property">size</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;receivefileinfo&quot;</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (data <span class="keyword">instanceof</span> <span class="title class_">ArrayBuffer</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.#receiveFileSize += data.<span class="property">byteLength</span>;</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data <span class="keyword">instanceof</span> <span class="title class_">Blob</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.#receiveFileSize += data.<span class="property">size</span>;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="variable language_">this</span>.#receivePercent =</span><br><span class="line">            <span class="title class_">Math</span>.<span class="title function_">ceil</span>(</span><br><span class="line">              (<span class="variable language_">this</span>.#receiveFileSize / <span class="variable language_">this</span>.#receiveFileTotalSize) * <span class="number">1000</span></span><br><span class="line">            ) / <span class="number">10</span>;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;receiving&quot;</span>));</span><br><span class="line">          <span class="variable language_">this</span>.#receiveBuffer.<span class="title function_">push</span>(data);</span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.#receiveFileSize &gt;= <span class="variable language_">this</span>.#receiveFileTotalSize) &#123;</span><br><span class="line">            <span class="keyword">let</span> file = <span class="keyword">new</span> <span class="title class_">Blob</span>(<span class="variable language_">this</span>.#receiveBuffer);</span><br><span class="line">            <span class="variable language_">this</span>.#file = file;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;received&quot;</span>));</span><br><span class="line">            <span class="variable language_">this</span>.#<span class="title function_">initFileInfo</span>();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, <span class="variable language_">this</span>.#sendFileInterval);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 初始化文件信息</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">initFileInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#sendFileOffset = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#sendPercent = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#receiveBuffer = [];</span><br><span class="line">    <span class="variable language_">this</span>.#receiveFileSize = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#receiveFileTotalSize = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#receivePercent = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#fileInfo = <span class="literal">null</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#file = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  #<span class="title function_">setState</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#state = state;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;statechange&quot;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">getState</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#state;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">getSendPercent</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#sendPercent;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">getReceivePercent</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#receivePercent;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">getFileInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#fileInfo;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">getFile</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#file;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">getFlag</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#flag;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">getError</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#err;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setLogDom</span>(<span class="params">dom</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#logDom = dom;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setFlagRemote</span>(<span class="params">flag</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#flagRemote = flag;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">connect</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">createOffer</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">sendFile</span>(<span class="params">file</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> fr = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 先发送文件基本信息</span></span><br><span class="line">    <span class="variable language_">this</span>.#fileInfo = &#123;</span><br><span class="line">      <span class="attr">name</span>: file.<span class="property">name</span>,</span><br><span class="line">      <span class="attr">size</span>: file.<span class="property">size</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">this</span>.#dc.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>.#fileInfo));</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;sendfileinfo&quot;</span>));</span><br><span class="line"></span><br><span class="line">    fr.<span class="property">onload</span> = <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.#dc.<span class="title function_">send</span>(ev.<span class="property">target</span>.<span class="property">result</span>);</span><br><span class="line">        <span class="variable language_">this</span>.#sendFileOffset += ev.<span class="property">target</span>.<span class="property">result</span>.<span class="property">byteLength</span>;</span><br><span class="line">        <span class="variable language_">this</span>.#sendPercent =</span><br><span class="line">          <span class="title class_">Math</span>.<span class="title function_">ceil</span>((<span class="variable language_">this</span>.#sendFileOffset / file.<span class="property">size</span>) * <span class="number">1000</span>) / <span class="number">10</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;sending&quot;</span>));</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.#sendFileOffset &lt; file.<span class="property">size</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (!<span class="variable language_">this</span>.#abortFlag) &#123;</span><br><span class="line">            <span class="title function_">readSlice</span>(<span class="variable language_">this</span>.#sendFileOffset);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;sended&quot;</span>));</span><br><span class="line">          <span class="variable language_">this</span>.#<span class="title function_">initFileInfo</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, <span class="variable language_">this</span>.#sendFileInterval);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 分段发送文件</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">readSlice</span> = (<span class="params">offset</span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">let</span> fileSlice = file.<span class="title function_">slice</span>(offset, offset + <span class="variable language_">this</span>.#sendFileChunkSize);</span><br><span class="line">      fr.<span class="title function_">readAsArrayBuffer</span>(fileSlice);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">readSlice</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">abort</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#abortFlag = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">FileTransfer</span>;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// utils.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">haveWebSocket</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">WebSocket</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">haveWebRTC</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">RTCPeerConnection</span> =</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">RTCPeerConnection</span> ||</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">webkitRTCPeerConnection</span> ||</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">mozRTCPeerConnection</span> ||</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">msRTCPeerConnection</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">RTCPeerConnection</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 日志记录</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">msg</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">HTMLElement</span>&#125; <span class="variable">dom</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; <span class="variable">errLevel</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">log</span>(<span class="params">msg, dom, errLevel = <span class="number">0</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> p = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;p&quot;</span>);</span><br><span class="line">  p.<span class="property">innerText</span> = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(msg);</span><br><span class="line">  <span class="keyword">switch</span> (errLevel) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      p.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&quot;gray&quot;</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(msg);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      p.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&quot;orange&quot;</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">warn</span>(msg);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      p.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(msg);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (dom) dom.<span class="title function_">prepend</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * DOM ID选择器简化版</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">selector</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">HTMLElement</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">$</span>(<span class="params">selector</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(selector);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建DOM 简化版</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">tag</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">HTMLElement</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">gen</span>(<span class="params">tag</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">createElement</span>(tag);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 初始化DOM并为其添加常用方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">initDom</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="title class_">Element</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">show</span>) &#123;</span><br><span class="line">    <span class="title class_">Element</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">show</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;initial&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="title class_">Element</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hide</span>) &#123;</span><br><span class="line">    <span class="title class_">Element</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hide</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="title class_">Element</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">isShow</span>) &#123;</span><br><span class="line">    <span class="title class_">Element</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">isShow</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">display</span> !== <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="title class_">Element</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasClass</span>) &#123;</span><br><span class="line">    <span class="title class_">Element</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasClass</span> = <span class="keyword">function</span> (<span class="params">className</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">classList</span>.<span class="title function_">contains</span>(className);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改连接状态</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; <span class="variable">status</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">HTMLElement</span>&#125; <span class="variable">dom</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">changeState</span>(<span class="params">status, dom</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> $child <span class="keyword">of</span> dom.<span class="property">children</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($child.<span class="title function_">hasClass</span>(status)) &#123;</span><br><span class="line">      $child.<span class="title function_">show</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      $child.<span class="title function_">hide</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>WebRTC</tag>
      </tags>
  </entry>
  <entry>
    <title>解决vscode无法识别webpack中用@作为别名的模块类型</title>
    <url>/2024/05/20/%E8%A7%A3%E5%86%B3vscode%E6%97%A0%E6%B3%95%E8%AF%86%E5%88%ABwebpack%E4%B8%AD%E7%94%A8-%E4%BD%9C%E4%B8%BA%E5%88%AB%E5%90%8D%E7%9A%84%E6%A8%A1%E5%9D%97%E7%B1%BB%E5%9E%8B/</url>
    <content><![CDATA[<p>需要在根目录创建一个 <em>jsconfig.json</em> 文件，其内容如下：<br>如果是 typescript 项目，则需要创建 <em>tsconfig.json</em> ，其配置内容也如下所示。</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.&quot;</span><span class="punctuation">,</span> <span class="comment">// 这通常是项目根目录</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src/*&quot;</span><span class="punctuation">]</span> <span class="comment">// 这将允许js的intellisense自动识别引入的模块类型，主要是配合webpack的alias配置</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="comment">// ... 其他选项</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;exclude&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="comment">// 排除的文件，项目中被排除的文件不会被语法检查，节省资源</span></span><br><span class="line">    <span class="string">&quot;node_modules&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;dist&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;**/__tests__&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;**/*.test.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;**/*.spec.ts&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line">  <span class="comment">// ... 其他配置</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>VSCode</tag>
        <tag>javascript</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>网页语音播报</title>
    <url>/2023/11/11/%E7%BD%91%E9%A1%B5%E8%AF%AD%E9%9F%B3%E6%92%AD%E6%8A%A5/</url>
    <content><![CDATA[<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> text = <span class="string">&quot;小朋友，你是否有很多问号&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> ssu = <span class="keyword">new</span> <span class="title class_">SpeechSynthesisUtterance</span>();</span><br><span class="line">ssu.<span class="property">text</span> = text; <span class="comment">// 文字内容: 小朋友，你是否有很多问号</span></span><br><span class="line">ssu.<span class="property">lang</span> = <span class="string">&quot;zh-CN&quot;</span>; <span class="comment">// 使用的语言:中文</span></span><br><span class="line">ssu.<span class="property">volume</span> = <span class="number">1</span>; <span class="comment">// 声音音量：1</span></span><br><span class="line">ssu.<span class="property">rate</span> = <span class="number">1</span>; <span class="comment">// 语速：1</span></span><br><span class="line">ssu.<span class="property">pitch</span> = <span class="number">1</span>; <span class="comment">// 音高：1</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">speechSynthesis</span>.<span class="title function_">cancel</span>(); <span class="comment">// 清空语音队列</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">speechSynthesis</span>.<span class="title function_">speak</span>(ssu); <span class="comment">// 添加一个语音到队列并播放</span></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>通过python操作dll</title>
    <url>/2023/11/15/%E9%80%9A%E8%BF%87python%E6%93%8D%E4%BD%9Cdll/</url>
    <content><![CDATA[<h1 id="调用-dll-里的函数"><a href="#调用-dll-里的函数" class="headerlink" title="调用 dll 里的函数"></a>调用 dll 里的函数</h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载当前目录下的my.dll</span></span><br><span class="line">current_path = current_directory = os.path.dirname(os.path.realpath(__file__))</span><br><span class="line">os.add_dll_directory(current_path)</span><br><span class="line">dll = windll.LoadLibrary(<span class="string">r&quot;my.dll&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用dll里的函数，需要事先知道函数名称和参数</span></span><br><span class="line">dll.funcname(arg1, arg2)</span><br></pre></td></tr></table></figure></div>

<h1 id="查看-dll-里的所有函数"><a href="#查看-dll-里的所有函数" class="headerlink" title="查看 dll 里的所有函数"></a>查看 dll 里的所有函数</h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">dll = windll.LoadLibrary(<span class="string">&quot;path.dll&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">dir</span>(dll))</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>部署JSP环境</title>
    <url>/2025/04/02/%E9%83%A8%E7%BD%B2JSP%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<h1 id="配置-JDK"><a href="#配置-JDK" class="headerlink" title="配置 JDK"></a>配置 JDK</h1><p>参考<a href="/2023/06/08/%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8BJava%E7%9A%84%E5%9F%BA%E7%A1%80%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B/#JDK-%E5%AE%89%E8%A3%85%E5%92%8C%E7%AE%A1%E7%90%86">JDK-安装和管理</a></p>
<p>我这里使用的是 jdk1.8.0_202</p>
<p>然后需要在环境变量中添加一个 JAVA_HOME 变量，其值为 JDK 安装路径</p>
<h1 id="配置-Tomcat"><a href="#配置-Tomcat" class="headerlink" title="配置 Tomcat"></a>配置 Tomcat</h1><p><a class="link"   href="https://tomcat.apache.org/" >Tomcat 下载地址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>我这里下载的是 apache-tomcat-9.0.102</p>
<p>如果该版本在官网找不到，或者不能下载，这里提供<a class="link"   href="https://pan.baidu.com/s/14wPCTB-itoJXSxXP8D2M2w?pwd=cbbi" >百度网盘连接 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h2 id="网站根目录"><a href="#网站根目录" class="headerlink" title="网站根目录"></a>网站根目录</h2><p>Tomcat 的网站根目录默认在 tomcat&#x2F;webapps&#x2F;ROOT&#x2F;</p>
<p>如果有自己的 JSP 项目，可以将项目根目录复制到 tomcat&#x2F;webapps&#x2F;你的 JSP 项目根目录&#x2F;，然后通过访问 <a class="link"   href="http://localhost:8080/%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E6%A0%B9%E7%9B%AE%E5%BD%95/index.jsp" >http://localhost:8080/你的项目根目录/index.jsp <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 即可</p>
<h2 id="启动-Tomcat"><a href="#启动-Tomcat" class="headerlink" title="启动 Tomcat"></a>启动 Tomcat</h2><p>Tomcat 的启动方式有两种：</p>
<ol>
<li>直接运行 tomcat&#x2F;bin&#x2F;startup.bat</li>
<li>通过 cmd 运行 tomcat&#x2F;bin&#x2F;catalina.bat start</li>
</ol>
<p>Tomcat 默认监听端口为 8080，可以通过修改 tomcat&#x2F;conf&#x2F;server.xml 中的 Connector 的 port 属性来修改端口</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a class="link"   href="https://cloud.tencent.com/developer/article/2130104" >Apache Tomcat 安装与配置教程 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>VSCode</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>隐藏各大浏览器滚动条的兼容处理方案</title>
    <url>/2023/06/10/%E9%9A%90%E8%97%8F%E5%90%84%E5%A4%A7%E6%B5%8F%E8%A7%88%E5%99%A8%E6%BB%9A%E5%8A%A8%E6%9D%A1%E7%9A%84%E5%85%BC%E5%AE%B9%E5%A4%84%E7%90%86%E6%96%B9%E6%A1%88/</url>
    <content><![CDATA[<p>不同浏览器的滚动条样式都不一样，不统一就不美观，所以要统一隐藏掉</p>
<div class="highlight-container" data-rel="Css"><figure class="iseeu highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.hide-scrollber</span>::-weblit-scrollber &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>; // 兼容chrome浏览器</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.hide-scrollbar</span> &#123;</span><br><span class="line">	<span class="attribute">scrollbar-width</span>: none; // 兼容火狐浏览器</span><br><span class="line">	-ms-<span class="attribute">overflow</span>-style: none; // 兼容IE10+</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><a class="link"   href="https://blog.csdn.net/qq_37804387/article/details/130338874" >参考 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>当然，还有通过外层容器设置overflow: hidden;来隐藏滚动条的办法，这里就不说了，上面的代码已经能满足大部分现代浏览器了</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Css</tag>
      </tags>
  </entry>
</search>
